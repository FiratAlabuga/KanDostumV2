!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Sg){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(Sg),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}(_e=l=l||{})[_e.DEBUG=0]="DEBUG",_e[_e.VERBOSE=1]="VERBOSE",_e[_e.INFO=2]="INFO",_e[_e.WARN=3]="WARN",_e[_e.ERROR=4]="ERROR",_e[_e.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var o={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},u=l.INFO,a=((Ee={})[l.DEBUG]="log",Ee[l.VERBOSE]="log",Ee[l.INFO]="info",Ee[l.WARN]="warn",Ee[l.ERROR]="error",Ee),c=(Object.defineProperty(h.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),h.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(h.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),h.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},h.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},h.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},h.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},h.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},h);function h(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var p,d="FirebaseError",g=(n(m,p=Error),m);function m(t,e,n){e=p.call(this,e)||this;return e.code=t,e.customData=n,e.name=d,Object.setPrototypeOf(e,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(_,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new g(o,t,i)},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var _=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A={},S=N||self;function x(){}function D(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),P=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function L(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function R(t,e,n){return(R=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:L).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function M(){return Date.now()}function U(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,k)&&t[k]||(t[k]=++P))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}t:{var X=S.navigator;if(X){X=X.userAgent;if(X){H=X;break t}}H=""}function W(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function tt(t){return tt[" "](t),t}tt[" "]=x;var et,nt=Y(H,"Opera"),rt=Y(H,"Trident")||Y(H,"MSIE"),it=Y(H,"Edge"),ot=it||rt,st=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),ut=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function at(){var t=S.document;return t?t.documentMode:void 0}t:{var ct="",ht=(ht=H,st?/rv:([^\);]+)(\)|;)/.exec(ht):it?/Edge\/([\d\.]+)/.exec(ht):rt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ht):ut?/WebKit\/(\S+)/.exec(ht):nt?/(?:Version)[ \/]?(\S+)/.exec(ht):void 0);if(ht&&(ct=ht?ht[1]:""),rt){ht=at();if(null!=ht&&ht>parseFloat(ct)){et=String(ht);break t}}et=ct}var ft={};function lt(u){return t=u,e=function(){for(var t=0,e=Q(String(et)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var pt=S.document&&rt&&(at()||parseInt(et,10))||void 0,dt=!rt||9<=Number(pt),yt=rt&&!lt("9"),vt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",x,e),S.removeEventListener("test",x,e)}catch(t){}return t}();function gt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function mt(t,e){if(gt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(st){t:{try{tt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}gt.prototype.b=function(){this.defaultPrevented=!0},U(mt,gt);var bt={2:"touch",3:"pen",4:"mouse"};mt.prototype.b=function(){mt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,yt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var wt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Et(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function It(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Tt(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(It(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Tt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=At(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Et(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),xt={};function Dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Mt(r);return e&&e[wt]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Dt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[wt]?t.va(e,n,O(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!dt)return null;var u,a,c=Rt(t);if(c||(t[St]=c=new Tt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Lt,r=a=dt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)void 0===(i=!vt?s:i)&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function kt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[wt]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Rt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[St]=null)):It(t)))}function Pt(t){return t in xt?xt[t]:xt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&kt(t),n.call(r,e)}function Lt(t,e){if(t.Y)return!0;if(dt)return Ct(t,new mt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new mt(e,this))}function Rt(t){return(t=t[St])instanceof Tt?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==typeof e?e:(e[Vt]||(e[Vt]=function(t){return e.handleEvent(t)}),e[Vt])}function Ut(){j.call(this),this.c=new Tt(this),(this.J=this).C=null}function jt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new gt(e,t):e instanceof gt?e.target=e.target||t:(s=e,$(e=new gt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}U(Ut,j),Ut.prototype[wt]=!0,(T=Ut.prototype).addEventListener=function(t,e,n,r){Dt(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Mt(r),e&&e[wt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=At(s=e.a[n],r,i,o))&&(It(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Rt(e))&&(n=e.a[n.toString()],(r=(e=-1)<(e=n?At(n,r,i,o):e)?n[e]:null)&&kt(r))}(this,t,e,n,r)},T.G=function(){if(Ut.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)It(n[r]);delete e.a[t],e.b--}}this.C=null},T.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=S.JSON.stringify;function Bt(){this.b=this.a=null}var Gt,zt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Qt},function(t){t.reset()}));function Ht(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Gt||(n=S.Promise.resolve(void 0),Gt=function(){n.then(Wt)}),Kt||(Gt(),Kt=!0),Xt.add(t,e)}Bt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new Bt;function Wt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=zt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Kt=!1}function Jt(t,e){Ut.call(this),this.b=t||1,this.a=e||S,this.f=R(this.Za,this),this.g=M()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function $t(t,e,n){if("function"==typeof t)n&&(t=R(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=R(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}U(Jt,Ut),(T=Jt.prototype).aa=!1,T.M=null,T.Za=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),jt(this,"tick"),this.aa&&(Zt(this),this.start())))},T.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},T.G=function(){Jt.X.G.call(this),Zt(this),delete this.a};var te,ee,ne,re=(E(ee=oe,ne=te=j),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=$t(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e){var n=te.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function se(t){j.call(this),this.b=t,this.a={}}U(se,j);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){W(t.a,function(t,e){this.a.hasOwnProperty(e)&&kt(t)},t),t.a={}}function he(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.X.G.call(this),ce(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},he.prototype.info=function(){};var le={},pe=null;function de(){return pe=pe||new Ut}function ye(t){gt.call(this,le.Fa,t)}function ve(t){var e=de();jt(e,new ye(e))}function ge(t,e){gt.call(this,le.STAT_EVENT,t),this.stat=e}function me(t){var e=de();jt(e,new ge(e,t))}function be(t){gt.call(this,le.Ga,t)}function we(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}le.Fa="serverreachability",U(ye,gt),le.STAT_EVENT="statevent",U(ge,gt),le.Ga="timingevent",U(be,gt);var _e={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ee={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ie(){}function Te(t){var e;return e=!(e=t.a)?t.a={}:e}function Ne(){}Ie.prototype.a=null;var Ae,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Se(){gt.call(this,"d")}function xe(){gt.call(this,"c")}function De(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new se(this),this.P=ke,t=ot?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}U(Se,gt),U(xe,gt),U(De,Ie),Ae=new De;var ke=45e3,Pe={},Ce={};function Le(t,e,n){t.H=1,t.i=en(Xe(e)),t.j=n,t.I=!0,Re(t,null)}function Re(t,e){t.u=M(),Me(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(R(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Xa),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ve(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,me(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,me(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0,me(11))):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),Fe(t))}function Me(t){t.T=M()+t.P,Ue(t,t.P)}function Ue(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(R(t.Va,t),e)}function je(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||rr(t.g,t)}function qe(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),Hn(u)}$n(u),me(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(R(u.Sa,u),6e3));if(_n(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),Me(o)),n.a=i):Zn(n),0<u.g.length&&Kn(u)):"stop"!=c[0]&&"close"!=c[0]||or(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?or(u,7):zn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);ve(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=Oe.prototype).setTimeout=function(t){this.P=t},T.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},T.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ot&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),je(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,r=this.c,a=this.m,c=this.l,h=this.f,f=this.S,l=e,p=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+f+"]: "+a+"\n"+c+"\n"+l+" "+p}),this.b){if(this.U&&!this.C){e:{if(this.a){var s=this.a;if((s=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,me(12),qe(this),Fe(this);break t}fe(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,u)}this.I?(Ve(this,e,o),ot&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Wa),this.R.start())):(fe(this.c,this.f,o,null),Be(this,o)),4==e&&qe(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),qe(this),Fe(this)}}}catch(t){}var a,c,h,f,l,p},T.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Ve(this,t,e),this.b&&4!=t&&Me(this)))},T.cancel=function(){this.A=!0,qe(this)},T.Va=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),qe(this),this.h=2,Fe(this)):Ue(this,this.T-n)},(T=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.L=function(){return He(this),this.a.concat()},T.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},T.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,We(this,t.f),this.j=t.j,Je(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,We(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),Ze(this,n[4]),this.g=nn(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Xe(t){return new Ke(t)}function We(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,cn)),t.b=new fn(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),t=n?t.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){ln(t),e=vn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function dn(t,e){return ln(t),e=vn(t,e),Qe(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),G(n)),t.b+=n.length)}function vn(t,e){return e=String(e),e=t.f?e.toLowerCase():e}(T=fn.prototype).add=function(t,e){ln(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},T.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.K=function(t){ln(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=B(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},T.set=function(t,e){return ln(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var gn=function(t,e){this.b=t,this.a=e};function mn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function _n(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Sn(){this.a=new An}function xn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},An.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Dn=S.JSON.parse;function On(t){Ut.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=kn,this.D=this.F=!1}U(On,Ut);var kn="",Pn=/^https?$/i,Cn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Rn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Vn(t),Un(t)}function Vn(t){t.u||(t.u=!0,jt(t,"complete"),jt(t,"error"))}function Mn(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))$t(t.za,0,t);else if(jt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n);if(e)jt(t,"complete"),jt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Vn(t)}}finally{Un(t)}}}function Un(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||jt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",W(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new he,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Bn("baseRetryDelayMs",5e3,t),this.Ra=Bn("retryDelaySeedMs",1e4,t),this.Ma=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function zn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,tn(n=Xe(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Wn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=en(Xe(n)),n=!1,!(n=S.navigator&&S.navigator.sendBeacon?S.navigator.sendBeacon(e.i.toString(),""):n)&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=M(),Me(e)),sr(t)}function Hn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Qn(t){Hn(t),t.j&&(S.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new gn(t.Oa++,e)),3==t.v&&Kn(t)}function Kn(t){wn(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Wn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Le(n,r,e)}function Wn(t,n){t.f&&Ge({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?R(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Ge(t,function(t,e){var n=t;O(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=we(R(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function er(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Wn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Xe(e)),n.j=null,n.I=!0,Re(n,t)}function nr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r,i,o=null;if(t.a==e){nr(t),tr(t),t.a=null;var s=2}else{if(!En(t.b,e))return;o=e.s,Tn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=M()-e.u,n=t.u,jt(s=de(),new be(s)),Kn(t)):Zn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,_n((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=we(R(r.Ba,r,i),ir(r,r.u)),r.u++,0))))&&(2!=s||!$n(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=R(t.Ya,t),r||(r=new Ke("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||We(r,"https"),en(r)),n=r.toString(),r=o,o=new he,S.Image?((i=new Image).onload=V(xn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(xn,o,i,"TestLoadImage: error",!1,r),i.onabort=V(xn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(xn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Qn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ke?Xe(s):new Ke(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),Ze(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ke(null,void 0),r&&We(u,r),i&&Je(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&W(t.V,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Wn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Na)).F=t.C,e}function cr(){}function hr(){if(rt&&!(10<=Number(pt)))throw Error("Environmental error: no available transport.")}function fr(t,e){Ut.call(this),this.a=new Gn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function lr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){xe.call(this),this.status=1}function dr(t){this.a=t}(T=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ae),this.a.onreadystatechange=R(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Rn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,rt&&lt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=R(this.xa,this)):this.m=$t(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Rn(this,t)}},T.xa=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,jt(this,"timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,jt(this,"complete"),jt(this,"abort"),Un(this))},T.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Un(this,!0)),On.X.G.call(this)},T.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ua())},T.Ua=function(){Mn(this)},T.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},T.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},T.ua=function(){return this.h},T.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Gn.prototype).ha=8,T.v=1,T.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?$(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=Xe(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Wn(this,i),this.i&&r&&qn(i,this.i,r),In(this.b,n),this.Ia&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.U=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||wn(this.b)||Xn(this))},T.Aa=function(){var t;this.j=null,er(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(R(this.Ta,this),t))},T.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,me(10),Hn(this),er(this))},T.Sa=function(){null!=this.m&&(this.m=null,Hn(this),$n(this),me(19))},T.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(T=cr.prototype).ta=function(){},T.sa=function(){},T.ra=function(){},T.qa=function(){},T.Ja=function(){},hr.prototype.a=function(t,e){return new fr(t,e)},U(fr,Ut),fr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;me(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ur(t,null,t.fa),Kn(t)},fr.prototype.close=function(){zn(this.a)},fr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.l?((e={}).__data__=qt(t),Yn(this.a,e)):Yn(this.a,t)},fr.prototype.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,fr.X.G.call(this)},U(lr,Se),U(pr,xe),U(dr,cr),dr.prototype.ta=function(){jt(this.a,"a")},dr.prototype.sa=function(t){jt(this.a,new lr(t))},dr.prototype.ra=function(t){jt(this.a,new pr)},dr.prototype.qa=function(){jt(this.a,"b")},hr.prototype.createWebChannel=hr.prototype.a,fr.prototype.send=fr.prototype.h,fr.prototype.open=fr.prototype.g,_e.NO_ERROR=0,_e.TIMEOUT=8,_e.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ut.prototype.listen=Ut.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.W,On.prototype.getResponseJson=On.prototype.Pa,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var yr=de,vr=_e,gr=Ee,mr=le,br=10,wr=11,_r=Ne,Er=On,Ir=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Tr=(Object.defineProperty(Ar.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Ar.prototype.isEqual=function(t){return t instanceof Ar&&t.projectId===this.projectId&&t.database===this.database},Ar),Nr=new c("@firebase/firestore");function Ar(t,e){this.projectId=t,this.database=e||"(default)"}function Sr(){return Nr.logLevel}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.DEBUG&&(e=n.map(kr),Nr.debug.apply(Nr,s(["Firestore (8.3.0): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.ERROR&&(e=n.map(kr),Nr.error.apply(Nr,s(["Firestore (8.3.0): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.WARN&&(e=n.map(kr),Nr.warn.apply(Nr,s(["Firestore (8.3.0): "+t],e)))}function kr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){t="FIRESTORE (8.3.0) INTERNAL ASSERTION FAILED: "+(t=void 0===t?"Unexpected state":t);throw Dr(t),new Error(t)}function Cr(t){t||Pr()}var Lr=(Rr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Rr);function Rr(){}function Vr(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Ur(t){return t+"\0"}var jr=(Fr.fromBase64String=function(t){return new Fr(atob(t))},Fr.fromUint8Array=function(t){return new Fr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Fr.prototype.toBase64=function(){return t=this.h,btoa(t);var t},Fr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},Fr.prototype.l=function(){return 2*this.h.length},Fr.prototype._=function(t){return Vr(this.h,t.h)},Fr.prototype.isEqual=function(t){return this.h===t.h},Fr);function Fr(t){this.h=t}jr.T=new jr("");var qr,Br={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Gr=(n(Kr,qr=Error),Kr),zr=(Yr.fromBase64String=function(t){try{return new Yr(jr.fromBase64String(t))}catch(t){throw new Gr(Br.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Yr.fromUint8Array=function(t){return new Yr(jr.fromUint8Array(t))},Yr.prototype.toBase64=function(){return this.I.toBase64()},Yr.prototype.toUint8Array=function(){return this.I.toUint8Array()},Yr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Yr.prototype.isEqual=function(t){return this.I.isEqual(t.I)},Yr),Hr=(Qr.prototype.m=function(){return null!=this.uid},Qr.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},Qr.prototype.isEqual=function(t){return t.uid===this.uid},Qr);function Qr(t){this.uid=t}function Yr(t){this.I=t}function Kr(t,e){var n=this;return(n=qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Hr.UNAUTHENTICATED=new Hr(null),Hr.R=new Hr("google-credentials-uid"),Hr.P=new Hr("first-party-uid");function Xr(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t}var Wr=(oi.prototype.getToken=function(){return Promise.resolve(null)},oi.prototype.p=function(){},oi.prototype.v=function(t){(this.V=t)(Hr.UNAUTHENTICATED)},oi.prototype.S=function(){this.V=null},oi),Jr=(ii.prototype.getToken=function(){var e=this,n=this.N,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.N!==n?(xr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Cr("string"==typeof t.accessToken),new Xr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},ii.prototype.p=function(){this.forceRefresh=!0},ii.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},ii.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},ii.prototype.$=function(){var t=this.auth&&this.auth.getUid();return Cr(null===t||"string"==typeof t),new Hr(t)},ii),Zr=(Object.defineProperty(ri.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.O},e=this.F.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ri),$r=(ni.prototype.getToken=function(){return Promise.resolve(new Zr(this.F,this.O))},ni.prototype.v=function(t){t(Hr.P)},ni.prototype.S=function(){},ni.prototype.p=function(){},ni),ti=(ei.prototype.M=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ei.prototype.next=function(){var t=++this.previousValue;return this.L&&this.L(t),t},ei);function ei(t,e){var n=this;this.previousValue=t,e&&(e.k=function(t){return n.M(t)},this.L=function(t){return e.B(t)})}function ni(t,e){this.F=t,this.O=e}function ri(t,e){this.F=t,this.O=e,this.type="FirstParty",this.user=Hr.P}function ii(t){var e=this;this.D=null,this.currentUser=Hr.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.$(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then(function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)},function(){}))}function oi(){this.V=null}ti.q=-1;var si,ui,ai=(bi.now=function(){return bi.fromMillis(Date.now())},bi.fromDate=function(t){return bi.fromMillis(t.getTime())},bi.fromMillis=function(t){var e=Math.floor(t/1e3);return new bi(e,1e6*(t-1e3*e))},bi.prototype.toDate=function(){return new Date(this.toMillis())},bi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},bi.prototype.U=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},bi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},bi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},bi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},bi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},bi),ci=(mi.K=function(t){return new mi(t)},mi.min=function(){return new mi(new ai(0,0))},mi.prototype._=function(t){return this.timestamp.U(t.timestamp)},mi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},mi.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},mi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},mi.prototype.j=function(){return this.timestamp},mi),Ee=(Object.defineProperty(gi.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),gi.prototype.isEqual=function(t){return 0===gi.H(this,t)},gi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof gi?t.forEach(function(t){e.push(t)}):e.push(t),this.J(e)},gi.prototype.limit=function(){return this.offset+this.length},gi.prototype.Y=function(t){return t=void 0===t?1:t,this.J(this.segments,this.offset+t,this.length-t)},gi.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},gi.prototype.Z=function(){return this.segments[this.offset]},gi.prototype.tt=function(){return this.get(this.length-1)},gi.prototype.get=function(t){return this.segments[this.offset+t]},gi.prototype.et=function(){return 0===this.length},gi.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},gi.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},gi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},gi.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},gi.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},gi),hi=(n(vi,ui=Ee),vi.prototype.J=function(t,e,n){return new vi(t,e,n)},vi.prototype.rt=function(){return this.it().join("/")},vi.prototype.toString=function(){return this.rt()},vi.ot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Gr(Br.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new vi(n)},vi.ct=function(){return new vi([])},vi),fi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,li=(n(yi,si=Ee),yi.prototype.J=function(t,e,n){return new yi(t,e,n)},yi.at=function(t){return fi.test(t)},yi.prototype.rt=function(){return this.it().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t=!yi.at(t)?"`"+t+"`":t}).join(".")},yi.prototype.toString=function(){return this.rt()},yi.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},yi.ht=function(){return new yi(["__name__"])},yi.lt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Gr(Br.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Gr(Br.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Gr(Br.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Gr(Br.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new yi(e)},yi.ct=function(){return new yi([])},yi),pi=(di._t=function(t){return new di(hi.ot(t))},di.ft=function(t){return new di(hi.ot(t).Y(5))},di.prototype.dt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},di.prototype.isEqual=function(t){return null!==t&&0===hi.H(this.path,t.path)},di.prototype.toString=function(){return this.path.toString()},di.H=function(t,e){return hi.H(t.path,e.path)},di.wt=function(t){return t.length%2==0},di.Et=function(t){return new di(new hi(t.slice()))},di);function di(t){this.path=t}function yi(){return null!==si&&si.apply(this,arguments)||this}function vi(){return null!==ui&&ui.apply(this,arguments)||this}function gi(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.G=n}function mi(t){this.timestamp=t}function bi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Gr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Gr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Gr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Gr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function wi(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function _i(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ei(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ii=(Ni.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},Ni.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ni),Ti=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ni(t){(this.fields=t).sort(li.H)}function Ai(t){if(Cr(!!t),"string"!=typeof t)return{seconds:Si(t.seconds),nanos:Si(t.nanos)};var e=0,n=Ti.exec(t);Cr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Si(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function xi(t){return"string"==typeof t?jr.fromBase64String(t):jr.fromUint8Array(t)}function Di(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Oi(t){t=Ai(t.mapValue.fields.__local_write_time__.timestampValue);return new ai(t.seconds,t.nanos)}function ki(t){return null==t}function Pi(t){return 0===t&&1/t==-1/0}function Ci(t){return"number"==typeof t&&Number.isInteger(t)&&!Pi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Li(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Di(t)?4:10:Pr()}function Ri(r,i){var t,e,n=Li(r);if(n!==Li(i))return!1;switch(n){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Oi(r).isEqual(Oi(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ai(r.timestampValue),t=Ai(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return e=i,xi(r.bytesValue).isEqual(xi(e.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return t=i,Si((e=r).geoPointValue.latitude)===Si(t.geoPointValue.latitude)&&Si(e.geoPointValue.longitude)===Si(t.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Si(t.integerValue)===Si(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Si(t.doubleValue),e=Si(e.doubleValue);return t===e?Pi(t)===Pi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],Ri);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(wi(e)!==wi(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Ri(e[t],n[t])))return!1;return!0}();default:return Pr()}}function Vi(t,e){return void 0!==(t.values||[]).find(function(t){return Ri(t,e)})}function Mi(t,e){var n,r,i,o=Li(t),s=Li(e);if(o!==s)return Vr(o,s);switch(o){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return r=e,i=Si(t.integerValue||t.doubleValue),r=Si(r.integerValue||r.doubleValue),i<r?-1:r<i?1:i===r?0:isNaN(i)?isNaN(r)?0:-1:1;case 3:return Ui(t.timestampValue,e.timestampValue);case 4:return Ui(Oi(t),Oi(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return function(t,e){t=xi(t),e=xi(e);return t._(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Vr(Si(n.latitude),Si(i.latitude)))?r:Vr(Si(n.longitude),Si(i.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Mi(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Vr(r[s],o[s]);if(0!==u)return u;u=Mi(n[r[s]],i[o[s]]);if(0!==u)return u}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function Ui(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=Ai(t),t=Ai(e),e=Vr(n.seconds,t.seconds);return 0!==e?e:Vr(n.nanos,t.nanos)}function ji(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Ai(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?xi(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,pi.ft(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Pr();var e}(t)}function Fi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function qi(t){return t&&"integerValue"in t}function Bi(t){return!!t&&"arrayValue"in t}function Gi(t){return t&&"nullValue"in t}function zi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Hi(t){return t&&"mapValue"in t}var Qi=(Xi.empty=function(){return new Xi({mapValue:{}})},Xi.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Hi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},Xi.prototype.isEqual=function(t){return Ri(this.proto,t.proto)},Xi),Yi=(Ki.prototype.set=function(t,e){return this.Rt(t,e),this},Ki.prototype.delete=function(t){return this.Rt(t,null),this},Ki.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Li(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.tt(),e)},Ki.prototype.Pt=function(){var t=this.yt(li.ct(),this.At);return null!=t?new Qi(t):this.It},Ki.prototype.yt=function(r,t){var i=this,o=!1,e=this.It.field(r),s=Hi(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.yt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ki);function Ki(t){void 0===t&&(t=Qi.empty()),this.It=t,this.At=new Map}function Xi(t){this.proto=t}var Wi,Ji,Zi,c=function(t,e){this.key=t,this.version=e},$i=(n(oo,Zi=c),oo.prototype.field=function(t){return this.gt.field(t)},oo.prototype.data=function(){return this.gt},oo.prototype.bt=function(){return this.gt.proto},oo.prototype.isEqual=function(t){return t instanceof oo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},oo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(oo.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),oo),to=(n(io,Ji=c),io.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(io.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),io.prototype.isEqual=function(t){return t instanceof io&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},io),eo=(n(ro,Wi=c),ro.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ro.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),ro.prototype.isEqual=function(t){return t instanceof ro&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ro),no=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function ro(){return null!==Wi&&Wi.apply(this,arguments)||this}function io(t,e,n){var r=this;return(r=Ji.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function oo(t,e,n,r){var i=this;return(i=Zi.call(this,t,e)||this).gt=n,i.Vt=!!r.Vt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function so(t,e,n,r,i,o,s){return new no(t,e=void 0===e?null:e,n=void 0===n?[]:n,r=void 0===r?[]:r,i=void 0===i?null:i,o=void 0===o?null:o,s=void 0===s?null:s)}function uo(t){var e=t;return null===e.vt&&(t=e.path.rt(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.rt()+t.op.toString()+ji(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.rt()+t.dir}).join(","),ki(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Mo(e.startAt)),e.endAt&&(t+="|ub:",t+=Mo(e.endAt)),e.vt=t),e.vt}function ao(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Ri(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Fo(t.startAt,e.startAt)&&Fo(t.endAt,e.endAt)}function co(t){return pi.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var ho,fo=(n(lo,ho=function(){}),lo.create=function(t,e,n){return t.ut()?"in"===e||"not-in"===e?this.St(t,e,n):new go(t,e,n):"array-contains"===e?new xo(t,n):"in"===e?new Do(t,n):"not-in"===e?new Oo(t,n):"array-contains-any"===e?new ko(t,n):new lo(t,e,n)},lo.St=function(t,e,n){return new("in"===e?mo:bo)(t,n)},lo.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Dt(Mi(t,this.value)):null!==t&&Li(this.value)===Li(t)&&this.Dt(Mi(t,this.value))},lo.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},lo.prototype.Ct=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},lo);function lo(t,e,n){var r=this;return(r=ho.call(this)||this).field=t,r.op=e,r.value=n,r}var po,yo,vo,go=(n(Eo,vo=fo),Eo.prototype.matches=function(t){t=pi.H(t.key,this.key);return this.Dt(t)},Eo),mo=(n(_o,yo=fo),_o.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},_o),bo=(n(wo,po=fo),wo.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},wo);function wo(t,e){var n=this;return(n=po.call(this,t,"not-in",e)||this).keys=Io(0,e),n}function _o(t,e){var n=this;return(n=yo.call(this,t,"in",e)||this).keys=Io(0,e),n}function Eo(t,e,n){var r=this;return(r=vo.call(this,t,e,n)||this).key=pi.ft(n.referenceValue),r}function Io(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return pi.ft(t.referenceValue)})}var To,No,Ao,So,xo=(n(Vo,So=fo),Vo.prototype.matches=function(t){t=t.field(this.field);return Bi(t)&&Vi(t.arrayValue,this.value)},Vo),Do=(n(Ro,Ao=fo),Ro.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Vi(this.value.arrayValue,t)},Ro),Oo=(n(Lo,No=fo),Lo.prototype.matches=function(t){if(Vi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Vi(this.value.arrayValue,t)},Lo),ko=(n(Co,To=fo),Co.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Bi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Vi(e.value.arrayValue,t)})},Co),Po=function(t,e){this.position=t,this.before=e};function Co(t,e){return To.call(this,t,"array-contains-any",e)||this}function Lo(t,e){return No.call(this,t,"not-in",e)||this}function Ro(t,e){return Ao.call(this,t,"in",e)||this}function Vo(t,e){return So.call(this,t,"array-contains",e)||this}function Mo(t){return(t.before?"b":"a")+":"+t.position.map(ji).join(",")}var Uo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function jo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ut()?pi.H(pi.ft(s.referenceValue),n.key):Mi(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Fo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ri(t.position[n],e.position[n]))return!1;return!0}var qo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Nt=null,this.$t=null,this.startAt,this.endAt};function Bo(t,e,n,r,i,o,s,u){return new qo(t,e,n,r,i,o,s,u)}function Go(t){return new qo(t)}function zo(t){return!ki(t.limit)&&"F"===t.limitType}function Ho(t){return!ki(t.limit)&&"L"===t.limitType}function Qo(t){return 0<t.xt.length?t.xt[0].field:null}function Yo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function Ko(t){return null!==t.collectionGroup}function Xo(t){var e=t;if(null===e.Nt){e.Nt=[];var n=Yo(e),t=Qo(e);if(null!==n&&null===t)n.ut()||e.Nt.push(new Uo(n)),e.Nt.push(new Uo(li.ht(),"asc"));else{for(var r=!1,i=0,o=e.xt;i<o.length;i++){var s=o[i];e.Nt.push(s),s.field.ut()&&(r=!0)}r||(n=0<e.xt.length?e.xt[e.xt.length-1].dir:"asc",e.Nt.push(new Uo(li.ht(),n)))}}return e.Nt}function Wo(t){var e=t;if(!e.$t)if("F"===e.limitType)e.$t=so(e.path,e.collectionGroup,Xo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Xo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Uo(o.field,s))}var u=e.endAt?new Po(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Po(e.startAt.position,!e.startAt.before):null;e.$t=so(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.$t}function Jo(t,e,n){return new qo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Zo(t,e){return ao(Wo(t),Wo(e))&&t.limitType===e.limitType}function $o(t){return uo(Wo(t))+"|lt:"+t.limitType}function ts(t){return"Query(target="+(e=Wo(t),n=e.path.rt(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.rt()+" "+t.op+" "+ji(t.value)}).join(", ")+"]"),ki(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.rt()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Mo(e.startAt)),e.endAt&&(n+=", endAt: "+Mo(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function es(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.dt(e.collectionGroup)&&e.path.nt(n):pi.wt(e.path)?e.path.isEqual(n):e.path.st(n))&&function(t){for(var e=0,n=i.xt;e<n.length;e++){var r=n[e];if(!r.field.ut()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||jo(t.startAt,Xo(t),n))&&(!t.endAt||!jo(t.endAt,Xo(t),n)));var e,n}function ns(u){return function(t,e){for(var n=!1,r=0,i=Xo(u);r<i.length;r++){var o=i[r],s=function(t,r,e){var n=t.field.ut()?pi.H(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Mi(n,t):Pr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.ut()}return 0}}var rs=(is.prototype.kt=function(t){return new is(this.target,this.targetId,this.Ft,t,this.Ot,this.lastLimboFreeSnapshotVersion,this.resumeToken)},is.prototype.Mt=function(t,e){return new is(this.target,this.targetId,this.Ft,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},is.prototype.Lt=function(t){return new is(this.target,this.targetId,this.Ft,this.sequenceNumber,this.Ot,t,this.resumeToken)},is);function is(t,e,n,r,i,o,s){void 0===i&&(i=ci.min()),void 0===o&&(o=ci.min()),void 0===s&&(s=jr.T),this.target=t,this.targetId=e,this.Ft=n,this.sequenceNumber=r,this.Ot=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function os(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pi(e)?"-0":e}}function ss(t){return{integerValue:""+t}}function us(t,e){return Ci(e)?ss(e):os(t,e)}Ee=function(){this.qt=void 0};function as(t,e){return t instanceof _s?qi(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var cs,hs,fs=(n(ds,hs=Ee),ds),ls=(n(ps,cs=Ee),ps);function ps(t){var e=this;return(e=cs.call(this)||this).elements=t,e}function ds(){return null!==hs&&hs.apply(this,arguments)||this}function ys(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Ri(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(n(ms,vs=Ee),ms);function ms(t){var e=this;return(e=vs.call(this)||this).elements=t,e}function bs(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Ri(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ws,_s=(n(Es,ws=Ee),Es);function Es(t,e){var n=this;return(n=ws.call(this)||this).Qt=t,n.Ut=e,n}function Is(t){return Si(t.integerValue||t.doubleValue)}function Ts(t){return Bi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ns(t,e){this.version=t,this.transformResults=e}var As=function(t,e){this.field=t,this.transform=e},Ss=(xs.Kt=function(){return new xs},xs.exists=function(t){return new xs(void 0,t)},xs.updateTime=function(t){return new xs(t)},Object.defineProperty(xs.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),xs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},xs);function xs(t,e){this.updateTime=t,this.exists=e}function Ds(t,e){return void 0!==t.updateTime?e instanceof $i&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof $i}c=function(){};function Os(t,e,n){return t instanceof Rs?function(t,e,n){if(!Ds(t.jt,e))return e;var r=t.value,n=qs(t.fieldTransforms,n,e),r=Bs(t.fieldTransforms,r,n),e=Ps(e);return new $i(t.key,e,r,{Vt:!0})}(t,e,n):t instanceof Vs?function(t,e,n){if(!Ds(t.jt,e))return e;var r=Ps(e),e=js(t,e,qs(t.fieldTransforms,n,e));return new $i(t.key,r,e,{Vt:!0})}(t,e,n):(e=e,Ds((t=t).jt,e)?new to(t.key,ci.min()):e)}function ks(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Mr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ls&&e instanceof ls||t instanceof gs&&e instanceof gs?Mr(t.elements,e.elements,Ri):t instanceof _s&&e instanceof _s?Ri(t.Ut,e.Ut):t instanceof fs&&e instanceof fs)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt));var n,r}function Ps(t){return t instanceof $i?t.version:ci.min()}var Cs,Ls,Rs=(n(Us,Ls=c),Us),Vs=(n(Ms,Cs=c),Ms);function Ms(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Cs.call(this)||this).key=t,o.data=e,o.Gt=n,o.jt=r,o.fieldTransforms=i,o.type=1,o}function Us(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Ls.call(this)||this).key=t,i.value=e,i.jt=n,i.fieldTransforms=r,i.type=0,i}function js(t,e,n){var r,i,o;return i=t,e=r=e instanceof $i?e.data():Qi.empty(),o=new Yi(e),i.Gt.fields.forEach(function(t){var e;t.et()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o.Pt(),Bs(t.fieldTransforms,r,n)}function Fs(t,e,n){var r=[];Cr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof $i&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ls?ys(o,s):o instanceof gs?bs(o,s):u))}return r}function qs(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof $i&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,(a=a)instanceof fs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof ls?ys(a,r):a instanceof gs?bs(a,r):(a=as(c=a,r),r=Is(a)+Is(c.Ut),qi(a)&&qi(c.Ut)?ss(r):os(c.Qt,r))))}return i}function Bs(t,e,n){for(var r=new Yi(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Pt()}function Gs(t){this.count=t}var zs,Hs,Qs,Ys=(n(Ws,Qs=c),Ws),Ks=(n(Xs,Hs=c),Xs);function Xs(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.jt=e,n.type=3,n.fieldTransforms=[],n}function Ws(t,e){var n=this;return(n=Qs.call(this)||this).key=t,n.jt=e,n.type=2,n.fieldTransforms=[],n}function Js(t){switch(t){case Br.OK:return Pr(),0;case Br.CANCELLED:case Br.UNKNOWN:case Br.DEADLINE_EXCEEDED:case Br.RESOURCE_EXHAUSTED:case Br.INTERNAL:case Br.UNAVAILABLE:case Br.UNAUTHENTICATED:return;case Br.INVALID_ARGUMENT:case Br.NOT_FOUND:case Br.ALREADY_EXISTS:case Br.PERMISSION_DENIED:case Br.FAILED_PRECONDITION:case Br.ABORTED:case Br.OUT_OF_RANGE:case Br.UNIMPLEMENTED:case Br.DATA_LOSS:return 1;default:return Pr(),0}}function Zs(t){if(void 0===t)return Dr("GRPC error has no .code"),Br.UNKNOWN;switch(t){case zs.OK:return Br.OK;case zs.CANCELLED:return Br.CANCELLED;case zs.UNKNOWN:return Br.UNKNOWN;case zs.DEADLINE_EXCEEDED:return Br.DEADLINE_EXCEEDED;case zs.RESOURCE_EXHAUSTED:return Br.RESOURCE_EXHAUSTED;case zs.INTERNAL:return Br.INTERNAL;case zs.UNAVAILABLE:return Br.UNAVAILABLE;case zs.UNAUTHENTICATED:return Br.UNAUTHENTICATED;case zs.INVALID_ARGUMENT:return Br.INVALID_ARGUMENT;case zs.NOT_FOUND:return Br.NOT_FOUND;case zs.ALREADY_EXISTS:return Br.ALREADY_EXISTS;case zs.PERMISSION_DENIED:return Br.PERMISSION_DENIED;case zs.FAILED_PRECONDITION:return Br.FAILED_PRECONDITION;case zs.ABORTED:return Br.ABORTED;case zs.OUT_OF_RANGE:return Br.OUT_OF_RANGE;case zs.UNIMPLEMENTED:return Br.UNIMPLEMENTED;case zs.DATA_LOSS:return Br.DATA_LOSS;default:return Pr()}}(Ee=zs=zs||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var $s=(iu.prototype.zt=function(t,e){return new iu(this.H,this.root.zt(t,e,this.H).copy(null,null,eu.Ht,null,null))},iu.prototype.remove=function(t){return new iu(this.H,this.root.remove(t,this.H).copy(null,null,eu.Ht,null,null))},iu.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},iu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},iu.prototype.et=function(){return this.root.et()},Object.defineProperty(iu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),iu.prototype.Jt=function(){return this.root.Jt()},iu.prototype.Yt=function(){return this.root.Yt()},iu.prototype.Xt=function(t){return this.root.Xt(t)},iu.prototype.forEach=function(n){this.Xt(function(t,e){return n(t,e),!1})},iu.prototype.toString=function(){var n=[];return this.Xt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},iu.prototype.Zt=function(t){return this.root.Zt(t)},iu.prototype.te=function(){return new tu(this.root,null,this.H,!1)},iu.prototype.ee=function(t){return new tu(this.root,t,this.H,!1)},iu.prototype.ne=function(){return new tu(this.root,null,this.H,!0)},iu.prototype.se=function(t){return new tu(this.root,t,this.H,!0)},iu),tu=(ru.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},ru.prototype.ce=function(){return 0<this.re.length},ru.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},ru),eu=(nu.prototype.copy=function(t,e,n,r,i){return new nu(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},nu.prototype.et=function(){return!1},nu.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},nu.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},nu.prototype.min=function(){return this.left.et()?this:this.left.min()},nu.prototype.Jt=function(){return this.min().key},nu.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},nu.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},nu.prototype.he=function(){if(this.left.et())return nu.EMPTY;var t=this;return(t=(t=!t.left.le()&&!t.left.left.le()?t._e():t).copy(null,null,null,t.left.he(),null)).ue()},nu.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r=(r=!(r.left.et()||r.left.le()||r.left.left.le())?r._e():r).copy(null,null,null,r.left.remove(t,e),null);else{if(0===e(t,(r=!((r=r.left.le()?r.fe():r).right.et()||r.right.le()||r.right.left.le())?r.de():r).key)){if(r.right.et())return nu.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.he())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.ue()},nu.prototype.le=function(){return this.color},nu.prototype.ue=function(){var t=this;return t=(t=(t=t.right.le()&&!t.left.le()?t.we():t).left.le()&&t.left.left.le()?t.fe():t).left.le()&&t.right.le()?t.Ee():t},nu.prototype._e=function(){var t=this.Ee();return t=t.right.left.le()?(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee():t},nu.prototype.de=function(){var t=this.Ee();return t=t.left.left.le()?(t=t.fe()).Ee():t},nu.prototype.we=function(){var t=this.copy(null,null,nu.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},nu.prototype.fe=function(){var t=this.copy(null,null,nu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},nu.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},nu.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},nu.prototype.Ie=function(){if(this.le()&&this.left.le())throw Pr();if(this.right.le())throw Pr();var t=this.left.Ie();if(t!==this.right.Ie())throw Pr();return t+(this.le()?0:1)},nu);function nu(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:nu.RED,this.left=null!=r?r:nu.EMPTY,this.right=null!=i?i:nu.EMPTY,this.size=this.left.size+1+this.right.size}function ru(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}function iu(t,e){this.H=t,this.root=e||eu.EMPTY}function ou(){this.size=0}eu.EMPTY=null,eu.RED=!0,eu.Ht=!1,eu.EMPTY=(Object.defineProperty(ou.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ou.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ou.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ou.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ou.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),ou.prototype.copy=function(t,e,n,r,i){return this},ou.prototype.zt=function(t,e,n){return new eu(t,e)},ou.prototype.remove=function(t,e){return this},ou.prototype.et=function(){return!0},ou.prototype.Xt=function(t){return!1},ou.prototype.Zt=function(t){return!1},ou.prototype.Jt=function(){return null},ou.prototype.Yt=function(){return null},ou.prototype.le=function(){return!1},ou.prototype.Te=function(){return!0},ou.prototype.Ie=function(){return 0},new ou);var su=(hu.prototype.has=function(t){return null!==this.data.get(t)},hu.prototype.first=function(){return this.data.Jt()},hu.prototype.last=function(){return this.data.Yt()},Object.defineProperty(hu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),hu.prototype.indexOf=function(t){return this.data.indexOf(t)},hu.prototype.forEach=function(n){this.data.Xt(function(t,e){return n(t),!1})},hu.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(0<=this.H(r.key,t[1]))return;e(r.key)}},hu.prototype.Ae=function(t,e){for(var n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},hu.prototype.Re=function(t){t=this.data.ee(t);return t.ce()?t.oe().key:null},hu.prototype.te=function(){return new uu(this.data.te())},hu.prototype.ee=function(t){return new uu(this.data.ee(t))},hu.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},hu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},hu.prototype.et=function(){return this.data.et()},hu.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},hu.prototype.isEqual=function(t){if(!(t instanceof hu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.te(),n=t.data.te();e.ce();){var r=e.oe().key,i=n.oe().key;if(0!==this.H(r,i))return!1}return!0},hu.prototype.it=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},hu.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},hu.prototype.copy=function(t){var e=new hu(this.H);return e.data=t,e},hu),uu=(cu.prototype.oe=function(){return this.ye.oe().key},cu.prototype.ce=function(){return this.ye.ce()},cu),au=new $s(pi.H);function cu(t){this.ye=t}function hu(t){this.H=t,this.data=new $s(this.H)}var fu=new $s(pi.H);var lu=new $s(pi.H);var pu=new su(pi.H);function du(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=pu,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var yu=new su(Vr);var vu=(Pu.pe=function(t){return new Pu(t.H)},Pu.prototype.has=function(t){return null!=this.ge.get(t)},Pu.prototype.get=function(t){return this.ge.get(t)},Pu.prototype.first=function(){return this.Ve.Jt()},Pu.prototype.last=function(){return this.Ve.Yt()},Pu.prototype.et=function(){return this.Ve.et()},Pu.prototype.indexOf=function(t){t=this.ge.get(t);return t?this.Ve.indexOf(t):-1},Object.defineProperty(Pu.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),Pu.prototype.forEach=function(n){this.Ve.Xt(function(t,e){return n(t),!1})},Pu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},Pu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},Pu.prototype.isEqual=function(t){if(!(t instanceof Pu))return!1;if(this.size!==t.size)return!1;for(var e=this.Ve.te(),n=t.Ve.te();e.ce();){var r=e.oe().key,i=n.oe().key;if(!r.isEqual(i))return!1}return!0},Pu.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Pu.prototype.copy=function(t,e){var n=new Pu;return n.H=this.H,n.ge=t,n.Ve=e,n},Pu),gu=(ku.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);!n||0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):Pr()},ku.prototype.ve=function(){var n=[];return this.be.Xt(function(t,e){n.push(e)}),n},ku),mu=(Ou.Ne=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ou(t,e,vu.pe(e),i,n,r,!0,!1)},Object.defineProperty(Ou.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),Ou.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&Zo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ou),bu=(Du.Me=function(t,e){var n=new Map;return n.set(t,wu.Le(t,e)),new Du(ci.min(),n,yu,au,du())},Du),wu=(xu.Le=function(t,e){return new xu(jr.T,e,du(),du(),du())},xu),_u=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},Eu=function(t,e){this.targetId=t,this.je=e},Iu=function(t,e,n,r){void 0===n&&(n=jr.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Tu=(Object.defineProperty(Su.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(Su.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(Su.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(Su.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Su.prototype.tn=function(t){0<t.l()&&(this.Ye=!0,this.He=t)},Su.prototype.en=function(){var n=du(),r=du(),i=du();return this.ze.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new wu(this.He,this.Je,n,r,i)},Su.prototype.nn=function(){this.Ye=!1,this.ze=Lu()},Su.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},Su.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},Su.prototype.on=function(){this.Ge+=1},Su.prototype.cn=function(){--this.Ge},Su.prototype.an=function(){this.Ye=!0,this.Je=!0},Su),Nu=(Au.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof $i?this.wn(r,t.We):t.We instanceof to&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},Au.prototype.Tn=function(n){var r=this;this.In(n,function(t){var e=r.mn(t);switch(n.state){case 0:r.An(t)&&e.tn(n.resumeToken);break;case 1:e.cn(),e.Xe||e.nn(),e.tn(n.resumeToken);break;case 2:e.cn(),e.Xe||r.removeTarget(t);break;case 3:r.An(t)&&(e.an(),e.tn(n.resumeToken));break;case 4:r.An(t)&&(r.Rn(t),e.tn(n.resumeToken));break;default:Pr()}})},Au.prototype.In=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.hn.forEach(function(t,e){r.An(e)&&n(e)})},Au.prototype.Pn=function(t){var e=t.targetId,n=t.je.count,t=this.yn(e);t&&(co(t=t.target)?0===n?(t=new pi(t.path),this.En(e,t,new to(t,ci.min()))):Cr(1===n):this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e)))},Au.prototype.Vn=function(r){var i=this,o=new Map;this.hn.forEach(function(t,e){var n=i.yn(e);n&&(t.Be&&co(n.target)&&(n=new pi(n.target.path),null!==i.ln.get(n)||i.pn(e,n)||i.En(e,n,new to(n,r))),t.Ze&&(o.set(e,t.en()),t.nn()))});var s=du();this._n.forEach(function(t,e){var n=!0;e.Ae(function(t){t=i.yn(t);return!t||2===t.Ft||(n=!1)}),n&&(s=s.add(t))});var t=new bu(r,o,this.fn,this.ln,s);return this.ln=au,this._n=Cu(),this.fn=new su(Vr),t},Au.prototype.wn=function(t,e){var n;this.An(t)&&(n=this.pn(t,e.key)?2:0,this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t)))},Au.prototype.En=function(t,e,n){var r;this.An(t)&&(r=this.mn(t),this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n)))},Au.prototype.removeTarget=function(t){this.hn.delete(t)},Au.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},Au.prototype.on=function(t){this.mn(t).on()},Au.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new Tu,this.hn.set(t,e)),e},Au.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new su(Vr),this._n=this._n.zt(t,e)),e},Au.prototype.An=function(t){var e=null!==this.yn(t);return e||xr("WatchChangeAggregator","Detected inactive target",t),e},Au.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},Au.prototype.Rn=function(e){var n=this;this.hn.set(e,new Tu),this.un.vn(e).forEach(function(t){n.En(e,t,null)})},Au.prototype.pn=function(t,e){return this.un.vn(t).has(e)},Au);function Au(t){this.un=t,this.hn=new Map,this.ln=au,this._n=Cu(),this.fn=new su(Vr)}function Su(){this.Ge=0,this.ze=Lu(),this.He=jr.T,this.Je=!1,this.Ye=!0}function xu(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}function Du(t,e,n,r,i){this.Ot=t,this.$e=e,this.Fe=n,this.Oe=r,this.ke=i}function Ou(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=s,this.xe=u}function ku(){this.be=new $s(pi.H)}function Pu(n){this.H=n?function(t,e){return n(t,e)||pi.H(t.key,e.key)}:function(t,e){return pi.H(t.key,e.key)},this.ge=fu,this.Ve=new $s(this.H)}function Cu(){return new $s(pi.H)}function Lu(){return new $s(pi.H)}var Ru={asc:"ASCENDING",desc:"DESCENDING"},Vu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Mu=function(t,e){this.t=t,this.Bt=e};function Uu(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ju(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function Fu(t){return Cr(!!t),ci.K((t=Ai(t),new ai(t.seconds,t.nanos)))}function qu(t,e){return new hi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).rt()}function Bu(t){t=hi.ot(t);return Cr(aa(t)),t}function Gu(t,e){return qu(t.t,e.path)}function zu(t,e){e=Bu(e);if(e.get(1)!==t.t.projectId)throw new Gr(Br.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Gr(Br.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new pi(Ku(e))}function Hu(t,e){return qu(t.t,e)}function Qu(t){t=Bu(t);return 4===t.length?hi.ct():Ku(t)}function Yu(t){return new hi(["projects",t.t.projectId,"databases",t.t.database]).rt()}function Ku(t){return Cr(4<t.length&&"documents"===t.get(4)),t.Y(5)}function Xu(t,e,n){return{name:Gu(t,e),fields:n.proto.mapValue.fields}}function Wu(t,e,n){var r=zu(t,e.name),t=Fu(e.updateTime),e=new Qi({mapValue:{fields:e.fields}});return new $i(r,t,e,{hasCommittedMutations:!!n})}function Ju(t,e){var n,r,i;if(e instanceof Rs)n={update:Xu(t,e.key,e.value)};else if(e instanceof Ys)n={delete:Gu(t,e.key)};else if(e instanceof Vs)n={update:Xu(t,e.key,e.data),updateMask:(i=e.Gt,r=[],i.fields.forEach(function(t){return r.push(t.rt())}),{fieldPaths:r})};else{if(!(e instanceof Ks))return Pr();n={verify:Gu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof fs)return{fieldPath:t.field.rt(),setToServerValue:"REQUEST_TIME"};if(e instanceof ls)return{fieldPath:t.field.rt(),appendMissingElements:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.rt(),removeAllFromArray:{values:e.elements}};if(e instanceof _s)return{fieldPath:t.field.rt(),increment:e.Ut};throw Pr()})),e.jt.Wt||(n.currentDocument=void 0!==(i=e.jt).updateTime?{updateTime:(e=t,t=i.updateTime,Uu(e,t.j()))}:void 0!==i.exists?{exists:i.exists}:Pr()),n}function Zu(e,t){var n=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?Ss.updateTime(Fu(s.updateTime)):void 0!==s.exists?Ss.exists(s.exists):Ss.Kt():Ss.Kt(),r=t.updateTransforms?t.updateTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Cr("REQUEST_TIME"===e.setToServerValue),r=new fs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new ls(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new gs(n)):"increment"in e?r=new _s(t,e.increment):Pr();e=li.lt(e.fieldPath);return new As(e,r)}(e,t)}):[];if(t.update){t.update.name;var i=zu(e,t.update.name),o=new Qi({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=(s=t.updateMask.fieldPaths||[],new Ii(s.map(function(t){return li.lt(t)})));return new Vs(i,o,s,n,r)}return new Rs(i,o,n,r)}if(t.delete){r=zu(e,t.delete);return new Ys(r,n)}if(t.verify){t=zu(e,t.verify);return new Ks(t,n)}return Pr()}function $u(t,e){return{documents:[Hu(t,e.path)]}}function ta(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Hu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Hu(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(zi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NAN"}};if(Gi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(zi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NOT_NAN"}};if(Gi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ia(t.field),op:(e=t.op,Vu[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:ia((t=t).field),direction:(t=t.dir,Ru[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Bt||ki(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=na(e.startAt)),e.endAt&&(n.structuredQuery.endAt=na(e.endAt)),n}function ea(t){var e=Qu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Cr(1===r),(u=n.from[0]).allDescendants?i=u.collectionId:e=e.child(u.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ua(t)]:void 0!==t.fieldFilter?[sa(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Pr():[]}(n.where));var s=[],t=null,r=null,u=null;return Bo(e,i,s=n.orderBy?n.orderBy.map(function(t){return new Uo(oa((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}):s,o,t=n.limit?ki(o="object"==typeof(o=n.limit)?o.value:o)?null:o:t,"F",r=n.startAt?ra(n.startAt):r,u=n.endAt?ra(n.endAt):u)}function na(t){return{before:t.before,values:t.position}}function ra(t){var e=!!t.before,t=t.values||[];return new Po(t,e)}function ia(t){return{fieldPath:t.rt()}}function oa(t){return li.lt(t.fieldPath)}function sa(t){return fo.create(oa(t.fieldFilter.field),function(){switch(t.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Pr()}}(),t.fieldFilter.value)}function ua(t){switch(t.unaryFilter.op){case"IS_NAN":var e=oa(t.unaryFilter.field);return fo.create(e,"==",{doubleValue:NaN});case"IS_NULL":e=oa(t.unaryFilter.field);return fo.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var n=oa(t.unaryFilter.field);return fo.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":n=oa(t.unaryFilter.field);return fo.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Pr()}}function aa(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var ca,ha=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},fa=(wa.prototype.catch=function(t){return this.next(void 0,t)},wa.prototype.next=function(r,i){var o=this;return this.Nn&&Pr(),this.Nn=!0,this.xn?this.error?this.$n(i,this.error):this.Fn(r,this.result):new wa(function(e,n){o.Dn=function(t){o.Fn(r,t).next(e,n)},o.Cn=function(t){o.$n(i,t).next(e,n)}})},wa.prototype.On=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},wa.prototype.kn=function(t){try{var e=t();return e instanceof wa?e:wa.resolve(e)}catch(t){return wa.reject(t)}},wa.prototype.Fn=function(t,e){return t?this.kn(function(){return t(e)}):wa.resolve(e)},wa.prototype.$n=function(t,e){return t?this.kn(function(){return t(e)}):wa.reject(e)},wa.resolve=function(n){return new wa(function(t,e){t(n)})},wa.reject=function(n){return new wa(function(t,e){e(n)})},wa.Mn=function(t){return new wa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},wa.Ln=function(t){for(var n=wa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?wa.resolve(t):e()})}(r[e]);return n},wa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Mn(i)},wa),la=(ba.open=function(t,e,n,r){try{return new ba(e,t.transaction(r,n))}catch(t){throw new ya(e,t)}},Object.defineProperty(ba.prototype,"qn",{get:function(){return this.Bn.promise},enumerable:!1,configurable:!0}),ba.prototype.abort=function(t){t&&this.Bn.reject(t),this.aborted||(xr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},ba.prototype.store=function(t){t=this.transaction.objectStore(t);return new Ea(t)},ba),pa=(ma.delete=function(t){return xr("SimpleDb","Removing database:",t),Ta(window.indexedDB.deleteDatabase(t)).On()},ma.Kn=function(){if("undefined"==typeof indexedDB)return!1;if(ma.Wn())return!0;var t=f(),e=ma.Qn(t),n=0<e&&e<10,e=ma.jn(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},ma.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Gn)},ma.zn=function(t,e){return t.store(e)},ma.Qn=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},ma.jn=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},ma.prototype.Hn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(xr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new ya(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Gr(Br.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ya(o,t))},r.onupgradeneeded=function(t){xr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Un.Jn(e,r.transaction,t.oldVersion,i.version).next(function(){xr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Yn&&(this.db.onversionchange=function(t){return i.Yn(t)}),this.db)]}})})},ma.prototype.Xn=function(e){this.Yn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ma.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Hn(u)];case 2:return s.db=t.sent(),e=la.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),fa.reject(t)}).On(),r={},n.catch(function(){}),[4,e.qn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,xr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ma.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ma),da=(Object.defineProperty(ga.prototype,"xn",{get:function(){return this.ts},enumerable:!1,configurable:!0}),Object.defineProperty(ga.prototype,"ns",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(ga.prototype,"cursor",{set:function(t){this.Zn=t},enumerable:!1,configurable:!0}),ga.prototype.done=function(){this.ts=!0},ga.prototype.ss=function(t){this.es=t},ga.prototype.delete=function(){return Ta(this.Zn.delete())},ga),ya=(n(va,ca=Gr),va);function va(t,e){var n=this;return(n=ca.call(this,Br.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function ga(t){this.Zn=t,this.ts=!1,this.es=null}function ma(t,e,n){this.name=t,this.version=e,this.Un=n,12.2===ma.Qn(f())&&Dr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function ba(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Bn=new ha,this.transaction.oncomplete=function(){n.Bn.resolve()},this.transaction.onabort=function(){t.error?n.Bn.reject(new ya(e,t.error)):n.Bn.resolve()},this.transaction.onerror=function(t){t=Aa(t.target.error);n.Bn.reject(new ya(e,t))}}function wa(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t(function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)},function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)})}function _a(t){return"IndexedDbTransactionError"===t.name}var Ea=(Ia.prototype.put=function(t,e){t=void 0!==e?(xr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(xr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ta(t)},Ia.prototype.add=function(t){return xr("SimpleDb","ADD",this.store.name,t,t),Ta(this.store.add(t))},Ia.prototype.get=function(e){var n=this;return Ta(this.store.get(e)).next(function(t){return void 0===t&&(t=null),xr("SimpleDb","GET",n.store.name,e,t),t})},Ia.prototype.delete=function(t){return xr("SimpleDb","DELETE",this.store.name,t),Ta(this.store.delete(t))},Ia.prototype.count=function(){return xr("SimpleDb","COUNT",this.store.name),Ta(this.store.count())},Ia.prototype.rs=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.os(e,function(t,e){n.push(e)}).next(function(){return n})},Ia.prototype.cs=function(t,e){xr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.us=!1;e=this.cursor(e);return this.os(e,function(t,e,n){return n.delete()})},Ia.prototype.hs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.os(n,e)},Ia.prototype.ls=function(r){var t=this.cursor({});return new fa(function(n,e){t.onerror=function(t){t=Aa(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ia.prototype.os=function(t,i){var o=[];return new fa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new da(n),(t=i(n.primaryKey,n.value,e))instanceof fa&&(t=t.catch(function(t){return e.done(),fa.reject(t)}),o.push(t)),e.xn?r():null===e.ns?n.continue():n.continue(e.ns)):r()}}).next(function(){return fa.Mn(o)})},Ia.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ia.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.us?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ia);function Ia(t){this.store=t}function Ta(t){return new fa(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Aa(t.target.error);n(t)}})}var Na=!1;function Aa(t){var e=pa.Qn(f());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Gr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Na||(Na=!0,setTimeout(function(){throw n},0)),n}}return t}var Sa=(xa.Ts=function(t,e,n,r,i){i=new xa(t,e,Date.now()+n,r,i);return i.start(n),i},xa.prototype.start=function(t){var e=this;this.Is=setTimeout(function(){return e.As()},t)},xa.prototype.Rs=function(){return this.As()},xa.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new Gr(Br.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},xa.prototype.As=function(){var e=this;this._s.Ps(function(){return null!==e.Is?(e.clearTimeout(),e.op().then(function(t){return e.Es.resolve(t)})):Promise.resolve()})},xa.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},xa);function xa(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new ha,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch(function(t){})}function Da(t,e){if(Dr("AsyncQueue",e+": "+t),_a(t))return new Gr(Br.UNAVAILABLE,e+": "+t);throw t}var Oa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",c=(ka.prototype.gs=function(t){this.ys.push(t)},ka.prototype.Vs=function(){this.ys.forEach(function(t){return t()})},ka);function ka(){this.ys=[]}function Pa(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Ca(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return Ca(e)}function Ca(t){return t+"\x01\x01"}function La(t){var e=t.length;if(Cr(2<=e),2===e)return Cr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),hi.ct();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Pr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Pr()}o=s+2}return new hi(r)}function Ra(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var Va=function(t,e){this.seconds=t,this.nanoseconds=e};Ra.store="owner",Ra.key="owner";function Ma(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}Ma.store="mutationQueues",Ma.keyPath="userId";function Ua(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}Ua.store="mutations",Ua.keyPath="batchId",Ua.userMutationsIndex="userMutationsIndex",Ua.userMutationsKeyPath=["userId","batchId"];var ja=(Fa.prefixForUser=function(t){return[t]},Fa.prefixForPath=function(t,e){return[t,Pa(e)]},Fa.key=function(t,e,n){return[t,Pa(e),n]},Fa);function Fa(){}ja.store="documentMutations",ja.PLACEHOLDER=new ja;function qa(t,e){this.path=t,this.readTime=e}function Ba(t,e){this.path=t,this.version=e}var Ga=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ga.store="remoteDocuments",Ga.readTimeIndex="readTimeIndex",Ga.readTimeIndexPath="readTime",Ga.collectionReadTimeIndex="collectionReadTimeIndex",Ga.collectionReadTimeIndexPath=["parentPath","readTime"];function za(t){this.byteSize=t}za.store="remoteDocumentGlobal",za.key="remoteDocumentGlobalKey";function Ha(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}Ha.store="targets",Ha.keyPath="targetId",Ha.queryTargetsIndexName="queryTargetsIndex",Ha.queryTargetsKeyPath=["canonicalId","targetId"];var Qa=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Qa.store="targetDocuments",Qa.keyPath=["targetId","path"],Qa.documentTargetsIndex="documentTargetsIndex",Qa.documentTargetsKeyPath=["path","targetId"];function Ya(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}Ya.key="targetGlobalKey",Ya.store="targetGlobal";function Ka(t,e){this.collectionId=t,this.parent=e}Ka.store="collectionParents",Ka.keyPath=["collectionId","parent"];function Xa(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}Xa.store="clientMetadata",Xa.keyPath="clientId";function Wa(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}Wa.store="bundles",Wa.keyPath="bundleId";function Ja(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}Ja.store="namedQueries",Ja.keyPath="name";var Za,$a=s(s([],s(s([],s(s([],s(s([],[Ma.store,Ua.store,ja.store,Ga.store,Ha.store,Ra.store,Ya.store,Qa.store]),[Xa.store])),[za.store])),[Ka.store])),[Wa.store,Ja.store]),tc=(n(ec,Za=c),ec);function ec(t,e){var n=this;return(n=Za.call(this)||this).ps=t,n.bs=e,n}function nc(t,e){return pa.zn(t.ps,e)}var rc=(uc.prototype.Ss=function(t,e,n){for(var r,i,o,s,u,a,c=n.Ds,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof Rs?(u=o,a=(s=r).value,f=Fs(s.fieldTransforms,i,u.transformResults),a=Bs(s.fieldTransforms,a,f),new $i(s.key,u.version,a,{hasCommittedMutations:!0})):r instanceof Vs?function(t,e,n){if(!Ds(t.jt,e))return new eo(t.key,n.version);e=js(t,e,Fs(t.fieldTransforms,e,n.transformResults));return new $i(t.key,n.version,e,{hasCommittedMutations:!0})}(r,i,o):new to(r.key,o.version,{hasCommittedMutations:!0}))}return e},uc.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Os(i,e,this.vs));for(var i,o=0,s=this.mutations;o<s.length;o++)(i=s[o]).key.isEqual(t)&&(e=Os(i,e,this.vs));return e},uc.prototype.xs=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Cs(t.key,n.get(t.key));e&&(i=i.zt(t.key,e))}),i},uc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},du())},uc.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,ks)&&Mr(this.baseMutations,t.baseMutations,ks)},uc),ic=(sc.from=function(t,e,n){Cr(t.mutations.length===n.length);for(var r=lu,i=t.mutations,o=0;o<i.length;o++)r=r.zt(i[o].key,n[o].version);return new sc(t,e,n,r)},sc),oc=function(t){this.Fs=t};function sc(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.$s=r}function uc(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}function ac(t,e){if(e.document)return Wu(t.Fs,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=pi.Et(e.noDocument.path),r=pc(e.noDocument.readTime);return new to(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){n=pi.Et(e.unknownDocument.path),r=pc(e.unknownDocument.version);return new eo(n,r)}return Pr()}function cc(t,e,n){var r=hc(n),n=e.key.path.X().it();if(e instanceof $i){var i={name:Gu(o=t.Fs,(s=e).key),fields:s.bt().mapValue.fields,updateTime:Uu(o,s.version.j())},o=e.hasCommittedMutations;return new Ga(null,null,i,o,r,n)}if(e instanceof to){var s=e.key.path.it(),i=lc(e.version),o=e.hasCommittedMutations;return new Ga(null,new qa(s,i),null,o,r,n)}if(e instanceof eo){o=e.key.path.it(),e=lc(e.version);return new Ga(new Ba(o,e),null,null,!0,r,n)}return Pr()}function hc(t){t=t.j();return[t.seconds,t.nanoseconds]}function fc(t){t=new ai(t[0],t[1]);return ci.K(t)}function lc(t){t=t.j();return new Va(t.seconds,t.nanoseconds)}function pc(t){t=new ai(t.seconds,t.nanoseconds);return ci.K(t)}function dc(e,t){for(var n=(t.baseMutations||[]).map(function(t){return Zu(e.Fs,t)}),r=0;r<t.mutations.length-1;++r){var i,o=t.mutations[r];r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform&&(i=t.mutations[r+1],o.updateTransforms=i.transform.fieldTransforms,t.mutations.splice(r+1,1),++r)}var s=t.mutations.map(function(t){return Zu(e.Fs,t)}),u=ai.fromMillis(t.localWriteTimeMs);return new rc(t.batchId,u,n,s)}function yc(t){var e=pc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?pc(t.lastLimboFreeSnapshotVersion):ci.min(),r=void 0!==t.query.documents?(Cr(1===(r=t.query).documents.length),Wo(Go(Qu(r.documents[0])))):Wo(ea(t.query));return new rs(r,t.targetId,0,t.lastListenSequenceNumber,e,n,jr.fromBase64String(t.resumeToken))}function vc(t,e){var n=lc(e.Ot),r=lc(e.lastLimboFreeSnapshotVersion),i=(co(e.target)?$u:ta)(t.Fs,e.target),t=e.resumeToken.toBase64();return new Ha(e.targetId,uo(e.target),n,t,e.sequenceNumber,r,i)}function gc(t){var e=ea({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Jo(e,e.limit,"L"):e}var mc=(bc.prototype.Os=function(t,e){return wc(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:pc(t.createTime),version:t.version}})},bc.prototype.ks=function(t,e){return wc(t).put({bundleId:(e=e).id,createTime:lc(Fu(e.createTime)),version:e.version})},bc.prototype.Ms=function(t,e){return _c(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:gc(t.bundledQuery),readTime:pc(t.readTime)}})},bc.prototype.Ls=function(t,e){return _c(t).put({name:(e=e).name,readTime:lc(Fu(e.readTime)),bundledQuery:e.bundledQuery})},bc);function bc(){}function wc(t){return nc(t,Wa.store)}function _c(t){return nc(t,Ja.store)}var Ec=(Sc.prototype.qs=function(t,e){return this.Bs.add(e),fa.resolve()},Sc.prototype.Us=function(t,e){return fa.resolve(this.Bs.getEntries(e))},Sc),Ic=(Ac.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new su(hi.H),t=!r.has(n);return this.index[e]=r.add(n),t},Ac.prototype.has=function(t){var e=t.tt(),t=t.X(),e=this.index[e];return e&&e.has(t)},Ac.prototype.getEntries=function(t){return(this.index[t]||new su(hi.H)).it()},Ac),Tc=(Nc.prototype.qs=function(t,e){var n=this;if(this.Qs.has(e))return fa.resolve();var r=e.tt(),i=e.X();t.gs(function(){n.Qs.add(e)});i={collectionId:r,parent:Pa(i)};return xc(t).put(i)},Nc.prototype.Us=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Ur(i),""],!1,!0);return xc(t).rs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(La(r.parent))}return o})},Nc);function Nc(){this.Qs=new Ic}function Ac(){this.index={}}function Sc(){this.Bs=new Ic}function xc(t){return nc(t,Ka.store)}var Dc={Ks:!1,Ws:0,js:0,Gs:0},Oc=(kc.Ys=function(t){return new kc(t,kc.Xs,kc.Zs)},kc);function kc(t,e,n){this.zs=t,this.Hs=e,this.Js=n}function Pc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Br.FAILED_PRECONDITION||e.message!==Oa)throw e;return xr("LocalStore","Unexpectedly lost primary lease"),[2]})})}Oc.Xs=10,Oc.Zs=1e3,Oc.ti=new Oc(41943040,Oc.Xs,Oc.Zs),Oc.ei=new Oc(-1,0,0);var Cc=(Rc.prototype.get=function(t){var e=this.ni(t),e=this.ii[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.si(o,t))return i}},Rc.prototype.has=function(t){return void 0!==this.get(t)},Rc.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},Rc.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},Rc.prototype.forEach=function(s){_i(this.ii,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Rc.prototype.et=function(){return Ei(this.ii)},Rc),Ee=(Lc.prototype.ci=function(t){t=this.ri.get(t);return t?t.readTime:ci.min()},Lc.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},Lc.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},Lc.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?fa.resolve(n.hi):this.fi(t,e)},Lc.prototype.getEntries=function(t,e){return this.di(t,e)},Lc.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},Lc.prototype.ui=function(){},Lc);function Lc(){this.ri=new Cc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.oi=!1}function Rc(t,e){this.ni=t,this.si=e,this.ii={}}function Vc(t,e,n){var r=t.store(Ua.store),i=t.store(ja.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.hs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Cr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=ja.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return fa.Mn(o).next(function(){return u})}function Mc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Pr();e=t.noDocument}return JSON.stringify(e).length}var Uc=(jc.mi=function(t,e,n,r){return Cr(""!==t.uid),new jc(t.m()?t.uid:"",e,n,r)},jc.prototype.Ai=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return qc(t).hs({index:Ua.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},jc.prototype.Ri=function(d,y,v,g){var m=this,b=Bc(d),w=qc(d);return w.add({}).next(function(t){Cr("number"==typeof t);for(var e,n,r,i,o,s=new rc(t,y,v,g),u=(e=m.Qt,n=m.userId,i=(r=s).baseMutations.map(function(t){return Ju(e.Fs,t)}),o=r.mutations.map(function(t){return Ju(e.Fs,t)}),new Ua(n,r.batchId,r.vs.toMillis(),i,o)),a=[],c=new su(function(t,e){return Vr(t.rt(),e.rt())}),h=0,f=g;h<f.length;h++){var l=f[h],p=ja.key(m.userId,l.key.path,t),c=c.add(l.key.path.X());a.push(w.put(u)),a.push(b.put(p,ja.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Ei.qs(d,t))}),d.gs(function(){m.Ii[t]=s.keys()}),fa.Mn(a).next(function(){return s})})},jc.prototype.Pi=function(t,e){var n=this;return qc(t).get(e).next(function(t){return t?(Cr(t.userId===n.userId),dc(n.Qt,t)):null})},jc.prototype.yi=function(t,e){var n=this;return this.Ii[e]?fa.resolve(this.Ii[e]):this.Pi(t,e).next(function(t){if(t){t=t.keys();return n.Ii[e]=t}return null})},jc.prototype.gi=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return qc(t).hs({index:Ua.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Cr(e.batchId>=i),o=dc(r.Qt,e)),n.done()}).next(function(){return o})},jc.prototype.Vi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return qc(t).hs({index:Ua.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},jc.prototype.pi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return qc(t).rs(Ua.userMutationsIndex,n).next(function(t){return t.map(function(t){return dc(e.Qt,t)})})},jc.prototype.bi=function(o,s){var u=this,t=ja.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Bc(o).hs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=La(i);if(r===u.userId&&s.path.isEqual(i))return qc(o).get(t).next(function(t){if(!t)throw Pr();Cr(t.userId===u.userId),a.push(dc(u.Qt,t))});n.done()}).next(function(){return a})},jc.prototype.vi=function(e,t){var s=this,u=new su(Vr),n=[];return t.forEach(function(o){var t=ja.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Bc(e).hs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=La(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),fa.Mn(n).next(function(){return s.Si(e,u)})},jc.prototype.Di=function(t,e){var o=this,s=e.path,u=s.length+1,e=ja.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new su(Vr);return Bc(t).hs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=La(i);r===o.userId&&s.nt(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Si(t,a)})},jc.prototype.Si=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(qc(e).get(t).next(function(t){if(null===t)throw Pr();Cr(t.userId===n.userId),r.push(dc(n.Qt,t))}))}),fa.Mn(i).next(function(){return r})},jc.prototype.Ci=function(e,n){var r=this;return Vc(e.ps,this.userId,n).next(function(t){return e.gs(function(){r.xi(n.batchId)}),fa.forEach(t,function(t){return r.Ti.Ni(e,t)})})},jc.prototype.xi=function(t){delete this.Ii[t]},jc.prototype.$i=function(e){var i=this;return this.Ai(e).next(function(t){if(!t)return fa.resolve();var t=IDBKeyRange.lowerBound(ja.prefixForUser(i.userId)),r=[];return Bc(e).hs({range:t},function(t,e,n){t[0]===i.userId?(t=La(t[1]),r.push(t)):n.done()}).next(function(){Cr(0===r.length)})})},jc.prototype.Fi=function(t,e){return Fc(t,this.userId,e)},jc.prototype.Oi=function(t){var e=this;return Gc(t).get(this.userId).next(function(t){return t||new Ma(e.userId,-1,"")})},jc);function jc(t,e,n,r){this.userId=t,this.Qt=e,this.Ei=n,this.Ti=r,this.Ii={}}function Fc(t,o,e){var e=ja.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Bc(t).hs({range:e,us:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function qc(t){return nc(t,Ua.store)}function Bc(t){return nc(t,ja.store)}function Gc(t){return nc(t,Ma.store)}var zc=(Yc.prototype.next=function(){return this.ki+=2,this.ki},Yc.Mi=function(){return new Yc(0)},Yc.Li=function(){return new Yc(-1)},Yc),Hc=(Qc.prototype.Bi=function(n){var r=this;return this.qi(n).next(function(t){var e=new zc(t.highestTargetId);return t.highestTargetId=e.next(),r.Ui(n,t).next(function(){return t.highestTargetId})})},Qc.prototype.Qi=function(t){return this.qi(t).next(function(t){return ci.K(new ai(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Qc.prototype.Ki=function(t){return this.qi(t).next(function(t){return t.highestListenSequenceNumber})},Qc.prototype.Wi=function(e,n,r){var i=this;return this.qi(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.j()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ui(e,t)})},Qc.prototype.ji=function(e,n){var r=this;return this.Gi(e,n).next(function(){return r.qi(e).next(function(t){return t.targetCount+=1,r.zi(n,t),r.Ui(e,t)})})},Qc.prototype.Hi=function(t,e){return this.Gi(t,e)},Qc.prototype.Ji=function(e,t){var n=this;return this.Yi(e,t.targetId).next(function(){return Kc(e).delete(t.targetId)}).next(function(){return n.qi(e)}).next(function(t){return Cr(0<t.targetCount),--t.targetCount,n.Ui(e,t)})},Qc.prototype.Xi=function(n,r,i){var o=this,s=0,u=[];return Kc(n).hs(function(t,e){e=yc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Ji(n,e)))}).next(function(){return fa.Mn(u)}).next(function(){return s})},Qc.prototype.In=function(t,n){return Kc(t).hs(function(t,e){e=yc(e);n(e)})},Qc.prototype.qi=function(t){return Xc(t).get(Ya.key).next(function(t){return Cr(null!==t),t})},Qc.prototype.Ui=function(t,e){return Xc(t).put(Ya.key,e)},Qc.prototype.Gi=function(t,e){return Kc(t).put(vc(this.Qt,e))},Qc.prototype.zi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Qc.prototype.Zi=function(t){return this.qi(t).next(function(t){return t.targetCount})},Qc.prototype.tr=function(t,r){var e=uo(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Kc(t).hs({range:e,index:Ha.queryTargetsIndexName},function(t,e,n){e=yc(e);ao(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Qc.prototype.er=function(n,t,r){var i=this,o=[],s=Wc(n);return t.forEach(function(t){var e=Pa(t.path);o.push(s.put(new Qa(r,e))),o.push(i.Ti.nr(n,r,t))}),fa.Mn(o)},Qc.prototype.sr=function(n,t,r){var i=this,o=Wc(n);return fa.forEach(t,function(t){var e=Pa(t.path);return fa.Mn([o.delete([r,e]),i.Ti.ir(n,r,t)])})},Qc.prototype.Yi=function(t,e){t=Wc(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},Qc.prototype.rr=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Wc(t),r=du();return t.hs({range:e,us:!0},function(t,e,n){t=La(t[1]),t=new pi(t);r=r.add(t)}).next(function(){return r})},Qc.prototype.Fi=function(t,e){var e=Pa(e.path),e=IDBKeyRange.bound([e],[Ur(e)],!1,!0),i=0;return Wc(t).hs({index:Qa.documentTargetsIndex,us:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Qc.prototype.Sn=function(t,e){return Kc(t).get(e).next(function(t){return t?yc(t):null})},Qc);function Qc(t,e){this.Ti=t,this.Qt=e}function Yc(t){this.ki=t}function Kc(t){return nc(t,Ha.store)}function Xc(t){return nc(t,Ya.store)}function Wc(t){return nc(t,Qa.store)}function Jc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=Vr(n,t);return 0===t?Vr(r,e):t}var Zc=(oh.prototype.ur=function(){return++this.ar},oh.prototype.hr=function(t){var e=[t,this.ur()];this.buffer.size<this.cr?this.buffer=this.buffer.add(e):Jc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(oh.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),oh),$c=(ih.prototype.start=function(t){-1!==this.lr.params.zs&&this.wr(t)},ih.prototype.stop=function(){this.dr&&(this.dr.cancel(),this.dr=null)},Object.defineProperty(ih.prototype,"Er",{get:function(){return null!==this.dr},enumerable:!1,configurable:!0}),ih.prototype.wr=function(n){var t=this,e=this._r?3e5:6e4;xr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.dr=this._s.Tr("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.dr=null,this._r=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Ir(this.lr)];case 2:return t.sent(),[3,7];case 3:return _a(e=t.sent())?(xr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Pc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.wr(n)];case 8:return t.sent(),[2]}})})})},ih),th=(rh.prototype.Ar=function(t,e){return this.mr.Rr(t).next(function(t){return Math.floor(e/100*t)})},rh.prototype.Pr=function(t,e){var n=this;if(0===e)return fa.resolve(ti.q);var r=new Zc(e);return this.mr.In(t,function(t){return r.hr(t.sequenceNumber)}).next(function(){return n.mr.yr(t,function(t){return r.hr(t)})}).next(function(){return r.maxValue})},rh.prototype.Xi=function(t,e,n){return this.mr.Xi(t,e,n)},rh.prototype.gr=function(t,e){return this.mr.gr(t,e)},rh.prototype.Vr=function(e,n){var r=this;return-1===this.params.zs?(xr("LruGarbageCollector","Garbage collection skipped; disabled"),fa.resolve(Dc)):this.pr(e).next(function(t){return t<r.params.zs?(xr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.zs),Dc):r.br(e,n)})},rh.prototype.pr=function(t){return this.mr.pr(t)},rh.prototype.br=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ar(e,this.params.Hs).next(function(t){return i=t>h.params.Js?(xr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Js+" from "+t),h.params.Js):t,s=Date.now(),h.Pr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Xi(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.gr(e,r)}).next(function(t){return c=Date.now(),Sr()<=l.DEBUG&&xr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),fa.resolve({Ks:!0,Ws:i,js:o,Gs:t})})},rh),eh=(nh.prototype.Rr=function(t){var n=this.vr(t);return this.db.Sr().Zi(t).next(function(e){return n.next(function(t){return e+t})})},nh.prototype.vr=function(t){var e=0;return this.yr(t,function(t){e++}).next(function(){return e})},nh.prototype.In=function(t,e){return this.db.Sr().In(t,e)},nh.prototype.yr=function(t,n){return this.Dr(t,function(t,e){return n(e)})},nh.prototype.nr=function(t,e,n){return sh(t,n)},nh.prototype.ir=function(t,e,n){return sh(t,n)},nh.prototype.Xi=function(t,e,n){return this.db.Sr().Xi(t,e,n)},nh.prototype.Ni=sh,nh.prototype.Cr=function(t,e){return r=e,i=!1,Gc(n=t).ls(function(t){return Fc(n,t,r).next(function(t){return t&&(i=!0),fa.resolve(!t)})}).next(function(){return i});var n,r,i},nh.prototype.gr=function(n,r){var i=this,o=this.db.$r().Nr(),s=[],u=0;return this.Dr(n,function(e,t){t<=r&&(t=i.Cr(n,e).next(function(t){if(!t)return u++,o._i(n,e).next(function(){return o.li(e),Wc(n).delete([0,Pa(e.path)])})}),s.push(t))}).next(function(){return fa.Mn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},nh.prototype.removeTarget=function(t,e){e=e.kt(t.bs);return this.db.Sr().Hi(t,e)},nh.prototype.Fr=sh,nh.prototype.Dr=function(t,r){var i,t=Wc(t),o=ti.q;return t.hs({index:Qa.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ti.q&&r(new pi(La(i)),o),o=e,i=t):o=ti.q}).next(function(){o!==ti.q&&r(new pi(La(i)),o)})},nh.prototype.pr=function(t){return this.db.$r().Or(t)},nh);function nh(t,e){this.db=t,this.lr=new th(this,e)}function rh(t,e){this.mr=t,this.params=e}function ih(t,e){this.lr=t,this._s=e,this._r=!1,this.dr=null}function oh(t){this.cr=t,this.buffer=new su(Jc),this.ar=0}function sh(t,e){return Wc(t).put((t=t.bs,new Qa(0,Pa(e.path),t)))}var uh,ah=(fh.prototype.ai=function(t,e,n){return ph(t).put(dh(e),n)},fh.prototype.li=function(t,e){t=ph(t),e=dh(e);return t.delete(e)},fh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.kr(e,t)})},fh.prototype._i=function(t,e){var n=this;return ph(t).get(dh(e)).next(function(t){return n.Mr(t)})},fh.prototype.Lr=function(t,e){var n=this;return ph(t).get(dh(e)).next(function(t){var e=n.Mr(t);return e?{hi:e,size:Mc(t)}:null})},fh.prototype.getEntries=function(t,e){var n=this,r=au;return this.Br(t,e,function(t,e){e=n.Mr(e);r=r.zt(t,e)}).next(function(){return r})},fh.prototype.qr=function(t,e){var r=this,i=au,o=new $s(pi.H);return this.Br(t,e,function(t,e){var n=r.Mr(e);o=n?(i=i.zt(t,n),o.zt(t,Mc(e))):(i=i.zt(t,null),o.zt(t,0))}).next(function(){return{Ur:i,Qr:o}})},fh.prototype.Br=function(t,e,i){if(e.et())return fa.resolve();var n=IDBKeyRange.bound(e.first().path.it(),e.last().path.it()),o=e.te(),s=o.oe();return ph(t).hs({range:n},function(t,e,n){for(var r=pi.Et(t);s&&pi.H(s,r)<0;)i(s,null),s=o.oe();s&&s.isEqual(r)&&(i(s,e),s=o.ce()?o.oe():null),s?n.ss(s.path.it()):n.done()}).next(function(){for(;s;)i(s,null),s=o.ce()?o.oe():null})},fh.prototype.Kr=function(t,r,e){var n,i=this,o=fu,s=r.path.length+1,u={};return e.isEqual(ci.min())?(n=r.path.it(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.it(),e=hc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Ga.collectionReadTimeIndex),ph(t).hs(u,function(t,e,n){t.length===s&&(e=ac(i.Qt,e),r.path.nt(e.key.path)?e instanceof $i&&es(r,e)&&(o=o.zt(e.key,e)):n.done())}).next(function(){return o})},fh.prototype.Nr=function(t){return new ch(this,!!t&&t.Wr)},fh.prototype.Or=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},fh.prototype.getMetadata=function(t){return lh(t).get(za.key).next(function(t){return Cr(!!t),t})},fh.prototype.kr=function(t,e){return lh(t).put(za.key,e)},fh.prototype.Mr=function(t){if(t){t=ac(this.Qt,t);return t instanceof to&&t.version.isEqual(ci.min())?null:t}return null},fh),ch=(n(hh,uh=Ee),hh.prototype.wi=function(i){var o=this,s=[],u=0,a=new su(function(t,e){return Vr(t.rt(),e.rt())});return this.ri.forEach(function(t,e){var n,r=o.Gr.get(t);e.hi?(n=cc(o.jr.Qt,e.hi,o.ci(t)),a=a.add(t.path.X()),e=Mc(n),u+=e-r,s.push(o.jr.ai(i,t,n))):(u-=r,o.Wr?(r=cc(o.jr.Qt,new to(t,ci.min()),o.ci(t)),s.push(o.jr.ai(i,t,r))):s.push(o.jr.li(i,t)))}),a.forEach(function(t){s.push(o.jr.Ei.qs(i,t))}),s.push(this.jr.updateMetadata(i,u)),fa.Mn(s)},hh.prototype.fi=function(t,e){var n=this;return this.jr.Lr(t,e).next(function(t){return null===t?(n.Gr.set(e,0),null):(n.Gr.set(e,t.size),t.hi)})},hh.prototype.di=function(t,e){var n=this;return this.jr.qr(t,e).next(function(t){var e=t.Ur;return t.Qr.forEach(function(t,e){n.Gr.set(t,e)}),e})},hh);function hh(t,e){var n=this;return(n=uh.call(this)||this).jr=t,n.Wr=e,n.Gr=new Cc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function fh(t,e){this.Qt=t,this.Ei=e}function lh(t){return nc(t,za.store)}function ph(t){return nc(t,Ga.store)}function dh(t){return t.path.it()}var yh=(vh.prototype.Jn=function(e,n,t,r){var i=this;Cr(t<r&&0<=t&&r<=11);var o=new la("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Ra.store),(s=e).createObjectStore(Ma.store,{keyPath:Ma.keyPath}),s.createObjectStore(Ua.store,{keyPath:Ua.keyPath,autoIncrement:!0}).createIndex(Ua.userMutationsIndex,Ua.userMutationsKeyPath,{unique:!0}),s.createObjectStore(ja.store),gh(e),e.createObjectStore(Ga.store));var s,u=fa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Qa.store),s.deleteObjectStore(Ha.store),s.deleteObjectStore(Ya.store),gh(e)),u=u.next(function(){return t=o.store(Ya.store),e=new Ya(0,0,ci.min().j(),0),t.put(Ya.key,e);var t,e})),t<4&&4<=r&&(u=(u=0!==t?u.next(function(){return n=e,(r=o).store(Ua.store).rs().next(function(t){n.deleteObjectStore(Ua.store),n.createObjectStore(Ua.store,{keyPath:Ua.keyPath,autoIncrement:!0}).createIndex(Ua.userMutationsIndex,Ua.userMutationsKeyPath,{unique:!0});var e=r.store(Ua.store),t=t.map(function(t){return e.put(t)});return fa.Mn(t)});var n,r}):u).next(function(){e.createObjectStore(Xa.store,{keyPath:Xa.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.zr(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(za.store),i.Hr(o)})),t<7&&7<=r&&(u=u.next(function(){return i.Jr(o)})),t<8&&8<=r&&(u=u.next(function(){return i.Yr(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Ga.store)).createIndex(Ga.readTimeIndex,Ga.readTimeIndexPath,{unique:!1}),t.createIndex(Ga.collectionReadTimeIndex,Ga.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.Xr(o)})),u=t<11&&11<=r?u.next(function(){e.createObjectStore(Wa.store,{keyPath:Wa.keyPath}),e.createObjectStore(Ja.store,{keyPath:Ja.keyPath})}):u},vh.prototype.Hr=function(e){var n=0;return e.store(Ga.store).hs(function(t,e){n+=Mc(e)}).next(function(){var t=new za(n);return e.store(za.store).put(za.key,t)})},vh.prototype.zr=function(n){var r=this,t=n.store(Ma.store),i=n.store(Ua.store);return t.rs().next(function(t){return fa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.rs(Ua.userMutationsIndex,t).next(function(t){return fa.forEach(t,function(t){Cr(t.userId===e.userId);t=dc(r.Qt,t);return Vc(n,e.userId,t).next(function(){})})})})})},vh.prototype.Jr=function(t){var o=t.store(Qa.store),e=t.store(Ga.store);return t.store(Ya.store).get(Ya.key).next(function(r){var i=[];return e.hs(function(t,e){var n=new hi(t),t=[0,Pa(n)];i.push(o.get(t).next(function(t){return t?fa.resolve():o.put(new Qa(0,Pa(n),r.highestListenSequenceNumber))}))}).next(function(){return fa.Mn(i)})})},vh.prototype.Yr=function(t,e){t.createObjectStore(Ka.store,{keyPath:Ka.keyPath});function r(t){if(i.add(t)){var e=t.tt(),t=t.X();return n.put({collectionId:e,parent:Pa(t)})}}var n=e.store(Ka.store),i=new Ic;return e.store(Ga.store).hs({us:!0},function(t,e){t=new hi(t);return r(t.X())}).next(function(){return e.store(ja.store).hs({us:!0},function(t,e){t[0];var n=t[1],n=(t[2],La(n));return r(n.X())})})},vh.prototype.Xr=function(t){var n=this,r=t.store(Ha.store);return r.hs(function(t,e){e=yc(e),e=vc(n.Qt,e);return r.put(e)})},vh);function vh(t){this.Qt=t}function gh(t){t.createObjectStore(Qa.store,{keyPath:Qa.keyPath}).createIndex(Qa.documentTargetsIndex,Qa.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ha.store,{keyPath:Ha.keyPath}).createIndex(Ha.queryTargetsIndexName,Ha.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ya.store)}var mh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",bh=(wh.prototype.start=function(){var e=this;return this.To().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Gr(Br.FAILED_PRECONDITION,mh);return e.Io(),e.mo(),e.Ao(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e._o.Ki(t)})}).then(function(t){e.so=new ti(t,e.eo)}).then(function(){e.io=!0}).catch(function(t){return e.lo&&e.lo.close(),Promise.reject(t)})},wh.prototype.Ro=function(n){var t=this;return this.uo=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Er?[2,n(e)]:[2]})})},n(this.isPrimary)},wh.prototype.Po=function(n){var t=this;this.lo.Xn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},wh.prototype.yo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Zr.Ps(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Er?[4,this.To()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},wh.prototype.To=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Eh(e).put(new Xa(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Vo(e).next(function(t){t||(n.isPrimary=!1,n.Zr.po(function(){return n.uo(!1)}))})}).next(function(){return n.bo(e)}).next(function(t){return n.isPrimary&&!t?n.vo(e).next(function(){return!1}):!!t&&n.So(e).next(function(){return!0})})}).catch(function(t){if(_a(t))return xr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return xr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Zr.po(function(){return n.uo(t)}),n.isPrimary=t})},wh.prototype.Vo=function(t){var e=this;return _h(t).get(Ra.key).next(function(t){return fa.resolve(e.Do(t))})},wh.prototype.Co=function(t){return Eh(t).delete(this.clientId)},wh.prototype.xo=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.No(this.ao,18e5)?[3,2]:(this.ao=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=nc(t,Xa.store);return r.rs().next(function(t){var e=o.$o(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return fa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Eo)for(n=0,r=e;n<r.length;n++)i=r[n],this.Eo.removeItem(this.Fo(i.clientId));t.label=2;case 2:return[2]}})})},wh.prototype.Ao=function(){var t=this;this.co=this.Zr.Tr("client_metadata_refresh",4e3,function(){return t.To().then(function(){return t.xo()}).then(function(){return t.Ao()})})},wh.prototype.Do=function(t){return!!t&&t.ownerId===this.clientId},wh.prototype.bo=function(e){var r=this;return this.no?fa.resolve(!0):_h(e).get(Ra.key).next(function(t){if(null!==t&&r.No(t.leaseTimestampMs,5e3)&&!r.Oo(t.ownerId)){if(r.Do(t)&&r.networkEnabled)return!0;if(!r.Do(t)){if(!t.allowTabSynchronization)throw new Gr(Br.FAILED_PRECONDITION,mh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Eh(e).rs().next(function(t){return void 0===r.$o(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&xr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},wh.prototype.ko=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.io=!1,this.Mo(),this.co&&(this.co.cancel(),this.co=null),this.Lo(),this.Bo(),[4,this.lo.runTransaction("shutdown","readwrite",[Ra.store,Xa.store],function(t){var e=new tc(t,ti.q);return n.vo(e).next(function(){return n.Co(e)})})];case 1:return t.sent(),this.lo.close(),this.qo(),[2]}})})},wh.prototype.$o=function(t,e){var n=this;return t.filter(function(t){return n.No(t.updateTimeMs,e)&&!n.Oo(t.clientId)})},wh.prototype.Uo=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Eh(t).rs().next(function(t){return e.$o(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(wh.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),wh.prototype.Qo=function(t){return Uc.mi(t,this.Qt,this.Ei,this.Ti)},wh.prototype.Sr=function(){return this._o},wh.prototype.$r=function(){return this.fo},wh.prototype.Ko=function(){return this.Ei},wh.prototype.Wo=function(){return this.wo},wh.prototype.runTransaction=function(e,n,r){var i=this;xr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.lo.runTransaction(e,t,$a,function(t){return o=new tc(t,i.so?i.so.next():ti.q),"readwrite-primary"===n?i.Vo(o).next(function(t){return!!t||i.bo(o)}).next(function(t){if(!t)throw Dr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Zr.po(function(){return i.uo(!1)}),new Gr(Br.FAILED_PRECONDITION,Oa);return r(o)}).next(function(t){return i.So(o).next(function(){return t})}):i.jo(o).next(function(){return r(o)})}).then(function(t){return o.Vs(),t})},wh.prototype.jo=function(t){var e=this;return _h(t).get(Ra.key).next(function(t){if(null!==t&&e.No(t.leaseTimestampMs,5e3)&&!e.Oo(t.ownerId)&&!e.Do(t)&&!(e.no||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Gr(Br.FAILED_PRECONDITION,mh)})},wh.prototype.So=function(t){var e=new Ra(this.clientId,this.allowTabSynchronization,Date.now());return _h(t).put(Ra.key,e)},wh.Kn=function(){return pa.Kn()},wh.prototype.vo=function(t){var e=this,n=_h(t);return n.get(Ra.key).next(function(t){return e.Do(t)?(xr("IndexedDbPersistence","Releasing primary lease."),n.delete(Ra.key)):fa.resolve()})},wh.prototype.No=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Dr("Detected an update time that is in the future: "+t+" > "+n),1))},wh.prototype.Io=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.oo=function(){t.Zr.Ps(function(){return t.inForeground="visible"===t.document.visibilityState,t.To()})},this.document.addEventListener("visibilitychange",this.oo),this.inForeground="visible"===this.document.visibilityState)},wh.prototype.Lo=function(){this.oo&&(this.document.removeEventListener("visibilitychange",this.oo),this.oo=null)},wh.prototype.mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ro=function(){e.Mo(),e.Zr.Ps(function(){return e.ko()})},this.window.addEventListener("unload",this.ro))},wh.prototype.Bo=function(){this.ro&&(this.window.removeEventListener("unload",this.ro),this.ro=null)},wh.prototype.Oo=function(t){try{var e=null!==(null===(e=this.Eo)||void 0===e?void 0:e.getItem(this.Fo(t)));return xr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Dr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},wh.prototype.Mo=function(){if(this.Eo)try{this.Eo.setItem(this.Fo(this.clientId),String(Date.now()))}catch(t){Dr("Failed to set zombie client id.",t)}},wh.prototype.qo=function(){if(this.Eo)try{this.Eo.removeItem(this.Fo(this.clientId))}catch(t){}},wh.prototype.Fo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},wh);function wh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Zr=i,this.window=o,this.document=s,this.eo=a,this.no=c,this.so=null,this.io=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ro=null,this.inForeground=!1,this.oo=null,this.co=null,this.ao=Number.NEGATIVE_INFINITY,this.uo=function(t){return Promise.resolve()},!wh.Kn())throw new Gr(Br.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ti=new eh(this,r),this.ho=e+"main",this.Qt=new oc(u),this.lo=new pa(this.ho,11,new yh(this.Qt)),this._o=new Hc(this.Ti,this.Qt),this.Ei=new Tc,this.fo=(e=this.Qt,u=this.Ei,new ah(e,u)),this.wo=new mc,this.window&&this.window.localStorage?this.Eo=this.window.localStorage:(this.Eo=null,!1===c&&Dr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function _h(t){return nc(t,Ra.store)}function Eh(t){return nc(t,Xa.store)}function Ih(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function Th(t,e){this.progress=t,this.Go=e}var Nh=(Ph.prototype.Ho=function(e,n){var r=this;return this.zo.bi(e,n).next(function(t){return r.Jo(e,n,t)})},Ph.prototype.Jo=function(t,r,i){return this.fo._i(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Cs(r,t);return t})},Ph.prototype.Yo=function(t,e,i){var o=au;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Cs(t,e);o=o.zt(t,e)}),o},Ph.prototype.Xo=function(e,t){var n=this;return this.fo.getEntries(e,t).next(function(t){return n.Zo(e,t)})},Ph.prototype.Zo=function(e,r){var i=this;return this.zo.vi(e,r).next(function(t){var t=i.Yo(e,r,t),n=au;return t.forEach(function(t,e){e=e||new to(t,ci.min()),n=n.zt(t,e)}),n})},Ph.prototype.Kr=function(t,e,n){return r=e,pi.wt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.tc(t,e.path):Ko(e)?this.ec(t,e,n):this.nc(t,e,n);var r},Ph.prototype.tc=function(t,e){return this.Ho(t,new pi(e)).next(function(t){var e=fu;return e=t instanceof $i?e.zt(t.key,t):e})},Ph.prototype.ec=function(n,r,i){var o=this,s=r.collectionGroup,u=fu;return this.Ei.Us(n,s).next(function(t){return fa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new qo(t,null,e.xt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.nc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.zt(t,e)})})}).next(function(){return u})})},Ph.prototype.nc=function(e,n,t){var a,c,r=this;return this.fo.Kr(e,n,t).next(function(t){return a=t,r.zo.Di(e,n)}).next(function(t){return c=t,r.sc(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Os(s,a.get(u),r.vs);a=s instanceof $i?a.zt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){es(n,e)||(a=a.remove(t))}),a})},Ph.prototype.sc=function(t,e,n){for(var r=du(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Vs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.fo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof $i&&(c=c.zt(t,e))}),c})},Ph),Ah=(kh.oc=function(t,e){for(var n=du(),r=du(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new kh(t,e.fromCache,n,r)},kh),Sh=(Oh.prototype.cc=function(t){this.ac=t},Oh.prototype.Kr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.xt.length||1===r.xt.length&&r.xt[0].field.ut())||i.isEqual(ci.min())?this.uc(e,r):this.ac.Xo(e,o).next(function(t){var n=s.hc(r,t);return(zo(r)||Ho(r))&&s.lc(r.limitType,n,o,i)?s.uc(e,r):(Sr()<=l.DEBUG&&xr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ts(r)),s.ac.Kr(e,r,i).next(function(e){return n.forEach(function(t){e=e.zt(t.key,t)}),e}))})},Oh.prototype.hc=function(n,t){var r=new su(ns(n));return t.forEach(function(t,e){e instanceof $i&&es(n,e)&&(r=r.add(e))}),r},Oh.prototype.lc=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version._(r))},Oh.prototype.uc=function(t,e){return Sr()<=l.DEBUG&&xr("QueryEngine","Using full collection scan to execute query:",ts(e)),this.ac.Kr(t,e,ci.min())},Oh),xh=(Dh.prototype.Ir=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Vr(t,n.fc)})},Dh);function Dh(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new $s(Vr),this.dc=new Cc(uo,ao),this.wc=ci.min(),this.zo=t.Qo(n),this.Ec=t.$r(),this._o=t.Sr(),this.Tc=new Nh(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}function Oh(){}function kh(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}function Ph(t,e,n){this.fo=t,this.zo=e,this.Ei=n}function Ch(t,e,n,r){return new xh(t,e,n,r)}function Lh(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).zo,m=e.Tc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.zo.pi(v).next(function(t){return g=t,n=e.persistence.Qo(o),m=new Nh(e.Ec,n,e.persistence.Ko()),n.pi(v)}).next(function(t){for(var e=[],n=[],r=du(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Xo(v,r).next(function(t){return{Ic:t,mc:e,Ac:n}})})})];case 1:return r=t.sent(),[2,(e.zo=n,e.Tc=m,e._c.cc(e.Tc),r)]}})})}function Rh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Ec.Nr({Wr:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=fa.resolve(),n.forEach(function(n){u=u.next(function(){return o._i(r,n)}).next(function(t){var e=t,t=i.$s.get(n);Cr(null!==t),(!e||e.version._(t)<0)&&(e=s.Ss(n,e,i))&&o.ai(e,i.Ns)})}),u.next(function(){return e.zo.Ci(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.zo.$i(t)}).next(function(){return f.Tc.Xo(t,a)})})}function Vh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e._o.Qi(t)})}function Mh(t,r){var a=t,c=r.Ot,h=a.fc;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Ec.Nr({Wr:!0});h=a.fc;var u=[];r.$e.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a._o.sr(s,t.Qe,e).next(function(){return a._o.er(s,t.qe,e)})),0<(i=t.resumeToken).l()&&(n=o.Mt(i,c).kt(s.bs),h=h.zt(e,n),r=o,i=t,Cr(0<(o=n).resumeToken.l()),(0===r.resumeToken.l()||3e8<=o.Ot.W()-r.Ot.W()||0<i.qe.size+i.Ue.size+i.Qe.size)&&u.push(a._o.Hi(s,n))))});var e,n=au;return r.Oe.forEach(function(t,e){r.ke.has(t)&&u.push(a.persistence.Ti.Fr(s,t))}),u.push(Uh(s,t,r.Oe,c,void 0).next(function(t){n=t})),c.isEqual(ci.min())||(e=a._o.Qi(s).next(function(t){return a._o.Wi(s,s.bs,c)}),u.push(e)),fa.Mn(u).next(function(){return t.apply(s)}).next(function(){return a.Tc.Zo(s,n)})}).then(function(t){return a.fc=h,t})}function Uh(t,s,e,u,a){var n=du();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=au;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof to&&e.version.isEqual(ci.min())?(s.li(t,r),o=o.zt(t,e)):null==n||0<e.version._(n.version)||0===e.version._(n.version)&&n.hasPendingWrites?(s.ai(e,r),o=o.zt(t,e)):xr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function jh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i._o.tr(e,r).next(function(t){return t?(n=t,fa.resolve(n)):i._o.Bi(e).next(function(t){return n=new rs(r,t,0,e.bs),i._o.ji(e,n).next(function(){return n})})})}).then(function(t){var e=i.fc.get(t.targetId);return(null===e||0<t.Ot._(e.Ot))&&(i.fc=i.fc.zt(t.targetId,t),i.dc.set(r,t.targetId)),t})}function Fh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).fc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ti.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!_a(r=t.sent()))throw r;return xr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.fc=e.fc.remove(o),e.dc.delete(n.target),[2]}})})}function qh(t,o,s){var u=t,a=ci.min(),c=du();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Wo(o),(void 0!==(t=(i=t).dc.get(r))?fa.resolve(i.fc.get(t)):i._o.tr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u._o.rr(e,t.targetId).next(function(t){c=t})}).next(function(){return u._c.Kr(e,o,s?a:ci.min(),s?c:du())}).next(function(t){return{documents:t,Rc:c}});var t,n,r,i})}function Bh(t,e){var n=t,r=n._o,t=n.fc.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Sn(t,e).next(function(t){return t?t.target:null})})}function Gh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Ec,n=t,t=s.wc,r=e,i=au,o=hc(t),t=ph(n),n=IDBKeyRange.lowerBound(o,!0),t.hs({index:Ga.readTimeIndex,range:n},function(t,e){var n=ac(r.Qt,e);i=i.zt(n.key,n),o=e.readTime}).next(function(){return{Go:i,readTime:fc(o)}});var e,n,r,i,o}).then(function(t){var e=t.Go,t=t.readTime;return s.wc=t,e})}function zh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=ph(t),r=ci.min(),t.hs({index:Ga.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=fc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.wc=t})]})})}var Hh,Qh,Yh=(pf.prototype.Os=function(t,e){return fa.resolve(this.Vc.get(e))},pf.prototype.ks=function(t,e){return this.Vc.set(e.id,{id:e.id,version:e.version,createTime:Fu(e.createTime)}),fa.resolve()},pf.prototype.Ms=function(t,e){return fa.resolve(this.bc.get(e))},pf.prototype.Ls=function(t,e){return this.bc.set(e.name,{name:(e=e).name,query:gc(e.bundledQuery),readTime:Fu(e.readTime)}),fa.resolve()},pf),Kh=(lf.prototype.et=function(){return this.vc.et()},lf.prototype.nr=function(t,e){e=new Xh(t,e);this.vc=this.vc.add(e),this.Dc=this.Dc.add(e)},lf.prototype.xc=function(t,e){var n=this;t.forEach(function(t){return n.nr(t,e)})},lf.prototype.ir=function(t,e){this.Nc(new Xh(t,e))},lf.prototype.$c=function(t,e){var n=this;t.forEach(function(t){return n.ir(t,e)})},lf.prototype.Fc=function(t){var e=this,n=new pi(new hi([])),r=new Xh(n,t),t=new Xh(n,t+1),i=[];return this.Dc.me([r,t],function(t){e.Nc(t),i.push(t.key)}),i},lf.prototype.Oc=function(){var e=this;this.vc.forEach(function(t){return e.Nc(t)})},lf.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},lf.prototype.kc=function(t){var e=new pi(new hi([])),n=new Xh(e,t),t=new Xh(e,t+1),r=du();return this.Dc.me([n,t],function(t){r=r.add(t.key)}),r},lf.prototype.Fi=function(t){var e=new Xh(t,0),e=this.vc.Re(e);return null!==e&&t.isEqual(e.key)},lf),Xh=(ff.Sc=function(t,e){return pi.H(t.key,e.key)||Vr(t.Mc,e.Mc)},ff.Cc=function(t,e){return Vr(t.Mc,e.Mc)||pi.H(t.key,e.key)},ff),Wh=(hf.prototype.Ai=function(t){return fa.resolve(0===this.zo.length)},hf.prototype.Ri=function(t,e,n,r){var i=this.Lc;this.Lc++,0<this.zo.length&&this.zo[this.zo.length-1];n=new rc(i,e,n,r);this.zo.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Bc=this.Bc.add(new Xh(u.key,i)),this.Ei.qs(t,u.key.path.X())}return fa.resolve(n)},hf.prototype.Pi=function(t,e){return fa.resolve(this.qc(e))},hf.prototype.gi=function(t,e){e+=1,e=this.Uc(e),e=e<0?0:e;return fa.resolve(this.zo.length>e?this.zo[e]:null)},hf.prototype.Vi=function(){return fa.resolve(0===this.zo.length?-1:this.Lc-1)},hf.prototype.pi=function(t){return fa.resolve(this.zo.slice())},hf.prototype.bi=function(t,e){var n=this,r=new Xh(e,0),e=new Xh(e,Number.POSITIVE_INFINITY),i=[];return this.Bc.me([r,e],function(t){t=n.qc(t.Mc);i.push(t)}),fa.resolve(i)},hf.prototype.vi=function(t,e){var n=this,r=new su(Vr);return e.forEach(function(t){var e=new Xh(t,0),t=new Xh(t,Number.POSITIVE_INFINITY);n.Bc.me([e,t],function(t){r=r.add(t.Mc)})}),fa.resolve(this.Qc(r))},hf.prototype.Di=function(t,e){var n=e.path,r=n.length+1,e=n;pi.wt(e)||(e=e.child(""));var e=new Xh(new pi(e),0),i=new su(Vr);return this.Bc.Ae(function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(i=i.add(t.Mc)),!0)},e),fa.resolve(this.Qc(i))},hf.prototype.Qc=function(t){var e=this,n=[];return t.forEach(function(t){t=e.qc(t);null!==t&&n.push(t)}),n},hf.prototype.Ci=function(n,r){var i=this;Cr(0===this.Kc(r.batchId,"removed")),this.zo.shift();var o=this.Bc;return fa.forEach(r.mutations,function(t){var e=new Xh(t.key,r.batchId);return o=o.delete(e),i.Ti.Ni(n,t.key)}).next(function(){i.Bc=o})},hf.prototype.xi=function(t){},hf.prototype.Fi=function(t,e){var n=new Xh(e,0),n=this.Bc.Re(n);return fa.resolve(e.isEqual(n&&n.key))},hf.prototype.$i=function(t){return this.zo.length,fa.resolve()},hf.prototype.Kc=function(t,e){return this.Uc(t)},hf.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},hf.prototype.qc=function(t){t=this.Uc(t);return t<0||t>=this.zo.length?null:this.zo[t]},hf),Jh=(cf.prototype.ai=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:i,readTime:n}),this.size+=i-o,this.Ei.qs(t,r.path.X())},cf.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},cf.prototype._i=function(t,e){e=this.docs.get(e);return fa.resolve(e?e.hi:null)},cf.prototype.getEntries=function(t,e){var n=this,r=au;return e.forEach(function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)}),fa.resolve(r)},cf.prototype.Kr=function(t,e,n){for(var r=fu,i=new pi(e.path.child("")),o=this.docs.ee(i);o.ce();){var s=o.oe(),u=s.key,a=s.value,s=a.hi,a=a.readTime;if(!e.path.nt(u.path))break;a._(n)<=0||s instanceof $i&&es(e,s)&&(r=r.zt(s.key,s))}return fa.resolve(r)},cf.prototype.jc=function(t,e){return fa.forEach(this.docs,function(t){return e(t)})},cf.prototype.Nr=function(t){return new Zh(this)},cf.prototype.Or=function(t){return fa.resolve(this.size)},cf),Zh=(n(af,Qh=Ee),af.prototype.wi=function(n){var r=this,i=[];return this.ri.forEach(function(t,e){e&&e.hi?i.push(r.jr.ai(n,e.hi,r.ci(t))):r.jr.li(t)}),fa.Mn(i)},af.prototype.fi=function(t,e){return this.jr._i(t,e)},af.prototype.di=function(t,e){return this.jr.getEntries(t,e)},af),$h=(uf.prototype.In=function(t,n){return this.Gc.forEach(function(t,e){return n(e)}),fa.resolve()},uf.prototype.Qi=function(t){return fa.resolve(this.lastRemoteSnapshotVersion)},uf.prototype.Ki=function(t){return fa.resolve(this.zc)},uf.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),fa.resolve(this.highestTargetId)},uf.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),fa.resolve()},uf.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new zc(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},uf.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,fa.resolve()},uf.prototype.Hi=function(t,e){return this.Gi(e),fa.resolve()},uf.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Fc(e.targetId),--this.targetCount,fa.resolve()},uf.prototype.Xi=function(n,r,i){var o=this,s=0,u=[];return this.Gc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Gc.delete(t),u.push(o.Yi(n,e.targetId)),s++)}),fa.Mn(u).next(function(){return s})},uf.prototype.Zi=function(t){return fa.resolve(this.targetCount)},uf.prototype.tr=function(t,e){e=this.Gc.get(e)||null;return fa.resolve(e)},uf.prototype.er=function(t,e,n){return this.Hc.xc(e,n),fa.resolve()},uf.prototype.sr=function(e,t,n){this.Hc.$c(t,n);var r=this.persistence.Ti,i=[];return r&&t.forEach(function(t){i.push(r.Ni(e,t))}),fa.Mn(i)},uf.prototype.Yi=function(t,e){return this.Hc.Fc(e),fa.resolve()},uf.prototype.rr=function(t,e){e=this.Hc.kc(e);return fa.resolve(e)},uf.prototype.Fi=function(t,e){return fa.resolve(this.Hc.Fi(e))},uf),tf=(sf.prototype.start=function(){return Promise.resolve()},sf.prototype.ko=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(sf.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),sf.prototype.Po=function(){},sf.prototype.yo=function(){},sf.prototype.Ko=function(){return this.Ei},sf.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new Wh(this.Ei,this.Ti),this.Yc[t.A()]=e),e},sf.prototype.Sr=function(){return this._o},sf.prototype.$r=function(){return this.fo},sf.prototype.Wo=function(){return this.wo},sf.prototype.runTransaction=function(t,e,n){var r=this;xr("MemoryPersistence","Starting transaction:",t);var i=new ef(this.so.next());return this.Ti.Zc(),n(i).next(function(t){return r.Ti.ta(i).next(function(){return t})}).On().then(function(t){return i.Vs(),t})},sf.prototype.ea=function(e,n){return fa.Ln(Object.values(this.Yc).map(function(t){return function(){return t.Fi(e,n)}}))},sf),ef=(n(of,Hh=c),of),nf=(rf.ia=function(t){return new rf(t)},Object.defineProperty(rf.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw Pr()},enumerable:!1,configurable:!0}),rf.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),fa.resolve()},rf.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),fa.resolve()},rf.prototype.Ni=function(t,e){return this.ra.add(e.toString()),fa.resolve()},rf.prototype.removeTarget=function(t,e){var n=this;this.na.Fc(e.targetId).forEach(function(t){return n.ra.add(t.toString())});var r=this.persistence.Sr();return r.rr(t,e.targetId).next(function(t){t.forEach(function(t){return n.ra.add(t.toString())})}).next(function(){return r.Ji(t,e)})},rf.prototype.Zc=function(){this.sa=new Set},rf.prototype.ta=function(n){var r=this,i=this.persistence.$r().Nr();return fa.forEach(this.ra,function(t){var e=pi._t(t);return r.oa(n,e).next(function(t){t||i.li(e)})}).next(function(){return r.sa=null,i.apply(n)})},rf.prototype.Fr=function(t,e){var n=this;return this.oa(t,e).next(function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())})},rf.prototype.Xc=function(t){return 0},rf.prototype.oa=function(t,e){var n=this;return fa.Ln([function(){return fa.resolve(n.na.Fi(e))},function(){return n.persistence.Sr().Fi(t,e)},function(){return n.persistence.ea(t,e)}])},rf);function rf(t){this.persistence=t,this.na=new Kh,this.sa=null}function of(t){var e=this;return(e=Hh.call(this)||this).bs=t,e}function sf(t,e){var n=this;this.Yc={},this.so=new ti(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new $h(this),this.Ei=new Ec,this.fo=(t=this.Ei,new Jh(t,function(t){return n.Ti.Xc(t)})),this.Qt=new oc(e),this.wo=new Yh(this.Qt)}function uf(t){this.persistence=t,this.Gc=new Cc(uo,ao),this.lastRemoteSnapshotVersion=ci.min(),this.highestTargetId=0,this.zc=0,this.Hc=new Kh,this.targetCount=0,this.Jc=zc.Mi()}function af(t){var e=this;return(e=Qh.call(this)||this).jr=t,e}function cf(t,e){this.Ei=t,this.Wc=e,this.docs=new $s(pi.H),this.size=0}function hf(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.Lc=1,this.Bc=new su(Xh.Sc)}function ff(t,e){this.key=t,this.Mc=e}function lf(){this.vc=new su(Xh.Sc),this.Dc=new su(Xh.Cc)}function pf(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}function df(t,e){return"firestore_clients_"+t+"_"+e}function yf(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.m()&&(n+="_"+e.uid),n}function vf(t,e){return"firestore_targets_"+t+"_"+e}var gf,mf=(qf.ca=function(t,e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Gr(i.error.code,i.error.message)),o?new qf(t,e,i.state,r):(Dr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},qf.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},qf),bf=(Ff.ca=function(t,e){var n,r=JSON.parse(e),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new Gr(r.error.code,r.error.message)),i?new Ff(t,r.state,n):(Dr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Ff.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Ff),wf=(jf.ca=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=yu,o=0;r&&o<n.activeTargetIds.length;++o)r=Ci(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new jf(t,i):(Dr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},jf),_f=(Uf.ca=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Uf(e.clientId,e.onlineState):(Dr("SharedClientState","Failed to parse online state: "+t),null)},Uf),Ef=(Mf.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Mf.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Mf.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},Mf),If=(Vf.Kn=function(t){return!(!t||!t.localStorage)},Vf.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this._a.Uo()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.la&&(i=this.getItem(df(this.persistenceKey,r)))&&(o=wf.ca(r,i))&&(this.Ea=this.Ea.zt(o.clientId,o));for(this.Va(),(s=this.storage.getItem(this.ya))&&(u=this.pa(s))&&this.ba(u),a=0,c=this.Ta;a<c.length;a++)h=c[a],this.wa(h);return this.Ta=[],this.window.addEventListener("unload",function(){return f.ko()}),this.Er=!0,[2]}})})},Vf.prototype.B=function(t){this.setItem(this.ma,JSON.stringify(t))},Vf.prototype.va=function(){return this.Sa(this.Ea)},Vf.prototype.Da=function(n){var r=!1;return this.Ea.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Vf.prototype.Ca=function(t){this.xa(t,"pending")},Vf.prototype.Na=function(t,e,n){this.xa(t,e,n),this.$a(t)},Vf.prototype.Fa=function(t){var e,n="not-current";return this.Da(t)&&(!(e=this.storage.getItem(vf(this.persistenceKey,t)))||(e=bf.ca(t,e))&&(n=e.state)),this.Oa.ua(t),this.Va(),n},Vf.prototype.ka=function(t){this.Oa.ha(t),this.Va()},Vf.prototype.Ma=function(t){return this.Oa.activeTargetIds.has(t)},Vf.prototype.La=function(t){this.removeItem(vf(this.persistenceKey,t))},Vf.prototype.Ba=function(t,e,n){this.qa(t,e,n)},Vf.prototype.Ua=function(t,e,n){var r=this;e.forEach(function(t){r.$a(t)}),this.currentUser=t,n.forEach(function(t){r.Ca(t)})},Vf.prototype.Qa=function(t){this.Ka(t)},Vf.prototype.Wa=function(){this.ja()},Vf.prototype.ko=function(){this.Er&&(this.window.removeEventListener("storage",this.da),this.removeItem(this.Ia),this.Er=!1)},Vf.prototype.getItem=function(t){var e=this.storage.getItem(t);return xr("SharedClientState","READ",t,e),e},Vf.prototype.setItem=function(t,e){xr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Vf.prototype.removeItem=function(t){xr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Vf.prototype.wa=function(t){var e=this,o=t;o.storageArea===this.storage&&(xr("SharedClientState","EVENT",o.key,o.newValue),o.key!==this.Ia?this.Zr.po(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.Er){if(null!==o.key)if(this.Aa.test(o.key)){if(null==o.newValue)return e=this.Ga(o.key),[2,this.za(e,null)];if(e=this.Ha(o.key,o.newValue))return[2,this.za(e.clientId,e)]}else if(this.Ra.test(o.key)){if(null!==o.newValue&&(n=this.Ja(o.key,o.newValue)))return[2,this.Ya(n)]}else if(this.Pa.test(o.key)){if(null!==o.newValue&&(r=this.Xa(o.key,o.newValue)))return[2,this.Za(r)]}else if(o.key===this.ya){if(null!==o.newValue&&(i=this.pa(o.newValue)))return[2,this.ba(i)]}else if(o.key===this.ma)(i=function(t){var e=ti.q;if(null!=t)try{var n=JSON.parse(t);Cr("number"==typeof n),e=n}catch(t){Dr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==ti.q&&this.k(i);else if(o.key===this.ga)return[2,this._a.tu()]}else this.Ta.push(o);return[2]})})}):Dr("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(Vf.prototype,"Oa",{get:function(){return this.Ea.get(this.la)},enumerable:!1,configurable:!0}),Vf.prototype.Va=function(){this.setItem(this.Ia,this.Oa.aa())},Vf.prototype.xa=function(t,e,n){n=new mf(this.currentUser,t,e,n),t=yf(this.persistenceKey,this.currentUser,t);this.setItem(t,n.aa())},Vf.prototype.$a=function(t){t=yf(this.persistenceKey,this.currentUser,t);this.removeItem(t)},Vf.prototype.Ka=function(t){t={clientId:this.la,onlineState:t};this.storage.setItem(this.ya,JSON.stringify(t))},Vf.prototype.qa=function(t,e,n){var r=vf(this.persistenceKey,t),n=new bf(t,e,n);this.setItem(r,n.aa())},Vf.prototype.ja=function(){this.setItem(this.ga,"value-not-used")},Vf.prototype.Ga=function(t){t=this.Aa.exec(t);return t?t[1]:null},Vf.prototype.Ha=function(t,e){t=this.Ga(t);return wf.ca(t,e)},Vf.prototype.Ja=function(t,e){var n=this.Ra.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return mf.ca(new Hr(n),t,e)},Vf.prototype.Xa=function(t,e){t=this.Pa.exec(t),t=Number(t[1]);return bf.ca(t,e)},Vf.prototype.pa=function(t){return _f.ca(t)},Vf.prototype.Ya=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this._a.eu(e.batchId,e.state,e.error)]:(xr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Vf.prototype.Za=function(t){return this._a.nu(t.targetId,t.state,t.error)},Vf.prototype.za=function(t,e){var n=this,r=e?this.Ea.zt(t,e):this.Ea.remove(t),i=this.Sa(this.Ea),o=this.Sa(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this._a.su(s,u).then(function(){n.Ea=r})},Vf.prototype.ba=function(t){this.Ea.get(t.clientId)&&this.fa(t.onlineState)},Vf.prototype.Sa=function(t){var n=yu;return t.forEach(function(t,e){n=n.Pe(e.activeTargetIds)}),n},Vf),Tf=(Rf.prototype.Ca=function(t){},Rf.prototype.Na=function(t,e,n){},Rf.prototype.Fa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},Rf.prototype.Ba=function(t,e,n){this.ru[t]=e},Rf.prototype.ka=function(t){this.iu.ha(t)},Rf.prototype.Ma=function(t){return this.iu.activeTargetIds.has(t)},Rf.prototype.La=function(t){delete this.ru[t]},Rf.prototype.va=function(){return this.iu.activeTargetIds},Rf.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},Rf.prototype.start=function(){return this.iu=new Ef,Promise.resolve()},Rf.prototype.Ua=function(t,e,n){},Rf.prototype.Qa=function(t){},Rf.prototype.ko=function(){},Rf.prototype.B=function(t){},Rf.prototype.Wa=function(){},Rf),Nf=(Lf.prototype.ou=function(t){},Lf.prototype.ko=function(){},Lf),Af=(Cf.prototype.ou=function(t){this.lu.push(t)},Cf.prototype.ko=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},Cf.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},Cf.prototype.au=function(){xr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},Cf.prototype.hu=function(){xr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},Cf.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Cf),Sf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},xf=(Pf.prototype.wu=function(t){this.Eu=t},Pf.prototype.Tu=function(t){this.Iu=t},Pf.prototype.onMessage=function(t){this.mu=t},Pf.prototype.close=function(){this.du()},Pf.prototype.send=function(t){this.fu(t)},Pf.prototype.Au=function(){this.Eu()},Pf.prototype.Ru=function(t){this.Iu(t)},Pf.prototype.Pu=function(t){this.mu(t)},Pf),Df=(kf.prototype.pu=function(e,t,n,r){var i=this.bu(e,t);xr("RestConnection","Sending: ",i,n);t={};return this.vu(t,r),this.Su(e,i,t,n).then(function(t){return xr("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},kf.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},kf.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.3.0",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},kf.prototype.bu=function(t,e){t=Sf[t];return this.gu+"/v1/"+e+":"+t},n(Of,gf=kf),Of.prototype.Su=function(o,e,s,u){return new Promise(function(n,r){var i=new Er;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();xr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:xr("Connection",'RPC "'+o+'" timed out'),r(new Gr(Br.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();xr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Br).indexOf(e)?e:Br.UNKNOWN,r(new Gr(e,t.message))):r(new Gr(Br.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Gr(Br.UNAVAILABLE,"Connection failed."));break;default:Pr()}}finally{xr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Of.prototype.Cu=function(t,e){var n,r=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new hr,o=yr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=f().indexOf("Electron/")||(0<=(n=f()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=f().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");xr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new xf({fu:function(t){a?xr("Connection","Not sending because WebChannel is closed:",t):(u||(xr("Connection","Opening WebChannel transport."),s.open(),u=!0),xr("Connection","WebChannel sending:",t),s.send(t))},du:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,_r.EventType.OPEN,function(){a||xr("Connection","WebChannel transport opened.")}),t(s,_r.EventType.CLOSE,function(){a||(a=!0,xr("Connection","WebChannel transport closed"),c.Ru())}),t(s,_r.EventType.ERROR,function(t){a||(a=!0,Or("Connection","WebChannel transport errored:",t),c.Ru(new Gr(Br.UNAVAILABLE,"The operation could not be completed")))}),t(s,_r.EventType.MESSAGE,function(t){var e,n,r,i;a||(Cr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(xr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=zs[r];if(void 0!==t)return Zs(t)}(),i=n.message,void 0===t&&(t=Br.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Ru(new Gr(t,i)),s.close()):(xr("Connection","WebChannel received:",e),c.Pu(e)))}),t(o,mr.STAT_EVENT,function(t){t.stat===br?xr("Connection","Detected buffering proxy"):t.stat===wr&&xr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Au()},0),c},Of);function Of(t){var e=this;return(e=gf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function kf(t){this.yu=t,this.t=t.t;var e=t.ssl?"https":"http";this.gu=e+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function Pf(t){this.fu=t.fu,this.du=t.du}function Cf(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}function Lf(){}function Rf(){this.iu=new Ef,this.ru={},this.fa=null,this.k=null}function Vf(t,e,n,r,i){this.window=t,this.Zr=e,this.persistenceKey=n,this.la=r,this._a=null,this.fa=null,this.k=null,this.da=this.wa.bind(this),this.Ea=new $s(Vr),this.Er=!1,this.Ta=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ia=df(this.persistenceKey,this.la),this.ma="firestore_sequence_number_"+this.persistenceKey,this.Ea=this.Ea.zt(this.la,new Ef),this.Aa=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Ra=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Pa=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.ya="firestore_online_state_"+this.persistenceKey,this.ga="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.da)}function Mf(){this.activeTargetIds=yu}function Uf(t,e){this.clientId=t,this.onlineState=e}function jf(t,e){this.clientId=t,this.activeTargetIds=e}function Ff(t,e,n){this.targetId=t,this.state=e,this.error=n}function qf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Bf(){return"undefined"!=typeof window?window:null}function Gf(){return"undefined"!=typeof document?document:null}function zf(t){return new Mu(t,!0)}function Hf(t,e,n,r,i){var o=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.$h=[],this.Fh=i,this.Fh.ou(function(t){n.Ps(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return dl(this)?(xr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Nh.add(4),[4,ul(e)];case 1:return t.sent(),e.Oh.set("Unknown"),e.Nh.delete(4),[4,sl(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Oh=new $f(n,r)}var Qf,Yf,Kf,Xf=(ol.prototype.reset=function(){this.Fu=0},ol.prototype.Mu=function(){this.Fu=this.$u},ol.prototype.Lu=function(t){var e=this;this.cancel();var n=Math.floor(this.Fu+this.Bu()),r=Math.max(0,Date.now()-this.ku),i=Math.max(0,n-r);0<i&&xr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ou=this.Zr.Tr(this.fs,i,function(){return e.ku=Date.now(),t()}),this.Fu*=this.Nu,this.Fu<this.xu&&(this.Fu=this.xu),this.Fu>this.$u&&(this.Fu=this.$u)},ol.prototype.qu=function(){null!==this.Ou&&(this.Ou.Rs(),this.Ou=null)},ol.prototype.cancel=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},ol.prototype.Bu=function(){return(Math.random()-.5)*this.Fu},ol),Ee=(il.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},il.prototype.Hu=function(){return 2===this.state},il.prototype.start=function(){3!==this.state?this.auth():this.Ju()},il.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},il.prototype.Yu=function(){this.state=0,this.Gu.reset()},il.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,function(){return t.Zu()}))},il.prototype.th=function(t){this.eh(),this.stream.send(t)},il.prototype.Zu=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Hu()?[2,this.close(0)]:[2]})})},il.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},il.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==e?this.Gu.reset():n&&n.code===Br.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Mu()):n&&n.code===Br.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Tu(n)];case 1:return t.sent(),[2]}})})},il.prototype.nh=function(){},il.prototype.auth=function(){var n=this;this.state=1;var t=this.sh(this.Wu),e=this.Wu;this.Ku.getToken().then(function(t){n.Wu===e&&n.ih(t)},function(e){t(function(){var t=new Gr(Br.UNKNOWN,"Fetching auth token failed: "+e.message);return n.rh(t)})})},il.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu(function(){n(function(){return e.state=2,e.listener.wu()})}),this.stream.Tu(function(t){n(function(){return e.rh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},il.prototype.Ju=function(){var t=this;this.state=4,this.Gu.Lu(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},il.prototype.rh=function(t){return xr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},il.prototype.sh=function(e){var n=this;return function(t){n.Zr.Ps(function(){return n.Wu===e?t():(xr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},il),Wf=(n(rl,Kf=Ee),rl.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},rl.prototype.onMessage=function(t){this.Gu.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Pr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.Bt?(Cr(void 0===s||"string"==typeof s),jr.fromBase64String(s||"")):(Cr(void 0===s||s instanceof Uint8Array),jr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?Br.UNKNOWN:Zs(c.code),new Gr(a,c.message||"")),s=new Iu(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=zu(t,n.document.name),i=Fu(n.document.updateTime);var u=new Qi({mapValue:{fields:n.document.fields}}),a=(o=new $i(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new _u(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=zu(t,n.document),i=n.readTime?Fu(n.readTime):ci.min(),u=new to(r,i),o=n.removedTargetIds||[],s=new _u([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=zu(t,n.document),i=n.removedTargetIds||[],s=new _u([],i,r,null);else{if(!("filter"in e))return Pr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new Gs(n),i=e.targetId,s=new Eu(i,r)}return s}(this.Qt,t),t=function(t){if(!("targetChange"in t))return ci.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Fu(t.readTime):ci.min()}(t);return this.listener.ah(e,t)},rl.prototype.uh=function(t){var e,n,r,i={};i.database=Yu(this.Qt),i.addTarget=(e=this.Qt,(r=co(r=(n=t).target)?{documents:$u(e,r)}:{query:ta(e,r)}).targetId=n.targetId,0<n.resumeToken.l()?r.resumeToken=ju(e,n.resumeToken):0<n.Ot._(ci.min())&&(r.readTime=Uu(e,n.Ot.j())),r);var o,t=(this.Qt,o=t,null==(t=function(){switch(o.Ft){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.th(i)},rl.prototype.hh=function(t){var e={};e.database=Yu(this.Qt),e.removeTarget=t,this.th(e)},rl),Jf=(n(nl,Yf=Ee),Object.defineProperty(nl.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),nl.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,Yf.prototype.start.call(this)},nl.prototype.nh=function(){this.lh&&this.fh([])},nl.prototype.oh=function(t){return this.Qu.Cu("Write",t)},nl.prototype.onMessage=function(t){if(Cr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Cr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Fu(e.updateTime):Fu(n)).isEqual(ci.min())&&(t=Fu(n)),new Ns(t,e.transformResults||[]);var e,n})):[]),n=Fu(t.commitTime);return this.listener.dh(n,e)}var n,r;return Cr(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},nl.prototype.Eh=function(){var t={};t.database=Yu(this.Qt),this.th(t)},nl.prototype.fh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Ju(e.Qt,t)})};this.th(t)},nl),Zf=(n(el,Qf=function(){}),el.prototype.Ih=function(){if(this.Th)throw new Gr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},el.prototype.pu=function(e,n,r){var i=this;return this.Ih(),this.credentials.getToken().then(function(t){return i.Qu.pu(e,n,r,t)}).catch(function(t){throw t.code===Br.UNAUTHENTICATED&&i.credentials.p(),t})},el.prototype.Du=function(e,n,r){var i=this;return this.Ih(),this.credentials.getToken().then(function(t){return i.Qu.Du(e,n,r,t)}).catch(function(t){throw t.code===Br.UNAUTHENTICATED&&i.credentials.p(),t})},el.prototype.terminate=function(){this.Th=!1},el),$f=(tl.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()}))},tl.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,1<=this.mh&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},tl.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},tl.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},tl.prototype.gh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rh?(Dr(t),this.Rh=!1):xr("OnlineStateTracker",t)},tl.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},tl);function tl(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}function el(t,e,n){var r=this;return(r=Qf.call(this)||this).credentials=t,r.Qu=e,r.Qt=n,r.Th=!1,r}function nl(t,e,n,r,i){var o=this;return(o=Yf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Qt=r,o.lh=!1,o}function rl(t,e,n,r,i){var o=this;return(o=Kf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Qt=r,o}function il(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new Xf(t,e)}function ol(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.$u=i,this.Fu=0,this.Ou=null,this.ku=Date.now(),this.reset()}function sl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!dl(r))return[3,4];e=0,n=r.$h,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ul(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.$h,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function al(t,e){t.xh.has(e.targetId)||(t.xh.set(e.targetId,e),pl(t)?ll(t):Il(t).Hu()&&hl(t,e))}function cl(t,e){var n=t,t=Il(n);n.xh.delete(e),t.Hu()&&fl(n,e),0===n.xh.size&&(t.Hu()?t.Xu():dl(n)&&n.Oh.set("Unknown"))}function hl(t,e){t.kh.on(e.targetId),Il(t).uh(e)}function fl(t,e){t.kh.on(e),Il(t).hh(e)}function ll(e){e.kh=new Nu({vn:function(t){return e.Dh.vn(t)},Sn:function(t){return e.xh.get(t)||null}}),Il(e).start(),e.Oh.Ph()}function pl(t){return dl(t)&&!Il(t).zu()&&0<t.xh.size}function dl(t){return 0===t.Nh.size}function yl(t){t.kh=void 0}function vl(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Oh.set("Online"),!(u instanceof Iu&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.xh.has(i)?[4,o.Dh.Mh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.xh.delete(i),o.kh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),xr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,gl(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof _u?s.kh.dn(u):u instanceof Eu?s.kh.Pn(u):s.kh.Tn(u),a.isEqual(ci.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Vh(s.bh)];case 8:return o=t.sent(),0<=a._(o)?[4,(i=a,(e=(r=s).kh.Vn(i)).$e.forEach(function(t,e){var n;0<t.resumeToken.l()&&((n=r.xh.get(e))&&r.xh.set(e,n.Mt(t.resumeToken,i)))}),e.Fe.forEach(function(t){var e=r.xh.get(t);e&&(r.xh.set(t,e.Mt(jr.T,e.Ot)),fl(r,t),e=new rs(e.target,t,1,e.sequenceNumber),hl(r,e))}),r.Dh.Lh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return xr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,gl(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function gl(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!_a(r))throw r;return n.Nh.add(1),[4,ul(n)];case 1:return t.sent(),n.Oh.set("Offline"),i=i||function(){return Vh(n.bh)},n._s.po(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return xr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Nh.delete(1),[4,sl(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function ml(e,n){return n().catch(function(t){return gl(e,t,n)})}function bl(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Tl(i=a),s=0<i.Ch.length?i.Ch[i.Ch.length-1].batchId:-1,t.label=1;case 1:if(!(dl(i)&&i.Ch.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.bh,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.zo.gi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Ch.length&&o.Xu(),[3,7]):(s=u.batchId,function(t,e){t.Ch.push(e);t=Tl(t);t.Hu()&&t._h&&t.fh(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,gl(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return wl(i)&&_l(i),[2]}var e,n,r})})}function wl(t){return dl(t)&&!Tl(t).zu()&&0<t.Ch.length}function _l(t){Tl(t).start()}function El(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Nh.delete(2),[4,sl(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Nh.add(2),[4,ul(e)]);case 3:t.sent(),e.Oh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Il(n){var t,e,r,i=this;return n.Uh||(n.Uh=(t=n.Sh,e=n._s,r={wu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.xh.forEach(function(t,e){hl(n,t)}),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return yl(e),pl(e)?(e.Oh.Vh(n),ll(e)):e.Oh.set("Unknown"),[2]})})}.bind(null,n),ah:vl.bind(null,n)},t.Ih(),new Wf(e,t.Qu,t.credentials,t.Qt,r)),n.$h.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Uh.Yu(),pl(n)?ll(n):n.Oh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Uh.stop()];case 2:t.sent(),yl(n),t.label=3;case 3:return[2]}})})})),n.Uh}function Tl(n){var t,e,r,i=this;return n.Qh||(n.Qh=(t=n.Sh,e=n._s,r={wu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Tl(e).Eh(),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Tl(e)._h?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Js(n=i.code)&&n!==Br.ABORTED?(e=r.Ch.shift(),Tl(r).Yu(),[4,ml(r,function(){return r.Dh.qh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,bl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return wl(e)&&_l(e),[2]}})})}.bind(null,n),wh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Tl(o),n=0,r=o.Ch;n<r.length;n++)i=r[n],e.fh(i.mutations);return[2]})})}.bind(null,n),dh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Ch.shift(),n=ic.from(e,i,o),[4,ml(r,function(){return r.Dh.Bh(n)})];case 1:return t.sent(),[4,bl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Ih(),new Jf(e,t.Qu,t.credentials,t.Qt,r)),n.$h.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Qh.Yu(),[4,bl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Qh.stop()];case 3:t.sent(),0<n.Ch.length&&(xr("RemoteStore","Stopping write stream with "+n.Ch.length+" pending writes"),n.Ch=[]),t.label=4;case 4:return[2]}})})})),n.Qh}function Nl(){this.queries=new Cc($o,Zo),this.onlineState="Unknown",this.Wh=new Set}var Al=function(){this.Kh=void 0,this.listeners=[]};function Sl(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Al),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.jh(n)];case 2:return o.Kh=t.sent(),[3,4];case 3:return o=t.sent(),o=Da(o,"Initialization of query '"+ts(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Gh(e.onlineState),i.Kh&&u.zh(i.Kh)&&Dl(e),[2]}})})}function xl(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Hh(n))]:[2]})})}function Dl(t){t.Wh.forEach(function(t){t.next()})}var Ol=(Ml.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new mu(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},Ml.prototype.onError=function(t){this.Jh.error(t)},Ml.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},Ml.prototype.tl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.nl&&n||t.docs.et()&&"Offline"!==e)},Ml.prototype.Zh=function(t){if(0<t.docChanges.length)return!0;var e=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!e)&&!0===this.options.includeMetadataChanges},Ml.prototype.el=function(t){t=mu.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},Ml),kl=(Vl.prototype.sl=function(){return"metadata"in this.payload},Vl),Pl=(Rl.prototype.Pc=function(t){return zu(this.Qt,t)},Rl.prototype.yc=function(t){return t.metadata.exists?Wu(this.Qt,t.document,!1):new to(this.Pc(t.metadata.name),this.gc(t.metadata.readTime))},Rl.prototype.gc=Fu,Rl),Cl=(Ll.prototype.rl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Ll.prototype.ol=function(t){for(var e=new Map,n=new Pl(this.Qt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Pc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||du()).add(s);e.set(c,h)}}return e},Ll.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=du(),i=au,o=lu,e=0,s=p;e<s.length;e++)u=s[e],a=l.Pc(u.metadata.name),u.document&&(r=r.add(a)),i=i.zt(a,l.yc(u)),o=o.zt(a,l.gc(u.metadata.readTime));return c=n.Ec.Nr({Wr:!0}),[4,jh(n,Wo(Go(hi.ot("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Uh(e,c,i,ci.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n._o.Yi(e,h.targetId).next(function(){return n._o.er(e,r,h.targetId)}).next(function(){return n.Tc.Zo(e,t)})})})]}})})}(this.bh,new Pl(this.Qt),this.documents,this.il.id)];case 1:e=t.sent(),n=this.ol(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=du()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,jh(e,Wo(gc(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Fu(i.readTime);if(0<=n.Ot._(e))return r.wo.Ls(t,i);e=n.Mt(jr.T,e);return r.fc=r.fc.zt(e.targetId,e),r._o.Hi(t,e).next(function(){return r._o.Yi(t,n.targetId)}).next(function(){return r._o.er(t,o,n.targetId)}).next(function(){return r.wo.Ls(t,i)})})]}})})}(this.bh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Th(Object.assign({},this.progress),e))]}})})},Ll);function Ll(t,e,n){this.il=t,this.bh=e,this.Qt=n,this.queries=[],this.documents=[],this.progress=Ul(t)}function Rl(t){this.Qt=t}function Vl(t,e){this.payload=t,this.byteLength=e}function Ml(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}function Ul(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var jl=function(t){this.key=t},Fl=function(t){this.key=t},ql=(Object.defineProperty(Ql.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),Ql.prototype.fl=function(t,e){var s=this,u=e?e.dl:new gu,a=(e||this).ll,c=(e||this).De,h=a,f=!1,l=zo(this.query)&&a.size===this.query.limit?a.last():null,p=Ho(this.query)&&a.size===this.query.limit?a.first():null;if(t.Xt(function(t,e){var n=a.get(t),r=(r=e instanceof $i?e:null)&&(es(s.query,r)?r:null),i=!!n&&s.De.has(n.key),o=!!r&&(r.Vt||s.De.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.wl(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.hl(r,l)||p&&s.hl(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),zo(this.query)||Ho(this.query))for(;h.size>this.query.limit;){var n=zo(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{ll:h,dl:u,lc:f,De:c}},Ql.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},Ql.prototype.wi=function(t,e,n){var o=this,r=this.ll;this.ll=t.ll,this.De=t.De;var i=t.dl.ve();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.hl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.El(n);var s=e?this.Tl():[],n=0===this.ul.size&&this.Be?1:0,e=n!==this.al;return this.al=n,0!==i.length||e?{snapshot:new mu(this.query,t.ll,r,i,t.De,0==n,e,!1),Il:s}:{Il:s}},Ql.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new gu,De:this.De,lc:!1},!1)):{Il:[]}},Ql.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},Ql.prototype.El=function(t){var e=this;t&&(t.qe.forEach(function(t){return e.cl=e.cl.add(t)}),t.Ue.forEach(function(t){}),t.Qe.forEach(function(t){return e.cl=e.cl.delete(t)}),this.Be=t.Be)},Ql.prototype.Tl=function(){var e=this;if(!this.Be)return[];var n=this.ul;this.ul=du(),this.ll.forEach(function(t){e.ml(t.key)&&(e.ul=e.ul.add(t.key))});var r=[];return n.forEach(function(t){e.ul.has(t)||r.push(new Fl(t))}),this.ul.forEach(function(t){n.has(t)||r.push(new jl(t))}),r},Ql.prototype.Al=function(t){this.cl=t.Rc,this.ul=du();t=this.fl(t.documents);return this.wi(t,!0)},Ql.prototype.Rl=function(){return mu.Ne(this.query,this.ll,this.De,0===this.al)},Ql),Bl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Gl=function(t){this.key=t,this.Pl=!1},zl=(Object.defineProperty(Hl.prototype,"Ml",{get:function(){return!0===this.kl},enumerable:!1,configurable:!0}),Hl);function Hl(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new Cc($o,Zo),this.Sl=new Map,this.Dl=new Set,this.Cl=new $s(pi.H),this.xl=new Map,this.Nl=new Kh,this.$l={},this.Fl=new Map,this.Ol=zc.Li(),this.onlineState="Unknown",this.kl=void 0}function Ql(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=du(),this.De=du(),this.hl=ns(t),this.ll=new vu(this.hl)}function Yl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Ll=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.fl(o)).lc?[4,qh(r.bh,i.query,!1).then(function(t){t=t.documents;return i.view.fl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.$e.get(i.targetId),n=i.view.wi(e,r.Ml,n),[2,(rp(r,i.targetId,n.Il),n.snapshot)]}})})}(i,t,e,n)},[4,qh(i.bh,o,!0)];case 1:return n=t.sent(),r=new ql(o,n.Rc),e=r.fl(n.documents),n=wu.Le(s,u&&"Offline"!==i.onlineState),n=r.wi(e,i.Ml,n),rp(i,s,n.Il),r=new Bl(o,s,r),[2,(i.vl.set(o,r),i.Sl.has(s)?i.Sl.get(s).push(o):i.Sl.set(s,[o]),n.snapshot)]}})})}function Kl(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=lp(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.bh,a=p,h=i,f=ai.now(),o=a.reduce(function(t,e){return t.add(e.key)},du()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Tc.Xo(u,o).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof $i?e.field(o.field):void 0,s=as(o.transform,s||null);null!=s&&(n=(null==n?new Yi:n).set(o.field,s))}return n?n.Pt():null}(e.fieldTransforms,s));null!=s&&n.push(new Vs(o.key,s,function s(t){var u=[];return _i(t.fields||{},function(t,e){var n=new li([t]);if(Hi(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ii(u)}(s.proto.mapValue),Ss.exists(!0)))}return h.zo.Ri(u,f,n,a)})}).then(function(t){var e=t.xs(c);return{batchId:t.batchId,ri:e}}))];case 2:return s=t.sent(),u.Vl.Ca(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.$l[e.currentUser.A()])||new $s(Vr)).zt(n,r),e.$l[e.currentUser.A()]=i,[4,op(u,s.ri)];case 3:return t.sent(),[4,bl(u.yl)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Da(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function Xl(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Mh(n.bh,i)];case 2:return e=t.sent(),i.$e.forEach(function(t,e){e=n.xl.get(e);e&&(Cr(t.qe.size+t.Ue.size+t.Qe.size<=1),0<t.qe.size?e.Pl=!0:0<t.Ue.size?Cr(e.Pl):0<t.Qe.size&&(Cr(e.Pl),e.Pl=!1))}),[4,op(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Pc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Wl(t,n,e){var r,t=t;(t.Ml&&0===e||!t.Ml&&1===e)&&(r=[],t.vl.forEach(function(t,e){e=e.view.Gh(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Gh(i)&&(o=!0)}),o&&Dl(t)}(t.gl,n),r.length&&t.bl.ah(r),t.onlineState=n,t.Ml&&t.Vl.Qa(n))}function Jl(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.bh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.zo.Pi(e,r).next(function(t){return Cr(null!==t),n=t.keys(),i.zo.Ci(e,t)}).next(function(){return i.zo.$i(e)}).next(function(){return i.Tc.Xo(e,n)})}))];case 2:return o=t.sent(),tp(n,u,a),$l(n,u),n.Vl.Na(u,"rejected",a),[4,op(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Pc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function Zl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:dl((n=o).yl)||xr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.bh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.zo.Vi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Fl.get(r)||[]).push(s),n.Fl.set(r,i),[3,4]);case 3:return i=t.sent(),i=Da(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function $l(t,e){(t.Fl.get(e)||[]).forEach(function(t){t.resolve()}),t.Fl.delete(e)}function tp(t,e,n){var r=t,i=r.$l[r.currentUser.A()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$l[r.currentUser.A()]=i)}function ep(e,t,n){void 0===n&&(n=null),e.Vl.ka(t);for(var r=0,i=e.Sl.get(t);r<i.length;r++){var o=i[r];e.vl.delete(o),n&&e.bl.Bl(o,n)}e.Sl.delete(t),e.Ml&&e.Nl.Fc(t).forEach(function(t){e.Nl.Fi(t)||np(e,t)})}function np(t,e){t.Dl.delete(e.path.rt());var n=t.Cl.get(e);null!==n&&(cl(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),ip(t))}function rp(t,e,n){for(var r,i,o,s=0,u=n;s<u.length;s++){var a=u[s];a instanceof jl?(t.Nl.nr(a.key,e),r=t,o=void 0,i=(o=(i=a).key).path.rt(),r.Cl.get(o)||r.Dl.has(i)||(xr("SyncEngine","New document in limbo: "+o),r.Dl.add(i),ip(r))):a instanceof Fl?(xr("SyncEngine","Document no longer in limbo: "+a.key),t.Nl.ir(a.key,e),t.Nl.Fi(a.key)||np(t,a.key)):Pr()}}function ip(t){for(;0<t.Dl.size&&t.Cl.size<t.pl;){var e=t.Dl.values().next().value;t.Dl.delete(e);var n=new pi(hi.ot(e)),e=t.Ol.next();t.xl.set(e,new Gl(n)),t.Cl=t.Cl.zt(n,e),al(t.yl,new rs(Wo(Go(n.path)),e,2,ti.q))}}function op(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).vl.et()?[3,3]:(n.vl.forEach(function(t,e){o.push(n.Ll(e,s,u).then(function(t){t&&(n.Ml&&n.Vl.Ba(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ah.oc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.bl.ah(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return fa.forEach(c,function(e){return fa.forEach(e.ic,function(t){return r.persistence.Ti.nr(n,e.targetId,t)}).next(function(){return fa.forEach(e.rc,function(t){return r.persistence.Ti.ir(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!_a(e=t.sent()))throw e;return xr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.fc.get(o),u=s.Ot,u=s.Lt(u),r.fc=r.fc.zt(o,u));return[2]}})})}(n.bh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function sp(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(xr("SyncEngine","User change. New user:",o.A()),[4,Lh(n.bh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Fl.forEach(function(t){t.forEach(function(t){t.reject(new Gr(Br.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Fl.clear(),n.Vl.Ua(o,r.mc,r.Ac),[4,op(n,r.Ic)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function up(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).bh,n=a,i=(r=e).zo,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.yi(e,n).next(function(t){return t?r.Tc.Xo(e,t):fa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,bl(o.yl)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(tp(o,a,h||null),$l(o,a),o.bh.zo.xi(a)):Pr(),t.label=4;case 4:return[4,op(o,s)];case 5:return t.sent(),[3,7];case 6:xr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function ap(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return fp(r=h),lp(r),!0!==f||!0===r.kl?[3,3]:(e=r.Vl.va(),[4,cp(r,e.it())]);case 1:return i=t.sent(),r.kl=!0,[4,El(r.yl,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],al(r.yl,u);return[3,7];case 3:return!1!==f||!1===r.kl?[3,7]:(a=[],c=Promise.resolve(),r.Sl.forEach(function(t,e){r.Vl.Ma(e)?a.push(e):c=c.then(function(){return ep(r,e),Fh(r.bh,e,!0)}),cl(r.yl,e)}),[4,c]);case 4:return t.sent(),[4,cp(r,a)];case 5:return t.sent(),(n=r).xl.forEach(function(t,e){cl(n.yl,e)}),n.Nl.Oc(),n.xl=new Map,n.Cl=new $s(pi.H),r.kl=!1,[4,El(r.yl,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function cp(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Sl.get(s))&&0!==a.length?[4,jh(e.bh,Wo(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.vl.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,qh((e=r).bh,i.query,!0)];case 1:return n=t.sent(),n=i.view.Al(n),[2,(e.Ml&&rp(e,i.targetId,n.Il),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Bh(e.bh,s)];case 8:return l=t.sent(),[4,jh(e.bh,l)];case 9:return u=t.sent(),[4,Yl(e,hp(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.bl.ah(r),n)]}})})}function hp(t){return Bo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function fp(t){return t.yl.Dh.Lh=Xl.bind(null,t),t.yl.Dh.vn=function(t,e){var n=t;if((t=n.xl.get(e))&&t.Pl)return du().add(t.key);var r=du();if(!(e=n.Sl.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.vl.get(s),r=r.Pe(s.view._l);return r}.bind(null,t),t.yl.Dh.Mh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Vl.Ba(s,"rejected",u),i=e.xl.get(s),(n=i&&i.key)?(r=(r=new $s(pi.H)).zt(n,new to(n,ci.min())),i=du().add(n),i=new bu(ci.min(),new Map,new su(Vr),r,i),[4,Xl(e,i)]):[3,2];case 1:return t.sent(),e.Cl=e.Cl.remove(n),e.xl.delete(s),ip(e),[3,4];case 2:return[4,Fh(e.bh,s,!1).then(function(){return ep(e,s,u)}).catch(Pc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.bl.ah=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].zh(s)&&(r=!0);u.Kh=s}}r&&Dl(n)}.bind(null,t.gl),t.bl.Bl=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.gl),t}function lp(t){return t.yl.Dh.Bh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Rh(e.bh,o)];case 2:return r=t.sent(),tp(e,n,null),$l(e,n),e.Vl.Na(n,"acknowledged"),[4,op(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Pc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.yl.Dh.qh=Jl.bind(null,t),t}function pp(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.bh,o=r,s=Fu((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.wo.Os(t,i.id)}).then(function(t){return!!t&&0<=t.createTime._(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.ql({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Ul(Ul(u)),a=new Cl(u,l.bh,p.Qt),[4,p.Ql()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.rl(c)]:[3,10];case 7:return(h=t.sent())&&d.Ul(h),[4,p.Ql()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,op(l,f.Go,void 0)];case 12:return t.sent(),[4,(r=l.bh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.wo.ks(t,e)}))];case 13:return t.sent(),d.ql(f.progress),[3,15];case 14:return Or("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.Kl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.Vl.Wa()})}var dp,yp,vp=(Ip.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Qt=zf(e.yu.t),this.Vl=this.Wl(e),this.persistence=this.jl(e),[4,this.persistence.start()];case 1:return t.sent(),this.Gl=this.zl(e),this.bh=this.Hl(e),[2]}})})},Ip.prototype.zl=function(t){return null},Ip.prototype.Hl=function(t){return Ch(this.persistence,new Sh,t.Jl,this.Qt)},Ip.prototype.jl=function(t){return new tf(nf.ia,this.Qt)},Ip.prototype.Wl=function(t){return new Tf},Ip.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.ko()];case 1:return t.sent(),[4,this.persistence.ko()];case 2:return t.sent(),[2]}})})},Ip),gp=(n(Ep,yp=vp),Ep.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,yp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,zh(this.bh)];case 2:return t.sent(),[4,this.Yl.initialize(this,e)];case 3:return t.sent(),[4,lp(this.Yl._a)];case 4:return t.sent(),[4,bl(this.Yl.yl)];case 5:return t.sent(),[2]}})})},Ep.prototype.Hl=function(t){return Ch(this.persistence,new Sh,t.Jl,this.Qt)},Ep.prototype.zl=function(t){var e=this.persistence.Ti.lr;return new $c(e,t._s)},Ep.prototype.jl=function(t){var e=Ih(t.yu.t,t.yu.persistenceKey),n=void 0!==this.cacheSizeBytes?Oc.Ys(this.cacheSizeBytes):Oc.ti;return new bh(this.synchronizeTabs,e,t.clientId,n,t._s,Bf(),Gf(),this.Qt,this.Vl,!!this.forceOwnership)},Ep.prototype.Wl=function(t){return new Tf},Ep),mp=(n(_p,dp=gp),_p.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,dp.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Yl._a,this.Vl instanceof If?(this.Vl._a={eu:up.bind(null,e),nu:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).kl?(xr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.Sl.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Gh(e.bh)];case 3:return n=t.sent(),r=bu.Me(o,"current"===s),[4,op(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Fh(e.bh,o,!0)];case 6:return t.sent(),ep(e,o,u),[3,8];case 7:Pr(),t.label=8;case 8:return[2]}})})}.bind(null,e),su:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=fp(c)).kl)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Sl.has(r)?(xr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Bh(n.bh,r)]):[3,6];case 2:return i=t.sent(),[4,jh(n.bh,i)];case 3:return o=t.sent(),[4,Yl(n,hp(i),o.targetId,!1)];case 4:t.sent(),al(n.yl,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Sl.has(e)?[4,Fh(n.bh,e,!1).then(function(){cl(n.yl,e),ep(n,e)}).catch(Pc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Uo:function(t){return t.bh.persistence.Uo()}.bind(null,e),tu:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Gh((e=n).bh).then(function(t){return op(e,t)})]})})}.bind(null,e)},[4,this.Vl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Ro(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ap(this.Yl._a,e)];case 1:return t.sent(),this.Gl&&(e&&!this.Gl.Er?this.Gl.start(this.bh):e||this.Gl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},_p.prototype.Wl=function(t){var e=Bf();if(!If.Kn(e))throw new Gr(Br.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ih(t.yu.t,t.yu.persistenceKey);return new If(e,t._s,n,t.clientId,t.Jl)},_p),bp=(wp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.bh?[3,2]:(this.bh=n.bh,this.Vl=n.Vl,this.Sh=this.Xl(r),this.yl=this.Zl(r),this.gl=this.t_(r),this._a=this.e_(r,!n.synchronizeTabs),this.Vl.fa=function(t){return Wl(e._a,t,1)},this.yl.Dh.n_=sp.bind(null,this._a),[4,El(this.yl,this._a.Ml)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},wp.prototype.t_=function(t){return new Nl},wp.prototype.Xl=function(t){var e=zf(t.yu.t),n=(n=t.yu,new Df(n));return t=t.credentials,new Zf(t,n,e)},wp.prototype.Zl=function(t){var e=this,n=this.bh,r=this.Sh,i=t._s,o=function(t){return Wl(e._a,t,0)},t=new(Af.Kn()?Af:Nf);return new Hf(n,r,i,o,t)},wp.prototype.e_=function(t,e){return function(t,e,n,r,i,o,s){o=new zl(t,e,n,r,i,o);return s&&(o.kl=!0),o}(this.bh,this.yl,this.gl,this.Vl,t.Jl,t.pl,e)},wp.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,xr("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,ul(e)];case 1:return t.sent(),e.Fh.ko(),e.Oh.set("Unknown"),[2]}})})}(this.yl)},wp);function wp(){}function _p(t,e){var n=this;return(n=dp.call(this,t,e,!1)||this).Yl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function Ep(t,e,n){var r=this;return(r=yp.call(this)||this).Yl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function Ip(){this.synchronizeTabs=!1}function Tp(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var Np=(Pp.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},Pp.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Pp.prototype.i_=function(){this.muted=!0},Pp.prototype.s_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Pp),Ap=(kp.prototype.close=function(){return this.r_.cancel()},kp.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},kp.prototype.Ql=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.c_())]}})})},kp.prototype.c_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.a_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.o_.decode(e),n=Number(r),isNaN(n)&&this.u_("length string ("+r+") is not valid number"),[4,this.h_(n)]);case 2:return r=t.sent(),[2,new kl(JSON.parse(r),e.length+n)]}})})},kp.prototype.l_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},kp.prototype.a_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.l_()<0?[4,this.__()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.l_())<0&&this.u_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},kp.prototype.h_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.__()]:[3,3];case 1:t.sent()&&this.u_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.o_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},kp.prototype.u_=function(t){throw this.r_.cancel(),new Error("Invalid bundle format: "+t)},kp.prototype.__=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.r_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},kp),Sp=(Op.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},Op),xp=function(t){this._methodName=t},Dp=function(t){this.d_=t};function Op(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Gr(Br.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new li(t)}function kp(t,e){var n=this;this.r_=t,this.Qt=e,this.metadata=new ha,this.buffer=new Uint8Array,this.o_=new TextDecoder("utf-8"),this.c_().then(function(t){t&&t.sl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Pp(t){this.observer=t,this.muted=!1}function Cp(t,e,n){if(!n)throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Lp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Gr(Br.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Rp(t,e,n,r){if(!0===e&&!0===r)throw new Gr(Br.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Vp(t){if(!pi.wt(t))throw new Gr(Br.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Mp(t){if(pi.wt(t))throw new Gr(Br.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Up(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function jp(t,e){if((t="_delegate"in t?t.d_:t)instanceof e)return t;if(e.name===t.constructor.name)throw new Gr(Br.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Up(t);throw new Gr(Br.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Fp(t,e){if(e<=0)throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var qp,Bp=(Zp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Zp),Gp=new Map,zp=(Object.defineProperty(Jp.prototype,"app",{get:function(){if(!this.A_)throw new Gr(Br.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(Jp.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),Jp.prototype.g_=function(t){if(this.T_)throw new Gr(Br.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Bp(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Wr;switch(t.type){case"gapi":var e=t.client;return Cr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new $r(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Gr(Br.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Jp.prototype.V_=function(){return this.E_},Jp.prototype.p_=function(){return this.T_=!0,this.E_},Jp.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},Jp.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},Jp.prototype.b_=function(){return(t=Gp.get(this))&&(xr("ComponentProvider","Removing Datastore"),Gp.delete(this),t.terminate()),Promise.resolve();var t},Jp),Hp=(Object.defineProperty(Wp.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"parent",{get:function(){return new Yp(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),Wp.prototype.withConverter=function(t){return new Wp(this.firestore,t,this.S_)},Wp),Qp=(Xp.prototype.withConverter=function(t){return new Xp(this.firestore,t,this.C_)},Xp),Yp=(n(Kp,qp=Qp),Object.defineProperty(Kp.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new Hp(this.firestore,null,new pi(t))},enumerable:!1,configurable:!0}),Kp.prototype.withConverter=function(t){return new Kp(this.firestore,t,this.D_)},Kp);function Kp(t,e,n){var r=this;return(r=qp.call(this,t,e,Go(n))||this).firestore=t,r.D_=n,r.type="collection",r}function Xp(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function Wp(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function Jp(t,e){this.w_="(lite)",this.E_=new Bp({}),this.T_=!1,t instanceof Tr?(this.I_=t,this.m_=new Wr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Gr(Br.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tr(t.options.projectId)}(t),this.m_=new Jr(e))}function Zp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Gr(Br.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Gr(Br.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Rp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function $p(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Dp&&(t=t.d_),Cp("collection","path",e),t instanceof zp)return Mp(n=hi.ot.apply(hi,s([e],r))),new Yp(t,null,n);if(!(t instanceof Hp||t instanceof Yp))throw new Gr(Br.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Mp(n=hi.ot.apply(hi,s([t.path],r)).child(hi.ot(e))),new Yp(t.firestore,null,n)}function td(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Dp&&(t=t.d_),Cp("doc","path",e=1===arguments.length?Lr.u():e),t instanceof zp)return Vp(n=hi.ot.apply(hi,s([e],r))),new Hp(t,null,new pi(n));if(!(t instanceof Hp||t instanceof Yp))throw new Gr(Br.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Vp(n=t.D_.child(hi.ot.apply(hi,s([e],r)))),new Hp(t.firestore,t instanceof Yp?t.v_:null,new pi(n))}function ed(t,e){return t instanceof Dp&&(t=t.d_),e instanceof Dp&&(e=e.d_),(t instanceof Hp||t instanceof Yp)&&(e instanceof Hp||e instanceof Yp)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function nd(t,e){return t instanceof Dp&&(t=t.d_),e instanceof Dp&&(e=e.d_),t instanceof Qp&&e instanceof Qp&&t.firestore===e.firestore&&Zo(t.C_,e.C_)&&t.v_===e.v_}var rd=(Object.defineProperty(cd.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),cd.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},cd.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},cd.prototype.U=function(t){return Vr(this.x_,t.x_)||Vr(this.N_,t.N_)},cd),id=/^__.*__$/,od=(ad.prototype.F_=function(t,e){return null!==this.Gt?new Vs(t,this.data,this.Gt,e,this.fieldTransforms):new Rs(t,this.data,e,this.fieldTransforms)},ad),sd=(ud.prototype.F_=function(t,e){return new Vs(t,this.data,this.Gt,e,this.fieldTransforms)},ud);function ud(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}function ad(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}function cd(t,e){if(!isFinite(t)||t<-90||90<t)throw new Gr(Br.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Gr(Br.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function hd(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var fd=(Object.defineProperty(dd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),dd.prototype.M_=function(t){return new dd(Object.assign(Object.assign({},this.settings),t),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},dd.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.M_({path:e,B_:!1});return e.q_(t),e},dd.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.M_({path:t,B_:!1});return t.O_(),t},dd.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},dd.prototype.K_=function(t){return Gd(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},dd.prototype.contains=function(e){return void 0!==this.Gt.find(function(t){return e.nt(t)})||void 0!==this.fieldTransforms.find(function(t){return e.nt(t.field)})},dd.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},dd.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(hd(this.k_)&&id.test(t))throw this.K_('Document fields cannot begin and end with "__"')},dd),ld=(pd.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new fd({k_:t,methodName:e,j_:n,path:li.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},pd);function pd(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||zf(t)}function dd(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}function yd(t){var e=t.p_(),n=zf(t.I_);return new ld(t.I_,!!e.ignoreUndefinedProperties,n)}function vd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);jd("Data must be an object, but it was:",s,r);var u,a,r=Md(r,s);if(o.merge)u=new Ii(s.Gt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Fd(e,f[h],n);if(!s.contains(l))throw new Gr(Br.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");zd(c,l)||c.push(l)}u=new Ii(c),a=s.fieldTransforms.filter(function(t){return u.Tt(t.field)})}else u=null,a=s.fieldTransforms;return new od(new Qi(r),u,a)}var gd,md=(n(bd,gd=xp),bd.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},bd.prototype.isEqual=function(t){return t instanceof bd},bd);function bd(){return null!==gd&&gd.apply(this,arguments)||this}function wd(t,e,n){return new fd({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var _d,Ed,Id,Td,Nd=(n(Pd,Td=xp),Pd.prototype.z_=function(t){return new As(t.path,new fs)},Pd.prototype.isEqual=function(t){return t instanceof Pd},Pd),Ad=(n(kd,Id=xp),kd.prototype.z_=function(t){var e=wd(this,t,!0),n=this.H_.map(function(t){return Vd(t,e)}),n=new ls(n);return new As(t.path,n)},kd.prototype.isEqual=function(t){return this===t},kd),Sd=(n(Od,Ed=xp),Od.prototype.z_=function(t){var e=wd(this,t,!0),n=this.H_.map(function(t){return Vd(t,e)}),n=new gs(n);return new As(t.path,n)},Od.prototype.isEqual=function(t){return this===t},Od),xd=(n(Dd,_d=xp),Dd.prototype.z_=function(t){var e=new _s(t.Qt,us(t.Qt,this.J_));return new As(t.path,e)},Dd.prototype.isEqual=function(t){return this===t},Dd);function Dd(t,e){var n=this;return(n=_d.call(this,t)||this).J_=e,n}function Od(t,e){var n=this;return(n=Ed.call(this,t)||this).H_=e,n}function kd(t,e){var n=this;return(n=Id.call(this,t)||this).H_=e,n}function Pd(){return null!==Td&&Td.apply(this,arguments)||this}function Cd(t,r,i,e){var o=t.G_(1,r,i);jd("Data must be an object, but it was:",o,e);var s=[],u=new Yi;_i(e,function(t,e){var n=Bd(r,t,i);e instanceof Dp&&(e=e.d_);t=o.U_(n);e instanceof md?s.push(n):null!=(t=Vd(e,t))&&(s.push(n),u.set(n,t))});e=new Ii(s);return new sd(u.Pt(),e,o.fieldTransforms)}function Ld(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Fd(e,r,n)],a=[i];if(o.length%2!=0)throw new Gr(Br.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Fd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Yi,y=u.length-1;0<=y;--y)zd(p,u[y])||(h=u[y],(f=a[y])instanceof Dp&&(f=f.d_),l=s.U_(h),f instanceof md?p.push(h):null!=(l=Vd(f,l))&&(p.push(h),d.set(h,l)));i=new Ii(p);return new sd(d.Pt(),i,s.fieldTransforms)}function Rd(t,e,n,r){return void 0===r&&(r=!1),Vd(n,t.G_(r?4:3,e))}function Vd(s,t){if(Ud(s=s instanceof Dp?s.d_:s))return jd("Unsupported field value:",t,s),Md(s,t);if(s instanceof xp)return function(t,e){if(!hd(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");t=t.z_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(void 0===s&&t.ignoreUndefinedProperties)return null;if(t.path&&t.Gt.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Vd(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===(t=t instanceof Dp?t.d_:t))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return us(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ai.fromDate(t);return{timestampValue:Uu(e.Qt,n)}}if(t instanceof ai)return n=new ai(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Uu(e.Qt,n)};if(t instanceof rd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof zr)return{bytesValue:ju(e.Qt,t.I)};if(t instanceof Hp){n=e.t;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:qu(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+Up(t))}(s,t)}function Md(t,n){var r={};return Ei(t)?n.path&&0<n.path.length&&n.Gt.push(n.path):_i(t,function(t,e){e=Vd(e,n.L_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Ud(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ai||t instanceof rd||t instanceof zr||t instanceof Hp||t instanceof xp)}function jd(t,e,n){if(!Ud(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Up(n);throw"an object"===n?e.K_(t+" a custom object"):e.K_(t+" "+n)}var r}function Fd(t,e,n){if((e=e instanceof Dp?e.d_:e)instanceof Sp)return e.f_;if("string"==typeof e)return Bd(t,e);throw Gd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var qd=new RegExp("[~\\*/\\[\\]]");function Bd(e,n,r){if(0<=n.search(qd))throw Gd("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Sp.bind.apply(Sp,s([void 0],n.split("."))))).f_}catch(t){throw Gd("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Gd(t,e,n,r,i){var o=r&&!r.et(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Gr(Br.INVALID_ARGUMENT,(e+=". ")+t+n)}function zd(t,e){return t.some(function(t){return t.isEqual(e)})}var Hd=(Wd.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Gr(Br.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Yu((n=s).Qt)+"/documents",r={documents:u.map(function(t){return Gu(n.Qt,t)})},[4,n.Du("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.Qt,"found"in(t=t)?function(t,e){Cr(!!e.found),e.found.name,e.found.updateTime;var n=zu(t,e.found.name),t=Fu(e.found.updateTime),e=new Qi({mapValue:{fields:e.found.fields}});return new $i(n,t,e,{})}(e,t):"missing"in t?function(t,e){Cr(!!e.missing),Cr(!!e.readTime);t=zu(t,e.missing),e=Fu(e.readTime);return new to(t,e)}(e,t):Pr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Cr(!!t),o.push(t)}),o)]}})})}(this.Sh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof to||t instanceof $i?n.sf(t):Pr()}),e)]}})})},Wd.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},Wd.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},Wd.prototype.delete=function(t){this.write(new Ys(t,this.jt(t))),this.tf.add(t.toString())},Wd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=pi._t(e);n.mutations.push(new Ks(e,n.jt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Yu((e=i).Qt)+"/documents",r={writes:o.map(function(t){return Ju(e.Qt,t)})},[4,e.pu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Sh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},Wd.prototype.sf=function(t){var e;if(t instanceof $i)e=t.version;else{if(!(t instanceof to))throw Pr();e=ci.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Gr(Br.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},Wd.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Ss.updateTime(e):Ss.Kt()},Wd.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Ss.exists(!0);if(e.isEqual(ci.min()))throw new Gr(Br.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ss.updateTime(e)},Wd.prototype.write=function(t){this.nf(),this.mutations.push(t)},Wd.prototype.nf=function(){},Wd),Qd=(Xd.prototype.run=function(){this.af()},Xd.prototype.af=function(){var t=this;this.Gu.Lu(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Hd(this.Sh),(n=this.uf(e))&&n.then(function(t){r._s.Ps(function(){return e.commit().then(function(){r.Es.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},Xd.prototype.uf=function(t){try{var e=this.updateFunction(t);return!ki(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},Xd.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this._s.Ps(function(){return e.af(),Promise.resolve()})):this.Es.reject(t)},Xd.prototype.lf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Js(t)},Xd),Yd=(Kd.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}})})},Kd.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then(function(){return e._f(e.user)})},Kd.prototype.df=function(){if(this._s.wf)throw new Gr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},Kd.prototype.terminate=function(){var t=this;this._s.Ef();var n=new ha;return this._s.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.S(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Da(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Kd);function Kd(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=Hr.UNAUTHENTICATED,this.clientId=Lr.u(),this._f=function(){},this.C=new ha,this.credentials.v(function(t){xr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()})}function Xd(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new Xf(this._s,"transaction_retry")}function Wd(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function Jd(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i._s.Af(),xr("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.Jl,i.ff(function(e){n.isEqual(e)||(n=e,i._s.po(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Lh(o.bh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.Po(function(){return i.terminate()}),i.mf=o,[2]}})})}function Zd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r._s.Af(),[4,$d(r)];case 1:return e=t.sent(),xr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r._s.po(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r)._s.Af(),xr("RemoteStore","RemoteStore received new credentials"),n=dl(e),e.Nh.add(3),[4,ul(e)];case 1:return t.sent(),n&&e.Oh.set("Unknown"),[4,e.Dh.n_(i)];case 2:return t.sent(),e.Nh.delete(3),[4,sl(e)];case 3:return t.sent(),[2]}})})}(i.yl,t)})}),r.If=i,[2]}})})}function $d(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(xr("FirestoreClient","Using default OfflineComponentProvider"),[4,Jd(e,new vp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function ty(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(xr("FirestoreClient","Using default OnlineComponentProvider"),[4,Zd(e,new bp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function ey(t){return $d(t).then(function(t){return t.persistence})}function ny(t){return $d(t).then(function(t){return t.bh})}function ry(t){return ty(t).then(function(t){return t.yl})}function iy(t){return ty(t).then(function(t){return t._a})}function oy(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ty(r)];case 1:return e=t.sent(),[2,((n=e.gl).jh=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=fp(s),(o=e.vl.get(u))?(n=o.targetId,e.Vl.Fa(n),r=o.view.Rl(),[3,4]):[3,1];case 1:return[4,jh(e.bh,Wo(u))];case 2:return i=t.sent(),o=e.Vl.Fa(i.targetId),n=i.targetId,[4,Yl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Ml&&al(e.yl,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e._a),n.Hh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).vl.get(o),1<(r=e.Sl.get(n.targetId)).length?[2,(e.Sl.set(n.targetId,r.filter(function(t){return!Zo(t,o)})),void e.vl.delete(o))]:e.Ml?(e.Vl.ka(n.targetId),e.Vl.Da(n.targetId)?[3,2]:[4,Fh(e.bh,n.targetId,!1).then(function(){e.Vl.La(n.targetId),cl(e.yl,n.targetId),ep(e,n.targetId)}).catch(Pc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return ep(e,n.targetId),[4,Fh(e.bh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e._a),n)]}})})}function sy(n,r,i){var t=this;void 0===i&&(i={});var o=new ha;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Np({next:function(t){r.Ps(function(){return xl(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Gr(Br.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Gr(Br.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Ol(Go(i.path),t,{includeMetadataChanges:!0,nl:!0});return Sl(n,u)},[4,oy(n)];case 1:return[2,e.apply(void 0,[t.sent(),n._s,r,i,o])]}})})}),o.promise}function uy(n,r,i){var t=this;void 0===i&&(i={});var o=new ha;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Np({next:function(t){n.Ps(function(){return xl(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Gr(Br.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Ol(t,o,{includeMetadataChanges:!0,nl:!0});return Sl(e,s)},[4,oy(n)];case 1:return[2,e.apply(void 0,[t.sent(),n._s,r,i,o])]}})})}),o.promise}var ay=(Object.defineProperty(cy.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),cy.prototype.Ps=function(t){this.enqueue(t)},cy.prototype.Tf=function(t){this.Sf(),this.Df(t)},cy.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Gf())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},cy.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},cy.prototype.po=function(t){var e=this;this.Ps(function(){return e.Pf.push(t),e.Cf()})},cy.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!_a(e=t.sent()))throw e;return xr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.Gu.Lu(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},cy.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",n=e.stack?e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack:n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},cy.prototype.Tr=function(t,e,n){var r=this;this.Sf(),-1<this.bf.indexOf(t)&&(e=0);n=Sa.Ts(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(n),n},cy.prototype.Sf=function(){this.Vf&&Pr()},cy.prototype.Af=function(){},cy.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},cy.prototype.$f=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},cy.prototype.Ff=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.ds-e.ds});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Rs(),"all"!==r&&n.fs===r)break}return i.Nf()})},cy.prototype.Of=function(t){this.bf.push(t)},cy.prototype.xf=function(t){t=this.gf.indexOf(t);this.gf.splice(t,1)},cy);function cy(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new Xf(this,"async_queue_retry"),this.vf=function(){var t=Gf();t&&xr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Gu.qu()};var t=Gf();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function hy(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var fy,ly=(yy.prototype.onProgress=function(t,e,n){this.kf={next:t,error:e,complete:n}},yy.prototype.catch=function(t){return this.Mf.promise.catch(t)},yy.prototype.then=function(t,e){return this.Mf.promise.then(t,e)},yy.prototype.ql=function(t){this.Ul(t),this.kf.complete&&this.kf.complete(),this.Mf.resolve(t)},yy.prototype.Kl=function(t){this.Lf.taskState="Error",this.kf.next&&this.kf.next(this.Lf),this.kf.error&&this.kf.error(t),this.Mf.reject(t)},yy.prototype.Ul=function(t){this.Lf=t,this.kf.next&&this.kf.next(t)},yy),py=(n(dy,fy=zp),dy.prototype.b_=function(){return this.qf||gy(this),this.qf.terminate()},dy);function dy(t,e){var n=this;return(n=fy.call(this,t,e)||this).Bf=new ay,n.w_="name"in t?t.name:"[DEFAULT]",n}function yy(){this.kf={},this.Mf=new ha,this.Lf={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function vy(t){return t.qf||gy(t),t.qf.df(),t.qf}function gy(t){var e,n,r=t.p_(),r=(e=t.I_,n=t.w_,new Ir(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.qf=new Yd(t.m_,t.Bf,r)}function my(r,i,o){var t=this,s=new ha;return r._s.enqueue(function(){return y(t,void 0,void 0,function(){var n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Jd(r,o)];case 1:return t.sent(),[4,Zd(r,i)];case 2:return t.sent(),s.resolve(),[3,4];case 3:if(!("FirebaseError"===(e=n=t.sent()).name?e.code===Br.FAILED_PRECONDITION||e.code===Br.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code))throw n;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),s.reject(n),[3,4];case 4:return[2]}var e})})}).then(function(){return s.promise})}function by(t){if(t.R_||t.P_)throw new Gr(Br.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var wy,c=(Ny.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),Li(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Si(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(xi(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw Pr()}},Ny.prototype.Hf=function(t,n){var r=this,i={};return _i(t.fields||{},function(t,e){i[t]=r.Uf(e,n)}),i},Ny.prototype.Gf=function(t){return new rd(Si(t.latitude),Si(t.longitude))},Ny.prototype.zf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Uf(t,e)})},Ny.prototype.Kf=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return Di(e)?t(e):e}(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(Oi(t));default:return null}},Ny.prototype.Qf=function(t){t=Ai(t);return new ai(t.seconds,t.nanos)},Ny.prototype.Jf=function(t,e){var n=hi.ot(t);Cr(aa(n));t=new Tr(n.get(1),n.get(3)),n=new pi(n.Y(5));return t.isEqual(e)||Dr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Ny),_y=(Object.defineProperty(Ty.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(Ty.prototype,"ref",{get:function(){return new Hp(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),Ty.prototype.exists=function(){return null!==this.Zf},Ty.prototype.data=function(){if(this.Zf){if(this.v_){var t=new Ey(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},Ty.prototype.get=function(t){if(this.Zf){t=this.Zf.data().field(Ay("DocumentSnapshot.get",t));if(null!==t)return this.Xf.Uf(t)}},Ty),Ey=(n(Iy,wy=_y),Iy.prototype.data=function(){return wy.prototype.data.call(this)},Iy);function Iy(){return null!==wy&&wy.apply(this,arguments)||this}function Ty(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}function Ny(){}function Ay(t,e){return"string"==typeof e?Bd(t,e):(e instanceof Dp?e.d_:e).f_}function Sy(t){if(Ho(t)&&0===t.xt.length)throw new Gr(Br.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}Ee=function(){};function xy(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].td(t);return t}var Dy,Oy,ky,Py,Cy,Ly=(n(Gy,Cy=Ee),Gy.prototype.td=function(t){var e=yd(t.firestore),e=function(t,e,n,r,i,o){if(r.ut()){if("array-contains"===i||"array-contains-any"===i)throw new Gr(Br.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Qy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Hy(n,t,c))}h={arrayValue:{values:s}}}else h=Hy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Qy(o,i),h=Rd(e,"where",o,"in"===i||"not-in"===i);var h=fo.create(r,i,h);return function(t,e){if(e.Ct()){var n=Yo(t);if(null!==n&&!n.isEqual(e.field))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Qo(t);null!==n&&Yy(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Gr(Br.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Gr(Br.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.ed,this.nd,this.sd);return new Qp(t.firestore,t.v_,(t=t.C_,e=t.filters.concat([e]),new qo(t.path,t.collectionGroup,t.xt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Gy),Ry=(n(By,Py=Ee),By.prototype.td=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Uo(e,n);return e=r,null!==Qo(n=t)||null!==(t=Yo(n))&&Yy(0,t,e.field),r}(t.C_,this.ed,this.rd);return new Qp(t.firestore,t.v_,(t=t.C_,e=t.xt.concat([e]),new qo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},By),Vy=(n(qy,ky=Ee),qy.prototype.td=function(t){return new Qp(t.firestore,t.v_,Jo(t.C_,this.od,this.ad))},qy),My=(n(Fy,Oy=Ee),Fy.prototype.td=function(t){var e=zy(t,this.type,this.ud,this.hd);return new Qp(t.firestore,t.v_,(t=t.C_,e=e,new qo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Fy),Uy=(n(jy,Dy=Ee),jy.prototype.td=function(t){var e=zy(t,this.type,this.ud,this.hd);return new Qp(t.firestore,t.v_,(t=t.C_,e=e,new qo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},jy);function jy(t,e,n){var r=this;return(r=Dy.call(this)||this).type=t,r.ud=e,r.hd=n,r}function Fy(t,e,n){var r=this;return(r=Oy.call(this)||this).type=t,r.ud=e,r.hd=n,r}function qy(t,e,n){var r=this;return(r=ky.call(this)||this).type=t,r.od=e,r.ad=n,r}function By(t,e){var n=this;return(n=Py.call(this)||this).ed=t,n.rd=e,n.type="orderBy",n}function Gy(t,e,n){var r=this;return(r=Cy.call(this)||this).ed=t,r.nd=e,r.sd=n,r.type="where",r}function zy(t,c,e,n){if(e[0]instanceof Dp&&(e[0]=e[0].d_),e[0]instanceof _y)return function(t,e,n,r){if(!n)throw new Gr(Br.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Xo(t);o<s.length;o++){var u=s[o];if(u.field.ut())i.push(Fi(e,n.key));else{var a=n.field(u.field);if(Di(a))throw new Gr(Br.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.rt();throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Po(i,r)}(t.C_,t.firestore.I_,e[0].Zf,n);var r=yd(t.firestore);return function(t,e,n,r,i,o){var s=t.xt;if(i.length>s.length)throw new Gr(Br.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ut()){if("string"!=typeof c)throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ko(t)&&-1!==c.indexOf("/"))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(hi.ot(c));if(!pi.wt(h))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new pi(h);u.push(Fi(e,h))}else{c=Rd(n,r,c);u.push(c)}}return new Po(u,o)}(t.C_,t.firestore.I_,r,c,e,n)}function Hy(t,e,n){if("string"==typeof(n=n instanceof Dp?n.d_:n)){if(""===n)throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ko(e)&&-1!==n.indexOf("/"))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(hi.ot(n));if(!pi.wt(e))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Fi(t,new pi(e))}if(n instanceof Hp)return Fi(t,n.S_);throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Up(n)+".")}function Qy(t,e){if(!Array.isArray(t)||0===t.length)throw new Gr(Br.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Gr(Br.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Yy(t,e,n){if(!n.isEqual(e))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ky(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Xy,Wy,Jy,Zy=(n(uv,Jy=c),uv.prototype.Wf=function(t){return new zr(t)},uv.prototype.jf=function(t){t=this.Jf(t,this.firestore.I_);return new Hp(this.firestore,null,t)},uv),$y=(sv.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},sv),tv=(n(ov,Wy=_y),ov.prototype.exists=function(){return Wy.prototype.exists.call(this)},ov.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new ev(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},ov.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf){t=this.Zf.data().field(Ay("DocumentSnapshot.get",t));if(null!==t)return this.Xf.Uf(t,e.serverTimestamps)}},ov),ev=(n(iv,Xy=tv),iv.prototype.data=function(t){return void 0===t&&(t={}),Xy.prototype.data.call(this,t)},iv),nv=(Object.defineProperty(rv.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(rv.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(rv.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),rv.prototype.forEach=function(e,n){var r=this;this._d.docs.forEach(function(t){e.call(n,new ev(r.Yf,r.Xf,t.key,t,new $y(r._d.De.has(t.key),r._d.fromCache),r.query.v_))})},rv.prototype.docChanges=function(t){t=!!(t=void 0===t?{}:t).includeMetadataChanges;if(t&&this._d.xe)throw new Gr(Br.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===t||(this.fd=function(i,e){if(i._d.Se.et()){var n=0;return i._d.docChanges.map(function(t){var e=new ev(i.Yf,i.Xf,t.doc.key,t.doc,new $y(i._d.De.has(t.doc.key),i._d.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i._d.Se;return i._d.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new ev(i.Yf,i.Xf,t.doc.key,t.doc,new $y(i._d.De.has(t.doc.key),i._d.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.dd=t),this.fd},rv);function rv(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new $y(r.hasPendingWrites,r.fromCache),this.query=n}function iv(){return null!==Xy&&Xy.apply(this,arguments)||this}function ov(t,e,n,r,i,o){var s=this;return(s=Wy.call(this,t,e,n,r,o)||this).Yf=t,s.ld=t,s.metadata=i,s}function sv(t,e){this.hasPendingWrites=t,this.fromCache=e}function uv(t){var e=this;return(e=Jy.call(this)||this).firestore=t,e}function av(t,e){return t instanceof tv&&e instanceof tv?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof nv&&e instanceof nv&&t.Yf===e.Yf&&nd(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}var cv,hv=(n(fv,cv=c),fv.prototype.Wf=function(t){return new zr(t)},fv.prototype.jf=function(t){t=this.Jf(t,this.firestore.I_);return new Hp(this.firestore,null,t)},fv);function fv(t){var e=this;return(e=cv.call(this)||this).firestore=t,e}function lv(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=jp(t,Hp);var o=jp(t.firestore,py),s=yd(o);return dv(o,[("string"==typeof(e=e instanceof Dp?e.d_:e)||e instanceof Sp?Ld(s,"updateDoc",t.S_,e,n,r):Cd(s,"updateDoc",t.S_,e)).F_(t.S_,Ss.exists(!0))])}function pv(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Dp&&(e=e.d_);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||hy(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return hy(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Hp?(u=jp(e.firestore,py),a=Go(e.S_.path),h={next:function(t){n[i]&&n[i](yv(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=jp(e,Qp),u=jp(s.firestore,py),a=s.C_,c=new hv(u),h={next:function(t){n[i]&&n[i](new nv(u,c,s,t))},error:n[i+1],complete:n[i+2]},Sy(e.C_)),function(n,t,e){var r=this,i=new Np(h),o=new Ol(t,i,e);return n._s.Ps(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Sl,[4,oy(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.i_(),n._s.Ps(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=xl,[4,oy(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(vy(u),a,f)}function dv(t,e){return function(n,r){var t=this,i=new ha;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Kl,[4,iy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(vy(t),e)}function yv(t,e,n){var r=n.docs.get(e.S_),i=new hv(t);return new tv(t,i,e.S_,r,new $y(n.hasPendingWrites,n.fromCache),e.v_)}var vv=(gv.prototype.set=function(t,e,n){this.md();t=mv(t,this.Yf),e=Ky(t.v_,e,n),n=vd(this.Id,"WriteBatch.set",t.S_,e,null!==t.v_,n);return this.Ed.push(n.F_(t.S_,Ss.Kt())),this},gv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.md();t=mv(t,this.Yf),e="string"==typeof(e=e instanceof Dp?e.d_:e)||e instanceof Sp?Ld(this.Id,"WriteBatch.update",t.S_,e,n,r):Cd(this.Id,"WriteBatch.update",t.S_,e);return this.Ed.push(e.F_(t.S_,Ss.exists(!0))),this},gv.prototype.delete=function(t){this.md();t=mv(t,this.Yf);return this.Ed=this.Ed.concat(new Ys(t.S_,Ss.Kt())),this},gv.prototype.commit=function(){return this.md(),this.Td=!0,0<this.Ed.length?this.wd(this.Ed):Promise.resolve()},gv.prototype.md=function(){if(this.Td)throw new Gr(Br.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},gv);function gv(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=yd(t)}function mv(t,e){if((t=t instanceof Dp?t.d_:t).firestore!==e)throw new Gr(Br.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var bv,wv=(Ev.prototype.get=function(t){var e=this,n=mv(t,this.Yf),r=new Zy(this.Yf);return this.Ad.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Pr();t=t[0];if(t instanceof to)return new _y(e.Yf,r,n.S_,null,n.v_);if(t instanceof $i)return new _y(e.Yf,r,t.key,t,n.v_);throw Pr()})},Ev.prototype.set=function(t,e,n){t=mv(t,this.Yf),e=Ky(t.v_,e,n),n=vd(this.Id,"Transaction.set",t.S_,e,null!==t.v_,n);return this.Ad.set(t.S_,n),this},Ev.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=mv(t,this.Yf),e="string"==typeof(e=e instanceof Dp?e.d_:e)||e instanceof Sp?Ld(this.Id,"Transaction.update",t.S_,e,n,r):Cd(this.Id,"Transaction.update",t.S_,e);return this.Ad.update(t.S_,e),this},Ev.prototype.delete=function(t){t=mv(t,this.Yf);return this.Ad.delete(t.S_),this},n(_v,bv=Ev),_v.prototype.get=function(t){var e=this,n=mv(t,this.Yf),r=new hv(this.Yf);return bv.prototype.get.call(this,t).then(function(t){return new tv(e.Yf,r,n.S_,t.Zf,new $y(!1,!1),n.v_)})},_v);function _v(t,e){var n=this;return(n=bv.call(this,t,e)||this).Yf=t,n}function Ev(t,e){this.Yf=t,this.Ad=e,this.Id=yd(t)}function Iv(){if("undefined"==typeof Uint8Array)throw new Gr(Br.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Tv(){if("undefined"==typeof atob)throw new Gr(Br.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Nv,Av,Sv,xv=(n(Rv,Sv=Dp),Rv.fromBase64String=function(t){return Tv(),new Rv(zr.fromBase64String(t))},Rv.fromUint8Array=function(t){return Iv(),new Rv(zr.fromUint8Array(t))},Rv.prototype.toBase64=function(){return Tv(),this.d_.toBase64()},Rv.prototype.toUint8Array=function(){return Iv(),this.d_.toUint8Array()},Rv.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},Rv.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Rv),Dv=(Lv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){by(t=jp(t,py));var n=vy(t),r=t.p_(),t=new bp;return my(n,t,new gp(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.d_,{forceOwnership:e})},Lv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){by(t=jp(t,py));var e=vy(t),n=t.p_(),t=new bp;return my(e,t,new mp(t,n.cacheSizeBytes))}(t.d_)},Lv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.R_&&!n.P_)throw new Gr(Br.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new ha;return n.Bf.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return pa.Kn()?(e=n+"main",[4,pa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Ih(n.I_,n.w_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.d_)},Lv),Ov=(n(Cv,Av=Dp),Object.defineProperty(Cv.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),Cv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},Cv.prototype.useEmulator=function(t,e){var n,r;n=this.d_,r=t,t=e,"firestore.googleapis.com"!==(e=(n=jp(n,zp)).V_()).host&&e.host!==r&&Or("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},Cv.prototype.enableNetwork=function(){return function(i){var t=this;return i._s.enqueue(function(){return y(t,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,ey(i)];case 1:return n=t.sent(),[4,ry(i)];case 2:return r=t.sent(),[2,(n.yo(!0),(e=r).Nh.delete(0),sl(e))]}var e})})})}(vy(jp(this.d_,py)))},Cv.prototype.disableNetwork=function(){return function(r){var t=this;return r._s.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ey(r)];case 1:return e=t.sent(),[4,ry(r)];case 2:return n=t.sent(),[2,(e.yo(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Nh.add(0),[4,ul(e)];case 1:return t.sent(),e.Oh.set("Offline"),[2]}})})}(n))]}})})})}(vy(jp(this.d_,py)))},Cv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Rp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},Cv.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},Cv.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},Cv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new ha;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Zl,[4,iy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(vy(jp(this.d_,py)))},Cv.prototype.onSnapshotsInSync=function(t){return e=this.d_,t=t,function(n,t){var e=this,r=new Np(t);return n._s.Ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Wh.add(e),e.next()},[4,oy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.i_(),n._s.Ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Wh.delete(e)},[4,oy(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(vy(jp(e,py)),hy(t)?t:{next:t});var e},Object.defineProperty(Cv.prototype,"app",{get:function(){if(!this.Pd)throw new Gr(Br.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),Cv.prototype.collection=function(t){try{return new ag(this,$p(this.d_,t))}catch(t){throw Kv(t,"collection()","Firestore.collection()")}},Cv.prototype.doc=function(t){try{return new Qv(this,td(this.d_,t))}catch(t){throw Kv(t,"doc()","Firestore.doc()")}},Cv.prototype.collectionGroup=function(t){try{return new og(this,function(t,e){if(t=jp(t,zp),Cp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Gr(Br.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Qp(t,null,(e=e,new qo(hi.ct(),e)))}(this.d_,t))}catch(t){throw Kv(t,"collectionGroup()","Firestore.collectionGroup()")}},Cv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new ha;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,ty(n).then(function(t){return t.Sh})];case 1:return e=t.sent(),new Qd(n._s,e,r,i).run(),[2]}})})}),i.promise}(vy(n=this.d_),function(t){return t=new wv(n,t),e(new jv(r,t))})},Cv.prototype.batch=function(){var e=this;return vy(this.d_),new Fv(new vv(this.d_,function(t){return dv(e.d_,t)}))},Cv.prototype.loadBundle=function(t){throw new Gr(Br.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Cv.prototype.namedQuery=function(t){throw new Gr(Br.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Cv),kv=(n(Pv,Nv=c),Pv.prototype.Wf=function(t){return new xv(new zr(t))},Pv.prototype.jf=function(t){t=this.Jf(t,this.firestore.I_);return Qv.yd(t,this.firestore,null)},Pv);function Pv(t){var e=this;return(e=Nv.call(this)||this).firestore=t,e}function Cv(t,e,n){var r=this;return(r=Av.call(this,e)||this).Rd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Tr||(r.Pd=t),r}function Lv(){}function Rv(){return null!==Sv&&Sv.apply(this,arguments)||this}var Vv,Mv,Uv,jv=(n(zv,Uv=Dp),zv.prototype.get=function(t){var e=this,n=yg(t);return this.d_.get(n).then(function(t){return new rg(e.Yf,new tv(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))})},zv.prototype.set=function(t,e,n){t=yg(t);return n?(Lp("Transaction.set",n),this.d_.set(t,e,n)):this.d_.set(t,e),this},zv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=yg(t);return 2===arguments.length?this.d_.update(o,e):(t=this.d_).update.apply(t,s([o,e,n],r)),this},zv.prototype.delete=function(t){t=yg(t);return this.d_.delete(t),this},zv),Fv=(n(Gv,Mv=Dp),Gv.prototype.set=function(t,e,n){t=yg(t);return n?(Lp("WriteBatch.set",n),this.d_.set(t,e,n)):this.d_.set(t,e),this},Gv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=yg(t);return 2===arguments.length?this.d_.update(o,e):(t=this.d_).update.apply(t,s([o,e,n],r)),this},Gv.prototype.delete=function(t){t=yg(t);return this.d_.delete(t),this},Gv.prototype.commit=function(){return this.d_.commit()},Gv),qv=(n(Bv,Vv=Dp),Bv.prototype.fromFirestore=function(t,e){t=new ev(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null);return this.d_.fromFirestore(new ig(this.Yf,t),null!=e?e:{})},Bv.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},Bv.gd=function(t,e){var n=Bv.Vd,r=n.get(t);r||(r=new WeakMap,n.set(t,r));n=r.get(e);return n||(n=new Bv(t,new kv(t),e),r.set(e,n)),n},Bv);function Bv(t,e,n){var r=this;return(r=Vv.call(this,n)||this).Yf=t,r.Xf=e,r}function Gv(){return null!==Mv&&Mv.apply(this,arguments)||this}function zv(t,e){var n=this;return(n=Uv.call(this,e)||this).Yf=t,n.Xf=new kv(t),n}qv.Vd=new WeakMap;var Hv,Qv=(n(Yv,Hv=Dp),Yv.pd=function(t,e,n){if(t.length%2!=0)throw new Gr(Br.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new Yv(e,new Hp(e.d_,n,new pi(t)))},Yv.yd=function(t,e,n){return new Yv(e,new Hp(e.d_,n,t))},Object.defineProperty(Yv.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Yv.prototype,"parent",{get:function(){return new ag(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Yv.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Yv.prototype.collection=function(t){try{return new ag(this.firestore,$p(this.d_,t))}catch(t){throw Kv(t,"collection()","DocumentReference.collection()")}},Yv.prototype.isEqual=function(t){return(t=t instanceof Dp?t.d_:t)instanceof Hp&&ed(this.d_,t)},Yv.prototype.set=function(t,e){e=Lp("DocumentReference.set",e);try{return function(t,e,n){t=jp(t,Hp);var r=jp(t.firestore,py),e=Ky(t.v_,e,n);return dv(r,[vd(yd(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,Ss.Kt())])}(this.d_,t,e)}catch(t){throw Kv(t,"setDoc()","DocumentReference.set()")}},Yv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?lv(this.d_,t):lv.apply(void 0,s([this.d_,t,e],n))}catch(t){throw Kv(t,"updateDoc()","DocumentReference.update()")}},Yv.prototype.delete=function(){return dv(jp((t=this.d_).firestore,py),[new Ys(t.S_,Ss.Kt())]);var t},Yv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Xv(t),i=Wv(t,function(t){return new rg(e.firestore,new tv(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))});return pv(this.d_,r,i)},Yv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=jp(e,Hp);var n=jp(e.firestore,py),t=vy(n),r=new hv(n);return function(n,r){var t=this,i=new ha;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Tc.Ho(t,e)}))];case 1:return(i=t.sent())instanceof $i?u.resolve(i):i instanceof to?u.resolve(null):u.reject(new Gr(Br.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=Da(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,ny(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new tv(n,r,e.S_,t,new $y(t instanceof $i&&t.Vt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=jp(e,Hp);var n=jp(e.firestore,py);return sy(vy(n),e.S_,{source:"server"}).then(function(t){return yv(n,e,t)})}:function(e){e=jp(e,Hp);var n=jp(e.firestore,py);return sy(vy(n),e.S_).then(function(t){return yv(n,e,t)})})(this.d_).then(function(t){return new rg(e.firestore,new tv(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))})},Yv.prototype.withConverter=function(t){return new Yv(this.firestore,t?this.d_.withConverter(qv.gd(this.firestore,t)):this.d_.withConverter(null))},Yv);function Yv(t,e){var n=this;return(n=Hv.call(this,e)||this).firestore=t,n.Xf=new kv(t),n}function Kv(t,e,n){return t.message=t.message.replace(e,n),t}function Xv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!hy(r))return r}return{}}function Wv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=hy(t[0])?t[0]:hy(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Jv,Zv,$v,tg,eg,ng,rg=(n(dg,ng=Dp),Object.defineProperty(dg.prototype,"ref",{get:function(){return new Qv(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(dg.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(dg.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(dg.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),dg.prototype.data=function(t){return this.d_.data(t)},dg.prototype.get=function(t,e){return this.d_.get(t,e)},dg.prototype.isEqual=function(t){return av(this.d_,t.d_)},dg),ig=(n(pg,eg=rg),pg.prototype.data=function(t){return this.d_.data(t)},pg),og=(n(lg,tg=Dp),lg.prototype.where=function(t,e,n){try{return new lg(this.firestore,xy(this.d_,(r=n,i=e,o=Ay("where",t),new Ly(o,i,r))))}catch(t){throw Kv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},lg.prototype.orderBy=function(t,e){try{return new lg(this.firestore,xy(this.d_,(n=void 0===e?"asc":e,r=Ay("orderBy",t),new Ry(r,n))))}catch(t){throw Kv(t,/(orderBy|where)\(\)/,"Query.$1()")}var n,r},lg.prototype.limit=function(t){try{return new lg(this.firestore,xy(this.d_,(Fp("limit",e=t),new Vy("limit",e,"F"))))}catch(t){throw Kv(t,"limit()","Query.limit()")}var e},lg.prototype.limitToLast=function(t){try{return new lg(this.firestore,xy(this.d_,(Fp("limitToLast",e=t),new Vy("limitToLast",e,"L"))))}catch(t){throw Kv(t,"limitToLast()","Query.limitToLast()")}var e},lg.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new lg(this.firestore,xy(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new My("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Kv(t,"startAt()","Query.startAt()")}},lg.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new lg(this.firestore,xy(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new My("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Kv(t,"startAfter()","Query.startAfter()")}},lg.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new lg(this.firestore,xy(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Uy("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Kv(t,"endBefore()","Query.endBefore()")}},lg.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new lg(this.firestore,xy(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Uy("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Kv(t,"endAt()","Query.endAt()")}},lg.prototype.isEqual=function(t){return nd(this.d_,t.d_)},lg.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=jp(e,Qp);var n=jp(e.firestore,py),t=vy(n),r=new hv(n);return function(n,r){var t=this,i=new ha;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,qh(i,o,!0)];case 1:return r=t.sent(),e=new ql(o,r.Rc),n=e.fl(r.documents),n=e.wi(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=Da(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,ny(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new nv(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=jp(e,Qp);var n=jp(e.firestore,py),t=vy(n),r=new hv(n);return uy(t,e.C_,{source:"server"}).then(function(t){return new nv(n,r,e,t)})}:function(e){e=jp(e,Qp);var n=jp(e.firestore,py),t=vy(n),r=new hv(n);return Sy(e.C_),uy(t,e.C_).then(function(t){return new nv(n,r,e,t)})})(this.d_).then(function(t){return new ug(e.firestore,new nv(e.firestore.d_,e.Xf,e.d_,t._d))})},lg.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Xv(t),i=Wv(t,function(t){return new ug(e.firestore,new nv(e.firestore.d_,e.Xf,e.d_,t._d))});return pv(this.d_,r,i)},lg.prototype.withConverter=function(t){return new lg(this.firestore,t?this.d_.withConverter(qv.gd(this.firestore,t)):this.d_.withConverter(null))},lg),sg=(n(fg,$v=Dp),Object.defineProperty(fg.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(fg.prototype,"doc",{get:function(){return new ig(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(fg.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(fg.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),fg),ug=(n(hg,Zv=Dp),Object.defineProperty(hg.prototype,"query",{get:function(){return new og(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(hg.prototype,"docs",{get:function(){var e=this;return this.d_.docs.map(function(t){return new ig(e.Yf,t)})},enumerable:!1,configurable:!0}),hg.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map(function(t){return new sg(e.Yf,t)})},hg.prototype.forEach=function(e,n){var r=this;this.d_.forEach(function(t){e.call(n,new ig(r.Yf,t))})},hg.prototype.isEqual=function(t){return av(this.d_,t.d_)},hg),ag=(n(cg,Jv=og),Object.defineProperty(cg.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(cg.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(cg.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new Qv(this.firestore,t):null},enumerable:!1,configurable:!0}),cg.prototype.doc=function(t){try{return new Qv(this.firestore,void 0===t?td(this.d_):td(this.d_,t))}catch(t){throw Kv(t,"doc()","CollectionReference.doc()")}},cg.prototype.add=function(t){var e,n,r,i=this;return e=this.d_,n=t,t=jp(e.firestore,py),r=td(e),n=Ky(e.v_,n),dv(t,[vd(yd(e.firestore),"addDoc",r.S_,n,null!==e.v_,{}).F_(r.S_,Ss.exists(!1))]).then(function(){return r}).then(function(t){return new Qv(i.firestore,t)})},cg.prototype.isEqual=function(t){return ed(this.d_,t.d_)},cg.prototype.withConverter=function(t){return new cg(this.firestore,t?this.d_.withConverter(qv.gd(this.firestore,t)):this.d_.withConverter(null))},cg);function cg(t,e){var n=this;return(n=Jv.call(this,t,e)||this).firestore=t,n.d_=e,n}function hg(t,e){var n=this;return(n=Zv.call(this,e)||this).Yf=t,n}function fg(t,e){var n=this;return(n=$v.call(this,e)||this).Yf=t,n}function lg(t,e){var n=this;return(n=tg.call(this,e)||this).firestore=t,n.Xf=new kv(t),n}function pg(){return null!==eg&&eg.apply(this,arguments)||this}function dg(t,e){var n=this;return(n=ng.call(this,e)||this).Yf=t,n}function yg(t){return jp(t=t instanceof Dp?t.d_:t,Hp)}var vg,gg,Ee=(n(bg,gg=Dp),bg.documentId=function(){return new bg(li.ht().rt())},bg.prototype.isEqual=function(t){return(t=t instanceof Dp?t.d_:t)instanceof Sp&&this.d_.f_.isEqual(t.f_)},bg),c=(n(mg,vg=Dp),mg.serverTimestamp=function(){var t=new Nd("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new mg(t)},mg.delete=function(){var t=new md("deleteField");return t._methodName="FieldValue.delete",new mg(t)},mg.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ad("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new mg(n)},mg.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sd("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new mg(n)},mg.increment=function(t){t=new xd("increment",t);return t._methodName="FieldValue.increment",new mg(t)},mg.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},mg);function mg(){return null!==vg&&vg.apply(this,arguments)||this}function bg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return gg.call(this,new(Sp.bind.apply(Sp,s([void 0],t))))||this}function wg(t){return e=this.d_,s=t,n=vy(e=jp(e,py)),t=new ly,function(n,t,r){var e,i=this,o=(e=s,t=zf(t),e=function(t){if(t instanceof Uint8Array)return Tp(t,void 0);if(t instanceof ArrayBuffer)return Tp(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new Ap(e,t));n._s.Ps(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=pp,[4,iy(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(n,e.I_,t),t;var e,s,n}function _g(t){var e=this,n=this.d_,t=t;return function(n,r){var t=this;return n._s.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.wo.Ms(t,e)})},[4,ny(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(vy(n=jp(n,py)),t).then(function(t){return t?new Qp(n,null,t.query):null}).then(function(t){return t?new og(e,t):null})}var Eg=(Ig.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ig.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ig.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ig);function Ig(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Tg,Ng,Ag={Firestore:Ov,GeoPoint:rd,Timestamp:ai,Blob:xv,Transaction:jv,WriteBatch:Fv,DocumentReference:Qv,DocumentSnapshot:rg,Query:og,QueryDocumentSnapshot:ig,QuerySnapshot:ug,CollectionReference:ag,FieldPath:Ee,FieldValue:c,setLogLevel:function(t){Nr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Tg=e.default).INTERNAL.registerComponent(new Eg("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Ov(e,new py(e,t),new Dv)},"PUBLIC").setServiceProps(Object.assign({},Ag))),Tg.registerVersion("@firebase/firestore","2.2.0"),(Ng=Ov).prototype.loadBundle=wg,Ng.prototype.namedQuery=_g}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
