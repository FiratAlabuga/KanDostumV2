!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Xd){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Xd),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}(_e=u=u||{})[_e.DEBUG=0]="DEBUG",_e[_e.VERBOSE=1]="VERBOSE",_e[_e.INFO=2]="INFO",_e[_e.WARN=3]="WARN",_e[_e.ERROR=4]="ERROR",_e[_e.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var o={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},a=u.INFO,c=((Ee={})[u.DEBUG]="log",Ee[u.VERBOSE]="log",Ee[u.INFO]="info",Ee[u.WARN]="warn",Ee[u.ERROR]="error",Ee),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=i,this._userLogHandler=null}function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var p,d="FirebaseError",g=(n(m,p=Error),m);function m(t,e,n){e=p.call(this,e)||this;return e.code=t,e.customData=n,e.name=d,Object.setPrototypeOf(e,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,w.prototype.create),e}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(_,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new g(o,t,i)},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var _=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var I,A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N={},S=A||self;function O(){}function D(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function C(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),P=0;function R(t,e,n){return t.call.apply(t.bind,arguments)}function k(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?R:k).apply(null,arguments)}function x(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function U(){return Date.now()}function M(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++P))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var W=S.navigator;if(W){W=W.userAgent;if(W){H=W;break t}}H=""}function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function tt(t){return tt[" "](t),t}tt[" "]=O;var et,nt=Q(H,"Opera"),rt=Q(H,"Trident")||Q(H,"MSIE"),it=Q(H,"Edge"),ot=it||rt,st=Q(H,"Gecko")&&!(Q(H.toLowerCase(),"webkit")&&!Q(H,"Edge"))&&!(Q(H,"Trident")||Q(H,"MSIE"))&&!Q(H,"Edge"),ut=Q(H.toLowerCase(),"webkit")&&!Q(H,"Edge");function at(){var t=S.document;return t?t.documentMode:void 0}t:{var ct="",ht=(ht=H,st?/rv:([^\);]+)(\)|;)/.exec(ht):it?/Edge\/([\d\.]+)/.exec(ht):rt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ht):ut?/WebKit\/(\S+)/.exec(ht):nt?/(?:Version)[ \/]?(\S+)/.exec(ht):void 0);if(ht&&(ct=ht?ht[1]:""),rt){ht=at();if(null!=ht&&ht>parseFloat(ct)){et=String(ht);break t}}et=ct}var ft={};function lt(u){return t=u,e=function(){for(var t=0,e=Y(String(et)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var pt=S.document&&rt&&(at()||parseInt(et,10))||void 0,dt=!rt||9<=Number(pt),yt=rt&&!lt("9"),vt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",O,e),S.removeEventListener("test",O,e)}catch(t){}return t}();function gt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function mt(t,e){if(gt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(st){t:{try{tt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:wt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}gt.prototype.b=function(){this.defaultPrevented=!0},M(mt,gt);var wt={2:"touch",3:"pen",4:"mouse"};mt.prototype.b=function(){mt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,yt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var bt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Et(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function Tt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function It(t){this.src=t,this.a={},this.b=0}function At(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Tt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Nt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}It.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Nt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Et(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),Ot={};function Dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Ut(r);return e&&e[bt]?e.wa(n,r,C(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Dt(t,e[o],n,r,i);return null}return n=Ut(n),t&&t[bt]?t.va(e,n,C(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=C(i)?!!i.capture:!!i;if(s&&!dt)return null;var u,a,c=Vt(t);if(c||(t[St]=c=new It(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=kt,r=a=dt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)void 0===(i=!vt?s:i)&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[bt]?At(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(At(n,t),0==n.b&&(n.src=null,e[St]=null)):Tt(t)))}function Pt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Rt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function kt(t,e){if(t.Y)return!0;if(dt)return Rt(t,new mt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Rt(t,e=new mt(e,this))}function Vt(t){return(t=t[St])instanceof It?t:null}var xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ut(e){return"function"==typeof e?e:(e[xt]||(e[xt]=function(t){return e.handleEvent(t)}),e[xt])}function Mt(){j.call(this),this.c=new It(this),(this.J=this).C=null}function jt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new gt(e,t):e instanceof gt?e.target=e.target||t:(s=e,$(e=new gt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&At(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Mt,j),Mt.prototype[bt]=!0,(I=Mt.prototype).addEventListener=function(t,e,n,r){Dt(this,t,e,n,r)},I.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=C(i)?!!i.capture:!!i,r=Ut(r),e&&e[bt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Nt(s=e.a[n],r,i,o))&&(Tt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],(r=(e=-1)<(e=n?Nt(n,r,i,o):e)?n[e]:null)&&Lt(r))}(this,t,e,n,r)},I.G=function(){if(Mt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Tt(n[r]);delete e.a[t],e.b--}}this.C=null},I.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},I.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=S.JSON.stringify;function Gt(){this.b=this.a=null}var Bt,zt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Yt},function(t){t.reset()}));function Ht(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Qt(t,e){var n;Bt||(n=S.Promise.resolve(void 0),Bt=function(){n.then(Kt)}),Xt||(Bt(),Xt=!0),Wt.add(t,e)}Gt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),Wt=new Gt;function Kt(){for(var t,e;n=e=void 0,n=null,(e=Wt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=zt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Jt(t,e){Mt.call(this),this.b=t||1,this.a=e||S,this.f=V(this.Za,this),this.g=U()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function $t(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}M(Jt,Mt),(I=Jt.prototype).aa=!1,I.M=null,I.Za=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),jt(this,"tick"),this.aa&&(Zt(this),this.start())))},I.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},I.G=function(){Jt.X.G.call(this),Zt(this),delete this.a};var te,ee,ne,re=(E(ee=oe,ne=te=j),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=$t(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e){var n=te.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function se(t){j.call(this),this.b=t,this.a={}}M(se,j);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){K(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function he(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.X.G.call(this),ce(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},he.prototype.info=function(){};var le={},pe=null;function de(){return pe=pe||new Mt}function ye(t){gt.call(this,le.Fa,t)}function ve(t){var e=de();jt(e,new ye(e))}function ge(t,e){gt.call(this,le.STAT_EVENT,t),this.stat=e}function me(t){var e=de();jt(e,new ge(e,t))}function we(t){gt.call(this,le.Ga,t)}function be(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}le.Fa="serverreachability",M(ye,gt),le.STAT_EVENT="statevent",M(ge,gt),le.Ga="timingevent",M(we,gt);var _e={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ee={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Te(){}function Ie(t){var e;return e=!(e=t.a)?t.a={}:e}function Ae(){}Te.prototype.a=null;var Ne,A={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Se(){gt.call(this,"d")}function Oe(){gt.call(this,"c")}function De(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new se(this),this.P=Le,t=ot?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Se,gt),M(Oe,gt),M(De,Te),Ne=new De;var Le=45e3,Pe={},Re={};function ke(t,e,n){t.H=1,t.i=en(We(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=U(),Ue(t),t.l=We(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(V(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Xa),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function xe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Re:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?Re:(u=u.substr(o,i),r.D=o+i,u)));if(u==Re){4==e&&(t.h=4,me(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,me(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0,me(11))):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),Fe(t))}function Ue(t){t.T=U()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(V(t.Va,t),e)}function je(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||rr(t.g,t)}function qe(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),Hn(u)}$n(u),me(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(V(u.Sa,u),6e3));if(_n(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Q(r,"spdy")||Q(r,"quic")||Q(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=U()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(In(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),Ue(o)),n.a=i):Zn(n),0<u.g.length&&Xn(u)):"stop"!=c[0]&&"close"!=c[0]||or(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?or(u,7):zn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);ve(4)}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(I=Ce.prototype).setTimeout=function(t){this.P=t},I.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},I.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ot&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),je(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,r=this.c,a=this.m,c=this.l,h=this.f,f=this.S,l=e,p=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+f+"]: "+a+"\n"+c+"\n"+l+" "+p}),this.b){if(this.U&&!this.C){e:{if(this.a){var s=this.a;if((s=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,me(12),qe(this),Fe(this);break t}fe(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,u)}this.I?(xe(this,e,o),ot&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Wa),this.R.start())):(fe(this.c,this.f,o,null),Ge(this,o)),4==e&&qe(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),qe(this),Fe(this)}}}catch(t){}var a,c,h,f,l,p},I.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(je(this),xe(this,t,e),this.b&&4!=t&&Ue(this)))},I.cancel=function(){this.A=!0,qe(this)},I.Va=function(){this.o=null;var t,e,n=U();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),qe(this),this.h=2,Fe(this)):Me(this,this.T-n)},(I=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},I.L=function(){return He(this),this.a.concat()},I.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},I.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},I.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Je(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),Ze(this,n[4]),this.g=nn(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function We(t){return new Xe(t)}function Ke(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,cn)),t.b=new fn(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),t=n?t.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){ln(t),e=vn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function dn(t,e){return ln(t),e=vn(t,e),Ye(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),B(n)),t.b+=n.length)}function vn(t,e){return e=String(e),e=t.f?e.toLowerCase():e}(I=fn.prototype).add=function(t,e){ln(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},I.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},I.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},I.K=function(t){ln(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=G(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},I.set=function(t,e){return ln(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},I.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},I.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var gn=function(t,e){this.b=t,this.a=e};function mn(t){this.g=t||wn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function _n(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function In(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Sn(){this.a=new Nn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Dn=S.JSON.parse;function Cn(t){Mt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}M(Cn,Mt);var Ln="",Pn=/^https?$/i,Rn=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,xn(t),Mn(t)}function xn(t){t.u||(t.u=!0,jt(t,"complete"),jt(t,"error"))}function Un(t){if(t.b&&void 0!==N&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))$t(t.za,0,t);else if(jt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n);if(e)jt(t,"complete"),jt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",xn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||jt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",K(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new he,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Gn("baseRetryDelayMs",5e3,t),this.Ra=Gn("retryDelaySeedMs",1e4,t),this.Ma=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function zn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,tn(n=We(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Kn(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=en(We(n)),n=!1,!(n=S.navigator&&S.navigator.sendBeacon?S.navigator.sendBeacon(e.i.toString(),""):n)&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=U(),Ue(e)),sr(t)}function Hn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Yn(t){Hn(t),t.j&&(S.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new gn(t.Oa++,e)),3==t.v&&Xn(t)}function Xn(t){bn(t.b)||t.h||(t.h=!0,Qt(t.Ba,t),t.u=0)}function Wn(t,e){var n=e?e.f:t.R++,r=We(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Kn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),ke(n,r,e)}function Kn(t,n){t.f&&Be({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Be(t,function(t,e){var n=t;C(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Qt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=be(V(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function er(t){t.a=new Ce(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=We(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Kn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(We(e)),n.j=null,n.I=!0,Ve(n,t)}function nr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r,i,o=null;if(t.a==e){nr(t),tr(t),t.a=null;var s=2}else{if(!En(t.b,e))return;o=e.s,In(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=U()-e.u,n=t.u,jt(s=de(),new we(s)),Xn(t)):Zn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,_n((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=be(V(r.Ba,r,i),ir(r,r.u)),r.u++,0))))&&(2!=s||!$n(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Ke(r,"https"),en(r)),n=r.toString(),r=o,o=new he,S.Image?((i=new Image).onload=x(On,o,i,"TestLoadImage: loaded",!0,r),i.onerror=x(On,o,i,"TestLoadImage: error",!1,r),i.onabort=x(On,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=x(On,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Yn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?We(s):new Xe(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),Ze(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Ke(u,r),i&&Je(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&K(t.V,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Kn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Na)).F=t.C,e}function cr(){}function hr(){if(rt&&!(10<=Number(pt)))throw Error("Environmental error: no available transport.")}function fr(t,e){Mt.call(this),this.a=new Bn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function lr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){Oe.call(this),this.status=1}function dr(t){this.a=t}(I=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ie(this.H):Ie(Ne),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Rn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,rt&&lt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=$t(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},I.xa=function(){void 0!==N&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,jt(this,"timeout"),this.abort(8))},I.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,jt(this,"complete"),jt(this,"abort"),Mn(this))},I.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Cn.X.G.call(this)},I.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Ua())},I.Ua=function(){Un(this)},I.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},I.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},I.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},I.ua=function(){return this.h},I.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(I=Bn.prototype).ha=8,I.v=1,I.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?$(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=We(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&qn(i,this.i,r),Tn(this.b,n),this.Ia&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.U=!0,ke(n,i,null)):ke(n,i,e),this.v=2}}else 3==this.v&&(t?Wn(this,t):0==this.g.length||bn(this.b)||Wn(this))},I.Aa=function(){var t;this.j=null,er(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(V(this.Ta,this),t))},I.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,me(10),Hn(this),er(this))},I.Sa=function(){null!=this.m&&(this.m=null,Hn(this),$n(this),me(19))},I.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(I=cr.prototype).ta=function(){},I.sa=function(){},I.ra=function(){},I.qa=function(){},I.Ja=function(){},hr.prototype.a=function(t,e){return new fr(t,e)},M(fr,Mt),fr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;me(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ur(t,null,t.fa),Xn(t)},fr.prototype.close=function(){zn(this.a)},fr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.l?((e={}).__data__=qt(t),Qn(this.a,e)):Qn(this.a,t)},fr.prototype.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,fr.X.G.call(this)},M(lr,Se),M(pr,Oe),M(dr,cr),dr.prototype.ta=function(){jt(this.a,"a")},dr.prototype.sa=function(t){jt(this.a,new lr(t))},dr.prototype.ra=function(t){jt(this.a,new pr)},dr.prototype.qa=function(){jt(this.a,"b")},hr.prototype.createWebChannel=hr.prototype.a,fr.prototype.send=fr.prototype.h,fr.prototype.open=fr.prototype.g,_e.NO_ERROR=0,_e.TIMEOUT=8,_e.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",Mt.prototype.listen=Mt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.W,Cn.prototype.getResponseJson=Cn.prototype.Pa,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var yr=de,vr=_e,gr=Ee,mr=le,wr=10,br=11,_r=Ae,Er=Cn,Tr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Ir=(Object.defineProperty(Nr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Nr.prototype.isEqual=function(t){return t instanceof Nr&&t.projectId===this.projectId&&t.database===this.database},Nr),Ar=new h("@firebase/firestore");function Nr(t,e){this.projectId=t,this.database=e||"(default)"}function Sr(){return Ar.logLevel}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.DEBUG&&(e=n.map(Lr),Ar.debug.apply(Ar,s(["Firestore (8.3.0): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.ERROR&&(e=n.map(Lr),Ar.error.apply(Ar,s(["Firestore (8.3.0): "+t],e)))}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.WARN&&(e=n.map(Lr),Ar.warn.apply(Ar,s(["Firestore (8.3.0): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){t="FIRESTORE (8.3.0) INTERNAL ASSERTION FAILED: "+(t=void 0===t?"Unexpected state":t);throw Dr(t),new Error(t)}function Rr(t){t||Pr()}var kr=(Vr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Vr);function Vr(){}function xr(t,e){return t<e?-1:e<t?1:0}function Ur(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Mr=(jr.fromBase64String=function(t){return new jr(atob(t))},jr.fromUint8Array=function(t){return new jr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},jr.prototype.toBase64=function(){return t=this.h,btoa(t);var t},jr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},jr.prototype.l=function(){return 2*this.h.length},jr.prototype._=function(t){return xr(this.h,t.h)},jr.prototype.isEqual=function(t){return this.h===t.h},jr);function jr(t){this.h=t}Mr.T=new Mr("");var Fr,qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Gr=(n(Qr,Fr=Error),Qr),Br=(Yr.fromBase64String=function(t){try{return new Yr(Mr.fromBase64String(t))}catch(t){throw new Gr(qr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Yr.fromUint8Array=function(t){return new Yr(Mr.fromUint8Array(t))},Yr.prototype.toBase64=function(){return this.I.toBase64()},Yr.prototype.toUint8Array=function(){return this.I.toUint8Array()},Yr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Yr.prototype.isEqual=function(t){return this.I.isEqual(t.I)},Yr),zr=(Hr.prototype.m=function(){return null!=this.uid},Hr.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},Hr.prototype.isEqual=function(t){return t.uid===this.uid},Hr);function Hr(t){this.uid=t}function Yr(t){this.I=t}function Qr(t,e){var n=this;return(n=Fr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}zr.UNAUTHENTICATED=new zr(null),zr.R=new zr("google-credentials-uid"),zr.P=new zr("first-party-uid");function Xr(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t}var Wr=(ii.prototype.getToken=function(){return Promise.resolve(null)},ii.prototype.p=function(){},ii.prototype.v=function(t){(this.V=t)(zr.UNAUTHENTICATED)},ii.prototype.S=function(){this.V=null},ii),Kr=(ri.prototype.getToken=function(){var e=this,n=this.N,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.N!==n?(Or("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Rr("string"==typeof t.accessToken),new Xr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},ri.prototype.p=function(){this.forceRefresh=!0},ri.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},ri.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},ri.prototype.$=function(){var t=this.auth&&this.auth.getUid();return Rr(null===t||"string"==typeof t),new zr(t)},ri),Jr=(Object.defineProperty(ni.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.O},e=this.F.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ni),Zr=(ei.prototype.getToken=function(){return Promise.resolve(new Jr(this.F,this.O))},ei.prototype.v=function(t){t(zr.P)},ei.prototype.S=function(){},ei.prototype.p=function(){},ei),$r=(ti.prototype.M=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ti.prototype.next=function(){var t=++this.previousValue;return this.L&&this.L(t),t},ti);function ti(t,e){var n=this;this.previousValue=t,e&&(e.k=function(t){return n.M(t)},this.L=function(t){return e.B(t)})}function ei(t,e){this.F=t,this.O=e}function ni(t,e){this.F=t,this.O=e,this.type="FirstParty",this.user=zr.P}function ri(t){var e=this;this.D=null,this.currentUser=zr.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.$(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then(function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)},function(){}))}function ii(){this.V=null}$r.q=-1;var oi,si,ui=(mi.now=function(){return mi.fromMillis(Date.now())},mi.fromDate=function(t){return mi.fromMillis(t.getTime())},mi.fromMillis=function(t){var e=Math.floor(t/1e3);return new mi(e,1e6*(t-1e3*e))},mi.prototype.toDate=function(){return new Date(this.toMillis())},mi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},mi.prototype.U=function(t){return this.seconds===t.seconds?xr(this.nanoseconds,t.nanoseconds):xr(this.seconds,t.seconds)},mi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},mi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},mi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},mi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},mi),ai=(gi.K=function(t){return new gi(t)},gi.min=function(){return new gi(new ui(0,0))},gi.prototype._=function(t){return this.timestamp.U(t.timestamp)},gi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},gi.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},gi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},gi.prototype.j=function(){return this.timestamp},gi),Ee=(Object.defineProperty(vi.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),vi.prototype.isEqual=function(t){return 0===vi.H(this,t)},vi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof vi?t.forEach(function(t){e.push(t)}):e.push(t),this.J(e)},vi.prototype.limit=function(){return this.offset+this.length},vi.prototype.Y=function(t){return t=void 0===t?1:t,this.J(this.segments,this.offset+t,this.length-t)},vi.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},vi.prototype.Z=function(){return this.segments[this.offset]},vi.prototype.tt=function(){return this.get(this.length-1)},vi.prototype.get=function(t){return this.segments[this.offset+t]},vi.prototype.et=function(){return 0===this.length},vi.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},vi.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},vi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},vi.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},vi.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},vi),ci=(n(yi,si=Ee),yi.prototype.J=function(t,e,n){return new yi(t,e,n)},yi.prototype.rt=function(){return this.it().join("/")},yi.prototype.toString=function(){return this.rt()},yi.ot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Gr(qr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new yi(n)},yi.ct=function(){return new yi([])},yi),hi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,fi=(n(di,oi=Ee),di.prototype.J=function(t,e,n){return new di(t,e,n)},di.at=function(t){return hi.test(t)},di.prototype.rt=function(){return this.it().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t=!di.at(t)?"`"+t+"`":t}).join(".")},di.prototype.toString=function(){return this.rt()},di.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},di.ht=function(){return new di(["__name__"])},di.lt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Gr(qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Gr(qr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Gr(qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Gr(qr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new di(e)},di.ct=function(){return new di([])},di),li=(pi._t=function(t){return new pi(ci.ot(t))},pi.ft=function(t){return new pi(ci.ot(t).Y(5))},pi.prototype.dt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},pi.prototype.isEqual=function(t){return null!==t&&0===ci.H(this.path,t.path)},pi.prototype.toString=function(){return this.path.toString()},pi.H=function(t,e){return ci.H(t.path,e.path)},pi.wt=function(t){return t.length%2==0},pi.Et=function(t){return new pi(new ci(t.slice()))},pi);function pi(t){this.path=t}function di(){return null!==oi&&oi.apply(this,arguments)||this}function yi(){return null!==si&&si.apply(this,arguments)||this}function vi(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.G=n}function gi(t){this.timestamp=t}function mi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Gr(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Gr(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Gr(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Gr(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function wi(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function bi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function _i(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ei=(Ii.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},Ii.prototype.isEqual=function(t){return Ur(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ii),Ti=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ii(t){(this.fields=t).sort(fi.H)}function Ai(t){if(Rr(!!t),"string"!=typeof t)return{seconds:Ni(t.seconds),nanos:Ni(t.nanos)};var e=0,n=Ti.exec(t);Rr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Ni(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Si(t){return"string"==typeof t?Mr.fromBase64String(t):Mr.fromUint8Array(t)}function Oi(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Di(t){t=Ai(t.mapValue.fields.__local_write_time__.timestampValue);return new ui(t.seconds,t.nanos)}function Ci(t){return null==t}function Li(t){return 0===t&&1/t==-1/0}function Pi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Oi(t)?4:10:Pr()}function Ri(r,i){var t,e,n=Pi(r);if(n!==Pi(i))return!1;switch(n){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Di(r).isEqual(Di(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ai(r.timestampValue),t=Ai(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return e=i,Si(r.bytesValue).isEqual(Si(e.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return t=i,Ni((e=r).geoPointValue.latitude)===Ni(t.geoPointValue.latitude)&&Ni(e.geoPointValue.longitude)===Ni(t.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ni(t.integerValue)===Ni(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Ni(t.doubleValue),e=Ni(e.doubleValue);return t===e?Li(t)===Li(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Ur(r.arrayValue.values||[],i.arrayValue.values||[],Ri);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(wi(e)!==wi(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Ri(e[t],n[t])))return!1;return!0}();default:return Pr()}}function ki(t,e){return void 0!==(t.values||[]).find(function(t){return Ri(t,e)})}function Vi(t,e){var n,r,i,o=Pi(t),s=Pi(e);if(o!==s)return xr(o,s);switch(o){case 0:return 0;case 1:return xr(t.booleanValue,e.booleanValue);case 2:return r=e,i=Ni(t.integerValue||t.doubleValue),r=Ni(r.integerValue||r.doubleValue),i<r?-1:r<i?1:i===r?0:isNaN(i)?isNaN(r)?0:-1:1;case 3:return xi(t.timestampValue,e.timestampValue);case 4:return xi(Di(t),Di(e));case 5:return xr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Si(t),e=Si(e);return t._(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=xr(n[i],r[i]);if(0!==o)return o}return xr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=xr(Ni(n.latitude),Ni(i.latitude)))?r:xr(Ni(n.longitude),Ni(i.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Vi(n[i],r[i]);if(o)return o}return xr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=xr(r[s],o[s]);if(0!==u)return u;u=Vi(n[r[s]],i[o[s]]);if(0!==u)return u}return xr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function xi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return xr(t,e);var n=Ai(t),t=Ai(e),e=xr(n.seconds,t.seconds);return 0!==e?e:xr(n.nanos,t.nanos)}function Ui(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Ai(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Si(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,li.ft(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Pr();var e}(t)}function Mi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function ji(t){return t&&"integerValue"in t}function Fi(t){return!!t&&"arrayValue"in t}function qi(t){return t&&"nullValue"in t}function Gi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Bi(t){return t&&"mapValue"in t}var zi=(Qi.empty=function(){return new Qi({mapValue:{}})},Qi.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Bi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},Qi.prototype.isEqual=function(t){return Ri(this.proto,t.proto)},Qi),Hi=(Yi.prototype.set=function(t,e){return this.Rt(t,e),this},Yi.prototype.delete=function(t){return this.Rt(t,null),this},Yi.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Pi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.tt(),e)},Yi.prototype.Pt=function(){var t=this.yt(fi.ct(),this.At);return null!=t?new zi(t):this.It},Yi.prototype.yt=function(r,t){var i=this,o=!1,e=this.It.field(r),s=Bi(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.yt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Yi);function Yi(t){void 0===t&&(t=zi.empty()),this.It=t,this.At=new Map}function Qi(t){this.proto=t}var Xi,Wi,Ki,h=function(t,e){this.key=t,this.version=e},Ji=(n(ro,Ki=h),ro.prototype.field=function(t){return this.gt.field(t)},ro.prototype.data=function(){return this.gt},ro.prototype.bt=function(){return this.gt.proto},ro.prototype.isEqual=function(t){return t instanceof ro&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},ro.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ro.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ro),Zi=(n(no,Wi=h),no.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(no.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),no.prototype.isEqual=function(t){return t instanceof no&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},no),$i=(n(eo,Xi=h),eo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(eo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),eo.prototype.isEqual=function(t){return t instanceof eo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},eo),to=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function eo(){return null!==Xi&&Xi.apply(this,arguments)||this}function no(t,e,n){var r=this;return(r=Wi.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function ro(t,e,n,r){var i=this;return(i=Ki.call(this,t,e)||this).gt=n,i.Vt=!!r.Vt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function io(t,e,n,r,i,o,s){return new to(t,e=void 0===e?null:e,n=void 0===n?[]:n,r=void 0===r?[]:r,i=void 0===i?null:i,o=void 0===o?null:o,s=void 0===s?null:s)}function oo(t){var e=t;return null===e.vt&&(t=e.path.rt(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.rt()+t.op.toString()+Ui(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.rt()+t.dir}).join(","),Ci(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Vo(e.startAt)),e.endAt&&(t+="|ub:",t+=Vo(e.endAt)),e.vt=t),e.vt}function so(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Ri(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Mo(t.startAt,e.startAt)&&Mo(t.endAt,e.endAt)}function uo(t){return li.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var ao,co=(n(ho,ao=function(){}),ho.create=function(t,e,n){return t.ut()?"in"===e||"not-in"===e?this.St(t,e,n):new yo(t,e,n):"array-contains"===e?new No(t,n):"in"===e?new So(t,n):"not-in"===e?new Oo(t,n):"array-contains-any"===e?new Do(t,n):new ho(t,e,n)},ho.St=function(t,e,n){return new("in"===e?vo:go)(t,n)},ho.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Dt(Vi(t,this.value)):null!==t&&Pi(this.value)===Pi(t)&&this.Dt(Vi(t,this.value))},ho.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},ho.prototype.Ct=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ho);function ho(t,e,n){var r=this;return(r=ao.call(this)||this).field=t,r.op=e,r.value=n,r}var fo,lo,po,yo=(n(bo,po=co),bo.prototype.matches=function(t){t=li.H(t.key,this.key);return this.Dt(t)},bo),vo=(n(wo,lo=co),wo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},wo),go=(n(mo,fo=co),mo.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},mo);function mo(t,e){var n=this;return(n=fo.call(this,t,"not-in",e)||this).keys=_o(0,e),n}function wo(t,e){var n=this;return(n=lo.call(this,t,"in",e)||this).keys=_o(0,e),n}function bo(t,e,n){var r=this;return(r=po.call(this,t,e,n)||this).key=li.ft(n.referenceValue),r}function _o(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return li.ft(t.referenceValue)})}var Eo,To,Io,Ao,No=(n(ko,Ao=co),ko.prototype.matches=function(t){t=t.field(this.field);return Fi(t)&&ki(t.arrayValue,this.value)},ko),So=(n(Ro,Io=co),Ro.prototype.matches=function(t){t=t.field(this.field);return null!==t&&ki(this.value.arrayValue,t)},Ro),Oo=(n(Po,To=co),Po.prototype.matches=function(t){if(ki(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!ki(this.value.arrayValue,t)},Po),Do=(n(Lo,Eo=co),Lo.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Fi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return ki(e.value.arrayValue,t)})},Lo),Co=function(t,e){this.position=t,this.before=e};function Lo(t,e){return Eo.call(this,t,"array-contains-any",e)||this}function Po(t,e){return To.call(this,t,"not-in",e)||this}function Ro(t,e){return Io.call(this,t,"in",e)||this}function ko(t,e){return Ao.call(this,t,"array-contains",e)||this}function Vo(t){return(t.before?"b":"a")+":"+t.position.map(Ui).join(",")}var xo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Uo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ut()?li.H(li.ft(s.referenceValue),n.key):Vi(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Mo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ri(t.position[n],e.position[n]))return!1;return!0}var jo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Nt=null,this.$t=null,this.startAt,this.endAt};function Fo(t){return new jo(t)}function qo(t){return!Ci(t.limit)&&"F"===t.limitType}function Go(t){return!Ci(t.limit)&&"L"===t.limitType}function Bo(t){return 0<t.xt.length?t.xt[0].field:null}function zo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function Ho(t){return null!==t.collectionGroup}function Yo(t){var e=t;if(null===e.Nt){e.Nt=[];var n=zo(e),t=Bo(e);if(null!==n&&null===t)n.ut()||e.Nt.push(new xo(n)),e.Nt.push(new xo(fi.ht(),"asc"));else{for(var r=!1,i=0,o=e.xt;i<o.length;i++){var s=o[i];e.Nt.push(s),s.field.ut()&&(r=!0)}r||(n=0<e.xt.length?e.xt[e.xt.length-1].dir:"asc",e.Nt.push(new xo(fi.ht(),n)))}}return e.Nt}function Qo(t){var e=t;if(!e.$t)if("F"===e.limitType)e.$t=io(e.path,e.collectionGroup,Yo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Yo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new xo(o.field,s))}var u=e.endAt?new Co(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Co(e.startAt.position,!e.startAt.before):null;e.$t=io(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.$t}function Xo(t,e,n){return new jo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Wo(t,e){return so(Qo(t),Qo(e))&&t.limitType===e.limitType}function Ko(t){return oo(Qo(t))+"|lt:"+t.limitType}function Jo(t){return"Query(target="+(e=Qo(t),n=e.path.rt(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.rt()+" "+t.op+" "+Ui(t.value)}).join(", ")+"]"),Ci(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.rt()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Vo(e.startAt)),e.endAt&&(n+=", endAt: "+Vo(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Zo(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.dt(e.collectionGroup)&&e.path.nt(n):li.wt(e.path)?e.path.isEqual(n):e.path.st(n))&&function(t){for(var e=0,n=i.xt;e<n.length;e++){var r=n[e];if(!r.field.ut()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Uo(t.startAt,Yo(t),n))&&(!t.endAt||!Uo(t.endAt,Yo(t),n)));var e,n}function $o(u){return function(t,e){for(var n=!1,r=0,i=Yo(u);r<i.length;r++){var o=i[r],s=function(t,r,e){var n=t.field.ut()?li.H(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Vi(n,t):Pr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.ut()}return 0}}var ts=(es.prototype.kt=function(t){return new es(this.target,this.targetId,this.Ft,t,this.Ot,this.lastLimboFreeSnapshotVersion,this.resumeToken)},es.prototype.Mt=function(t,e){return new es(this.target,this.targetId,this.Ft,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},es.prototype.Lt=function(t){return new es(this.target,this.targetId,this.Ft,this.sequenceNumber,this.Ot,t,this.resumeToken)},es);function es(t,e,n,r,i,o,s){void 0===i&&(i=ai.min()),void 0===o&&(o=ai.min()),void 0===s&&(s=Mr.T),this.target=t,this.targetId=e,this.Ft=n,this.sequenceNumber=r,this.Ot=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function ns(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Li(e)?"-0":e}}function rs(t){return{integerValue:""+t}}function is(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Li(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?rs(e):ns(t,e);var n}Ee=function(){this.qt=void 0};function os(t,e){return t instanceof ms?ji(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ss,us,as=(n(fs,us=Ee),fs),cs=(n(hs,ss=Ee),hs);function hs(t){var e=this;return(e=ss.call(this)||this).elements=t,e}function fs(){return null!==us&&us.apply(this,arguments)||this}function ls(t,e){for(var n=_s(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Ri(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ps,ds=(n(ys,ps=Ee),ys);function ys(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function vs(t,e){for(var n=_s(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Ri(t,e)})}(i[r]);return{arrayValue:{values:n}}}var gs,ms=(n(ws,gs=Ee),ws);function ws(t,e){var n=this;return(n=gs.call(this)||this).Qt=t,n.Ut=e,n}function bs(t){return Ni(t.integerValue||t.doubleValue)}function _s(t){return Fi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Es(t,e){this.field=t,this.transform=e}function Ts(t,e){this.version=t,this.transformResults=e}var Is=(As.Kt=function(){return new As},As.exists=function(t){return new As(void 0,t)},As.updateTime=function(t){return new As(t)},Object.defineProperty(As.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),As.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},As);function As(t,e){this.updateTime=t,this.exists=e}function Ns(t,e){return void 0!==t.updateTime?e instanceof Ji&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ji}h=function(){};function Ss(t,e,n){return t instanceof Ps?function(t,e,n){if(!Ns(t.jt,e))return e;var r=t.value,n=Ms(t.fieldTransforms,n,e),r=js(t.fieldTransforms,r,n),e=Ds(e);return new Ji(t.key,e,r,{Vt:!0})}(t,e,n):t instanceof Rs?function(t,e,n){if(!Ns(t.jt,e))return e;var r=Ds(e),e=xs(t,e,Ms(t.fieldTransforms,n,e));return new Ji(t.key,r,e,{Vt:!0})}(t,e,n):(e=e,Ns((t=t).jt,e)?new Zi(t.key,ai.min()):e)}function Os(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Ur(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof cs&&e instanceof cs||t instanceof ds&&e instanceof ds?Ur(t.elements,e.elements,Ri):t instanceof ms&&e instanceof ms?Ri(t.Ut,e.Ut):t instanceof as&&e instanceof as)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt));var n,r}function Ds(t){return t instanceof Ji?t.version:ai.min()}var Cs,Ls,Ps=(n(Vs,Ls=h),Vs),Rs=(n(ks,Cs=h),ks);function ks(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Cs.call(this)||this).key=t,o.data=e,o.Gt=n,o.jt=r,o.fieldTransforms=i,o.type=1,o}function Vs(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Ls.call(this)||this).key=t,i.value=e,i.jt=n,i.fieldTransforms=r,i.type=0,i}function xs(t,e,n){var r,i,o;return i=t,e=r=e instanceof Ji?e.data():zi.empty(),o=new Hi(e),i.Gt.fields.forEach(function(t){var e;t.et()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o.Pt(),js(t.fieldTransforms,r,n)}function Us(t,e,n){var r=[];Rr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Ji&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof cs?ls(o,s):o instanceof ds?vs(o,s):u))}return r}function Ms(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Ji&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,(a=a)instanceof as?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof cs?ls(a,r):a instanceof ds?vs(a,r):(a=os(c=a,r),r=bs(a)+bs(c.Ut),ji(a)&&ji(c.Ut)?rs(r):ns(c.Qt,r))))}return i}function js(t,e,n){for(var r=new Hi(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Pt()}function Fs(t){this.count=t}var qs,Gs,Bs,zs=(n(Qs,Bs=h),Qs),Hs=(n(Ys,Gs=h),Ys);function Ys(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.jt=e,n.type=3,n.fieldTransforms=[],n}function Qs(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.jt=e,n.type=2,n.fieldTransforms=[],n}function Xs(t){switch(t){case qr.OK:return Pr(),0;case qr.CANCELLED:case qr.UNKNOWN:case qr.DEADLINE_EXCEEDED:case qr.RESOURCE_EXHAUSTED:case qr.INTERNAL:case qr.UNAVAILABLE:case qr.UNAUTHENTICATED:return;case qr.INVALID_ARGUMENT:case qr.NOT_FOUND:case qr.ALREADY_EXISTS:case qr.PERMISSION_DENIED:case qr.FAILED_PRECONDITION:case qr.ABORTED:case qr.OUT_OF_RANGE:case qr.UNIMPLEMENTED:case qr.DATA_LOSS:return 1;default:return Pr(),0}}function Ws(t){if(void 0===t)return Dr("GRPC error has no .code"),qr.UNKNOWN;switch(t){case qs.OK:return qr.OK;case qs.CANCELLED:return qr.CANCELLED;case qs.UNKNOWN:return qr.UNKNOWN;case qs.DEADLINE_EXCEEDED:return qr.DEADLINE_EXCEEDED;case qs.RESOURCE_EXHAUSTED:return qr.RESOURCE_EXHAUSTED;case qs.INTERNAL:return qr.INTERNAL;case qs.UNAVAILABLE:return qr.UNAVAILABLE;case qs.UNAUTHENTICATED:return qr.UNAUTHENTICATED;case qs.INVALID_ARGUMENT:return qr.INVALID_ARGUMENT;case qs.NOT_FOUND:return qr.NOT_FOUND;case qs.ALREADY_EXISTS:return qr.ALREADY_EXISTS;case qs.PERMISSION_DENIED:return qr.PERMISSION_DENIED;case qs.FAILED_PRECONDITION:return qr.FAILED_PRECONDITION;case qs.ABORTED:return qr.ABORTED;case qs.OUT_OF_RANGE:return qr.OUT_OF_RANGE;case qs.UNIMPLEMENTED:return qr.UNIMPLEMENTED;case qs.DATA_LOSS:return qr.DATA_LOSS;default:return Pr()}}(Ee=qs=qs||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var Ks=(eu.prototype.zt=function(t,e){return new eu(this.H,this.root.zt(t,e,this.H).copy(null,null,Zs.Ht,null,null))},eu.prototype.remove=function(t){return new eu(this.H,this.root.remove(t,this.H).copy(null,null,Zs.Ht,null,null))},eu.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},eu.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},eu.prototype.et=function(){return this.root.et()},Object.defineProperty(eu.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),eu.prototype.Jt=function(){return this.root.Jt()},eu.prototype.Yt=function(){return this.root.Yt()},eu.prototype.Xt=function(t){return this.root.Xt(t)},eu.prototype.forEach=function(n){this.Xt(function(t,e){return n(t,e),!1})},eu.prototype.toString=function(){var n=[];return this.Xt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},eu.prototype.Zt=function(t){return this.root.Zt(t)},eu.prototype.te=function(){return new Js(this.root,null,this.H,!1)},eu.prototype.ee=function(t){return new Js(this.root,t,this.H,!1)},eu.prototype.ne=function(){return new Js(this.root,null,this.H,!0)},eu.prototype.se=function(t){return new Js(this.root,t,this.H,!0)},eu),Js=(tu.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},tu.prototype.ce=function(){return 0<this.re.length},tu.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},tu),Zs=($s.prototype.copy=function(t,e,n,r,i){return new $s(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},$s.prototype.et=function(){return!1},$s.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},$s.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},$s.prototype.min=function(){return this.left.et()?this:this.left.min()},$s.prototype.Jt=function(){return this.min().key},$s.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},$s.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},$s.prototype.he=function(){if(this.left.et())return $s.EMPTY;var t=this;return(t=(t=!t.left.le()&&!t.left.left.le()?t._e():t).copy(null,null,null,t.left.he(),null)).ue()},$s.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r=(r=!(r.left.et()||r.left.le()||r.left.left.le())?r._e():r).copy(null,null,null,r.left.remove(t,e),null);else{if(0===e(t,(r=!((r=r.left.le()?r.fe():r).right.et()||r.right.le()||r.right.left.le())?r.de():r).key)){if(r.right.et())return $s.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.he())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.ue()},$s.prototype.le=function(){return this.color},$s.prototype.ue=function(){var t=this;return t=(t=(t=t.right.le()&&!t.left.le()?t.we():t).left.le()&&t.left.left.le()?t.fe():t).left.le()&&t.right.le()?t.Ee():t},$s.prototype._e=function(){var t=this.Ee();return t=t.right.left.le()?(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee():t},$s.prototype.de=function(){var t=this.Ee();return t=t.left.left.le()?(t=t.fe()).Ee():t},$s.prototype.we=function(){var t=this.copy(null,null,$s.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},$s.prototype.fe=function(){var t=this.copy(null,null,$s.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},$s.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},$s.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},$s.prototype.Ie=function(){if(this.le()&&this.left.le())throw Pr();if(this.right.le())throw Pr();var t=this.left.Ie();if(t!==this.right.Ie())throw Pr();return t+(this.le()?0:1)},$s);function $s(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:$s.RED,this.left=null!=r?r:$s.EMPTY,this.right=null!=i?i:$s.EMPTY,this.size=this.left.size+1+this.right.size}function tu(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}function eu(t,e){this.H=t,this.root=e||Zs.EMPTY}function nu(){this.size=0}Zs.EMPTY=null,Zs.RED=!0,Zs.Ht=!1,Zs.EMPTY=(Object.defineProperty(nu.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(nu.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(nu.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(nu.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(nu.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),nu.prototype.copy=function(t,e,n,r,i){return this},nu.prototype.zt=function(t,e,n){return new Zs(t,e)},nu.prototype.remove=function(t,e){return this},nu.prototype.et=function(){return!0},nu.prototype.Xt=function(t){return!1},nu.prototype.Zt=function(t){return!1},nu.prototype.Jt=function(){return null},nu.prototype.Yt=function(){return null},nu.prototype.le=function(){return!1},nu.prototype.Te=function(){return!0},nu.prototype.Ie=function(){return 0},new nu);var ru=(uu.prototype.has=function(t){return null!==this.data.get(t)},uu.prototype.first=function(){return this.data.Jt()},uu.prototype.last=function(){return this.data.Yt()},Object.defineProperty(uu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),uu.prototype.indexOf=function(t){return this.data.indexOf(t)},uu.prototype.forEach=function(n){this.data.Xt(function(t,e){return n(t),!1})},uu.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(0<=this.H(r.key,t[1]))return;e(r.key)}},uu.prototype.Ae=function(t,e){for(var n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},uu.prototype.Re=function(t){t=this.data.ee(t);return t.ce()?t.oe().key:null},uu.prototype.te=function(){return new iu(this.data.te())},uu.prototype.ee=function(t){return new iu(this.data.ee(t))},uu.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},uu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},uu.prototype.et=function(){return this.data.et()},uu.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},uu.prototype.isEqual=function(t){if(!(t instanceof uu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.te(),n=t.data.te();e.ce();){var r=e.oe().key,i=n.oe().key;if(0!==this.H(r,i))return!1}return!0},uu.prototype.it=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},uu.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},uu.prototype.copy=function(t){var e=new uu(this.H);return e.data=t,e},uu),iu=(su.prototype.oe=function(){return this.ye.oe().key},su.prototype.ce=function(){return this.ye.ce()},su),ou=new Ks(li.H);function su(t){this.ye=t}function uu(t){this.H=t,this.data=new Ks(this.H)}var au=new Ks(li.H);var cu=new Ks(li.H);var hu=new ru(li.H);function fu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=hu,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var lu=new ru(xr);var pu=(Du.pe=function(t){return new Du(t.H)},Du.prototype.has=function(t){return null!=this.ge.get(t)},Du.prototype.get=function(t){return this.ge.get(t)},Du.prototype.first=function(){return this.Ve.Jt()},Du.prototype.last=function(){return this.Ve.Yt()},Du.prototype.et=function(){return this.Ve.et()},Du.prototype.indexOf=function(t){t=this.ge.get(t);return t?this.Ve.indexOf(t):-1},Object.defineProperty(Du.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),Du.prototype.forEach=function(n){this.Ve.Xt(function(t,e){return n(t),!1})},Du.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},Du.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},Du.prototype.isEqual=function(t){if(!(t instanceof Du))return!1;if(this.size!==t.size)return!1;for(var e=this.Ve.te(),n=t.Ve.te();e.ce();){var r=e.oe().key,i=n.oe().key;if(!r.isEqual(i))return!1}return!0},Du.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Du.prototype.copy=function(t,e){var n=new Du;return n.H=this.H,n.ge=t,n.Ve=e,n},Du),du=(Ou.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);!n||0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):Pr()},Ou.prototype.ve=function(){var n=[];return this.be.Xt(function(t,e){n.push(e)}),n},Ou),yu=(Su.Ne=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Su(t,e,pu.pe(e),i,n,r,!0,!1)},Object.defineProperty(Su.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),Su.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&Wo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Su),vu=(Nu.Me=function(t,e){var n=new Map;return n.set(t,gu.Le(t,e)),new Nu(ai.min(),n,lu,ou,fu())},Nu),gu=(Au.Le=function(t,e){return new Au(Mr.T,e,fu(),fu(),fu())},Au),mu=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},wu=function(t,e){this.targetId=t,this.je=e},bu=function(t,e,n,r){void 0===n&&(n=Mr.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},_u=(Object.defineProperty(Iu.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(Iu.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(Iu.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(Iu.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Iu.prototype.tn=function(t){0<t.l()&&(this.Ye=!0,this.He=t)},Iu.prototype.en=function(){var n=fu(),r=fu(),i=fu();return this.ze.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new gu(this.He,this.Je,n,r,i)},Iu.prototype.nn=function(){this.Ye=!1,this.ze=Lu()},Iu.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},Iu.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},Iu.prototype.on=function(){this.Ge+=1},Iu.prototype.cn=function(){--this.Ge},Iu.prototype.an=function(){this.Ye=!0,this.Je=!0},Iu),Eu=(Tu.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof Ji?this.wn(r,t.We):t.We instanceof Zi&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},Tu.prototype.Tn=function(n){var r=this;this.In(n,function(t){var e=r.mn(t);switch(n.state){case 0:r.An(t)&&e.tn(n.resumeToken);break;case 1:e.cn(),e.Xe||e.nn(),e.tn(n.resumeToken);break;case 2:e.cn(),e.Xe||r.removeTarget(t);break;case 3:r.An(t)&&(e.an(),e.tn(n.resumeToken));break;case 4:r.An(t)&&(r.Rn(t),e.tn(n.resumeToken));break;default:Pr()}})},Tu.prototype.In=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.hn.forEach(function(t,e){r.An(e)&&n(e)})},Tu.prototype.Pn=function(t){var e=t.targetId,n=t.je.count,t=this.yn(e);t&&(uo(t=t.target)?0===n?(t=new li(t.path),this.En(e,t,new Zi(t,ai.min()))):Rr(1===n):this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e)))},Tu.prototype.Vn=function(r){var i=this,o=new Map;this.hn.forEach(function(t,e){var n=i.yn(e);n&&(t.Be&&uo(n.target)&&(n=new li(n.target.path),null!==i.ln.get(n)||i.pn(e,n)||i.En(e,n,new Zi(n,r))),t.Ze&&(o.set(e,t.en()),t.nn()))});var s=fu();this._n.forEach(function(t,e){var n=!0;e.Ae(function(t){t=i.yn(t);return!t||2===t.Ft||(n=!1)}),n&&(s=s.add(t))});var t=new vu(r,o,this.fn,this.ln,s);return this.ln=ou,this._n=Cu(),this.fn=new ru(xr),t},Tu.prototype.wn=function(t,e){var n;this.An(t)&&(n=this.pn(t,e.key)?2:0,this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t)))},Tu.prototype.En=function(t,e,n){var r;this.An(t)&&(r=this.mn(t),this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n)))},Tu.prototype.removeTarget=function(t){this.hn.delete(t)},Tu.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},Tu.prototype.on=function(t){this.mn(t).on()},Tu.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new _u,this.hn.set(t,e)),e},Tu.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new ru(xr),this._n=this._n.zt(t,e)),e},Tu.prototype.An=function(t){var e=null!==this.yn(t);return e||Or("WatchChangeAggregator","Detected inactive target",t),e},Tu.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},Tu.prototype.Rn=function(e){var n=this;this.hn.set(e,new _u),this.un.vn(e).forEach(function(t){n.En(e,t,null)})},Tu.prototype.pn=function(t,e){return this.un.vn(t).has(e)},Tu);function Tu(t){this.un=t,this.hn=new Map,this.ln=ou,this._n=Cu(),this.fn=new ru(xr)}function Iu(){this.Ge=0,this.ze=Lu(),this.He=Mr.T,this.Je=!1,this.Ye=!0}function Au(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}function Nu(t,e,n,r,i){this.Ot=t,this.$e=e,this.Fe=n,this.Oe=r,this.ke=i}function Su(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=s,this.xe=u}function Ou(){this.be=new Ks(li.H)}function Du(n){this.H=n?function(t,e){return n(t,e)||li.H(t.key,e.key)}:function(t,e){return li.H(t.key,e.key)},this.ge=au,this.Ve=new Ks(this.H)}function Cu(){return new Ks(li.H)}function Lu(){return new Ks(li.H)}var Pu={asc:"ASCENDING",desc:"DESCENDING"},Ru={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ku=function(t,e){this.t=t,this.Bt=e};function Vu(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function xu(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function Uu(t){return Rr(!!t),ai.K((t=Ai(t),new ui(t.seconds,t.nanos)))}function Mu(t,e){return new ci(["projects",t.projectId,"databases",t.database]).child("documents").child(e).rt()}function ju(t){t=ci.ot(t);return Rr(ea(t)),t}function Fu(t,e){return Mu(t.t,e.path)}function qu(t,e){e=ju(e);if(e.get(1)!==t.t.projectId)throw new Gr(qr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Gr(qr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new li(zu(e))}function Gu(t,e){return Mu(t.t,e)}function Bu(t){return new ci(["projects",t.t.projectId,"databases",t.t.database]).rt()}function zu(t){return Rr(4<t.length&&"documents"===t.get(4)),t.Y(5)}function Hu(t,e,n){return{name:Fu(t,e),fields:n.proto.mapValue.fields}}function Yu(t,e){var n,r,i;if(e instanceof Ps)n={update:Hu(t,e.key,e.value)};else if(e instanceof zs)n={delete:Fu(t,e.key)};else if(e instanceof Rs)n={update:Hu(t,e.key,e.data),updateMask:(i=e.Gt,r=[],i.fields.forEach(function(t){return r.push(t.rt())}),{fieldPaths:r})};else{if(!(e instanceof Hs))return Pr();n={verify:Fu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof as)return{fieldPath:t.field.rt(),setToServerValue:"REQUEST_TIME"};if(e instanceof cs)return{fieldPath:t.field.rt(),appendMissingElements:{values:e.elements}};if(e instanceof ds)return{fieldPath:t.field.rt(),removeAllFromArray:{values:e.elements}};if(e instanceof ms)return{fieldPath:t.field.rt(),increment:e.Ut};throw Pr()})),e.jt.Wt||(n.currentDocument=void 0!==(i=e.jt).updateTime?{updateTime:(e=t,t=i.updateTime,Vu(e,t.j()))}:void 0!==i.exists?{exists:i.exists}:Pr()),n}function Qu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Gu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Gu(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Gi(t.value))return{unaryFilter:{field:Ju(t.field),op:"IS_NAN"}};if(qi(t.value))return{unaryFilter:{field:Ju(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Gi(t.value))return{unaryFilter:{field:Ju(t.field),op:"IS_NOT_NAN"}};if(qi(t.value))return{unaryFilter:{field:Ju(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ju(t.field),op:(e=t.op,Ru[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Ju((t=t).field),direction:(t=t.dir,Pu[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Bt||Ci(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Wu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Wu(e.endAt)),n}function Xu(t){var e=4===(o=ju(t.parent)).length?ci.ct():zu(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Rr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ta(t)]:void 0!==t.fieldFilter?[$u(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Pr():[]}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new xo(Zu((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Ci(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Ku(n.startAt));var u=null;return n.endAt&&(u=Ku(n.endAt)),new jo(e,i,t,o,r,"F",s,u)}function Wu(t){return{before:t.before,values:t.position}}function Ku(t){var e=!!t.before,t=t.values||[];return new Co(t,e)}function Ju(t){return{fieldPath:t.rt()}}function Zu(t){return fi.lt(t.fieldPath)}function $u(t){return co.create(Zu(t.fieldFilter.field),function(){switch(t.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Pr()}}(),t.fieldFilter.value)}function ta(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Zu(t.unaryFilter.field);return co.create(e,"==",{doubleValue:NaN});case"IS_NULL":e=Zu(t.unaryFilter.field);return co.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var n=Zu(t.unaryFilter.field);return co.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":n=Zu(t.unaryFilter.field);return co.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Pr()}}function ea(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var na=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},ra=(ia.prototype.catch=function(t){return this.next(void 0,t)},ia.prototype.next=function(r,i){var o=this;return this.Nn&&Pr(),this.Nn=!0,this.xn?this.error?this.$n(i,this.error):this.Fn(r,this.result):new ia(function(e,n){o.Dn=function(t){o.Fn(r,t).next(e,n)},o.Cn=function(t){o.$n(i,t).next(e,n)}})},ia.prototype.On=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ia.prototype.kn=function(t){try{var e=t();return e instanceof ia?e:ia.resolve(e)}catch(t){return ia.reject(t)}},ia.prototype.Fn=function(t,e){return t?this.kn(function(){return t(e)}):ia.resolve(e)},ia.prototype.$n=function(t,e){return t?this.kn(function(){return t(e)}):ia.reject(e)},ia.resolve=function(n){return new ia(function(t,e){t(n)})},ia.reject=function(n){return new ia(function(t,e){e(n)})},ia.Mn=function(t){return new ia(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ia.Ln=function(t){for(var n=ia.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ia.resolve(t):e()})}(r[e]);return n},ia.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Mn(i)},ia);function ia(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t(function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)},function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)})}function oa(t){return"IndexedDbTransactionError"===t.name}var sa=(ua.Ts=function(t,e,n,r,i){i=new ua(t,e,Date.now()+n,r,i);return i.start(n),i},ua.prototype.start=function(t){var e=this;this.Is=setTimeout(function(){return e.As()},t)},ua.prototype.Rs=function(){return this.As()},ua.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new Gr(qr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ua.prototype.As=function(){var e=this;this._s.Ps(function(){return null!==e.Is?(e.clearTimeout(),e.op().then(function(t){return e.Es.resolve(t)})):Promise.resolve()})},ua.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},ua);function ua(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new na,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch(function(t){})}function aa(t,e){if(Dr("AsyncQueue",e+": "+t),oa(t))return new Gr(qr.UNAVAILABLE,e+": "+t);throw t}function ca(t){this.Fs=t}var h=(da.prototype.gs=function(t){this.ys.push(t)},da.prototype.Vs=function(){this.ys.forEach(function(t){return t()})},da),ha=(pa.prototype.Ss=function(t,e,n){for(var r,i,o,s,u,a,c=n.Ds,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof Ps?(u=o,a=(s=r).value,f=Us(s.fieldTransforms,i,u.transformResults),a=js(s.fieldTransforms,a,f),new Ji(s.key,u.version,a,{hasCommittedMutations:!0})):r instanceof Rs?function(t,e,n){if(!Ns(t.jt,e))return new $i(t.key,n.version);e=xs(t,e,Us(t.fieldTransforms,e,n.transformResults));return new Ji(t.key,n.version,e,{hasCommittedMutations:!0})}(r,i,o):new Zi(r.key,o.version,{hasCommittedMutations:!0}))}return e},pa.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Ss(i,e,this.vs));for(var i,o=0,s=this.mutations;o<s.length;o++)(i=s[o]).key.isEqual(t)&&(e=Ss(i,e,this.vs));return e},pa.prototype.xs=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Cs(t.key,n.get(t.key));e&&(i=i.zt(t.key,e))}),i},pa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},fu())},pa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ur(this.mutations,t.mutations,Os)&&Ur(this.baseMutations,t.baseMutations,Os)},pa),fa=(la.from=function(t,e,n){Rr(t.mutations.length===n.length);for(var r=cu,i=t.mutations,o=0;o<i.length;o++)r=r.zt(i[o].key,n[o].version);return new la(t,e,n,r)},la);function la(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.$s=r}function pa(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}function da(){this.ys=[]}function ya(t){var e=Xu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Xo(e,e.limit,"L"):e}var va=(wa.prototype.qs=function(t,e){return this.Bs.add(e),ra.resolve()},wa.prototype.Us=function(t,e){return ra.resolve(this.Bs.getEntries(e))},wa),ga=(ma.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new ru(ci.H),t=!r.has(n);return this.index[e]=r.add(n),t},ma.prototype.has=function(t){var e=t.tt(),t=t.X(),e=this.index[e];return e&&e.has(t)},ma.prototype.getEntries=function(t){return(this.index[t]||new ru(ci.H)).it()},ma);function ma(){this.index={}}function wa(){this.Bs=new ga}function ba(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==qr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Or("LocalStore","Unexpectedly lost primary lease"),[2]})})}function _a(t,e){this.progress=t,this.Go=e}var Ea=(ka.prototype.get=function(t){var e=this.ni(t),e=this.ii[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.si(o,t))return i}},ka.prototype.has=function(t){return void 0!==this.get(t)},ka.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},ka.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},ka.prototype.forEach=function(s){bi(this.ii,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},ka.prototype.et=function(){return _i(this.ii)},ka),Ee=(Ra.prototype.ci=function(t){t=this.ri.get(t);return t?t.readTime:ai.min()},Ra.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},Ra.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},Ra.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?ra.resolve(n.hi):this.fi(t,e)},Ra.prototype.getEntries=function(t,e){return this.di(t,e)},Ra.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},Ra.prototype.ui=function(){},Ra),Ta=(Pa.prototype.next=function(){return this.ki+=2,this.ki},Pa.Mi=function(){return new Pa(0)},Pa.Li=function(){return new Pa(-1)},Pa),Ia=(La.prototype.Ho=function(e,n){var r=this;return this.zo.bi(e,n).next(function(t){return r.Jo(e,n,t)})},La.prototype.Jo=function(t,r,i){return this.fo._i(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Cs(r,t);return t})},La.prototype.Yo=function(t,e,i){var o=ou;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Cs(t,e);o=o.zt(t,e)}),o},La.prototype.Xo=function(e,t){var n=this;return this.fo.getEntries(e,t).next(function(t){return n.Zo(e,t)})},La.prototype.Zo=function(e,r){var i=this;return this.zo.vi(e,r).next(function(t){var t=i.Yo(e,r,t),n=ou;return t.forEach(function(t,e){e=e||new Zi(t,ai.min()),n=n.zt(t,e)}),n})},La.prototype.Kr=function(t,e,n){return r=e,li.wt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.tc(t,e.path):Ho(e)?this.ec(t,e,n):this.nc(t,e,n);var r},La.prototype.tc=function(t,e){return this.Ho(t,new li(e)).next(function(t){var e=au;return e=t instanceof Ji?e.zt(t.key,t):e})},La.prototype.ec=function(n,r,i){var o=this,s=r.collectionGroup,u=au;return this.Ei.Us(n,s).next(function(t){return ra.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new jo(t,null,e.xt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.nc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.zt(t,e)})})}).next(function(){return u})})},La.prototype.nc=function(e,n,t){var a,c,r=this;return this.fo.Kr(e,n,t).next(function(t){return a=t,r.zo.Di(e,n)}).next(function(t){return c=t,r.sc(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,s=Ss(s,a.get(u),r.vs);a=s instanceof Ji?a.zt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){Zo(n,e)||(a=a.remove(t))}),a})},La.prototype.sc=function(t,e,n){for(var r=fu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Rs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.fo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ji&&(c=c.zt(t,e))}),c})},La),Aa=(Ca.oc=function(t,e){for(var n=fu(),r=fu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ca(t,e.fromCache,n,r)},Ca),Na=(Da.prototype.cc=function(t){this.ac=t},Da.prototype.Kr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.xt.length||1===r.xt.length&&r.xt[0].field.ut())||i.isEqual(ai.min())?this.uc(e,r):this.ac.Xo(e,o).next(function(t){var n=s.hc(r,t);return(qo(r)||Go(r))&&s.lc(r.limitType,n,o,i)?s.uc(e,r):(Sr()<=u.DEBUG&&Or("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Jo(r)),s.ac.Kr(e,r,i).next(function(e){return n.forEach(function(t){e=e.zt(t.key,t)}),e}))})},Da.prototype.hc=function(n,t){var r=new ru($o(n));return t.forEach(function(t,e){e instanceof Ji&&Zo(n,e)&&(r=r.add(e))}),r},Da.prototype.lc=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version._(r))},Da.prototype.uc=function(t,e){return Sr()<=u.DEBUG&&Or("QueryEngine","Using full collection scan to execute query:",Jo(e)),this.ac.Kr(t,e,ai.min())},Da),Sa=(Oa.prototype.Ir=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Vr(t,n.fc)})},Oa);function Oa(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new Ks(xr),this.dc=new Ea(oo,so),this.wc=ai.min(),this.zo=t.Qo(n),this.Ec=t.$r(),this._o=t.Sr(),this.Tc=new Ia(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}function Da(){}function Ca(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}function La(t,e,n){this.fo=t,this.zo=e,this.Ei=n}function Pa(t){this.ki=t}function Ra(){this.ri=new Ea(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.oi=!1}function ka(t,e){this.ni=t,this.si=e,this.ii={}}function Va(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).zo,m=e.Tc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.zo.pi(v).next(function(t){return g=t,n=e.persistence.Qo(o),m=new Ia(e.Ec,n,e.persistence.Ko()),n.pi(v)}).next(function(t){for(var e=[],n=[],r=fu(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Xo(v,r).next(function(t){return{Ic:t,mc:e,Ac:n}})})})];case 1:return r=t.sent(),[2,(e.zo=n,e.Tc=m,e._c.cc(e.Tc),r)]}})})}function xa(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Ec.Nr({Wr:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ra.resolve(),n.forEach(function(n){u=u.next(function(){return o._i(r,n)}).next(function(t){var e=t,t=i.$s.get(n);Rr(null!==t),(!e||e.version._(t)<0)&&(e=s.Ss(n,e,i))&&o.ai(e,i.Ns)})}),u.next(function(){return e.zo.Ci(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.zo.$i(t)}).next(function(){return f.Tc.Xo(t,a)})})}function Ua(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e._o.Qi(t)})}function Ma(t,r){var a=t,c=r.Ot,h=a.fc;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Ec.Nr({Wr:!0});h=a.fc;var u=[];r.$e.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a._o.sr(s,t.Qe,e).next(function(){return a._o.er(s,t.qe,e)})),0<(i=t.resumeToken).l()&&(n=o.Mt(i,c).kt(s.bs),h=h.zt(e,n),r=o,i=t,Rr(0<(o=n).resumeToken.l()),(0===r.resumeToken.l()||3e8<=o.Ot.W()-r.Ot.W()||0<i.qe.size+i.Ue.size+i.Qe.size)&&u.push(a._o.Hi(s,n))))});var e,n=ou;return r.Oe.forEach(function(t,e){r.ke.has(t)&&u.push(a.persistence.Ti.Fr(s,t))}),u.push(ja(s,t,r.Oe,c,void 0).next(function(t){n=t})),c.isEqual(ai.min())||(e=a._o.Qi(s).next(function(t){return a._o.Wi(s,s.bs,c)}),u.push(e)),ra.Mn(u).next(function(){return t.apply(s)}).next(function(){return a.Tc.Zo(s,n)})}).then(function(t){return a.fc=h,t})}function ja(t,s,e,u,a){var n=fu();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=ou;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof Zi&&e.version.isEqual(ai.min())?(s.li(t,r),o=o.zt(t,e)):null==n||0<e.version._(n.version)||0===e.version._(n.version)&&n.hasPendingWrites?(s.ai(e,r),o=o.zt(t,e)):Or("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Fa(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i._o.tr(e,r).next(function(t){return t?(n=t,ra.resolve(n)):i._o.Bi(e).next(function(t){return n=new ts(r,t,0,e.bs),i._o.ji(e,n).next(function(){return n})})})}).then(function(t){var e=i.fc.get(t.targetId);return(null===e||0<t.Ot._(e.Ot))&&(i.fc=i.fc.zt(t.targetId,t),i.dc.set(r,t.targetId)),t})}function qa(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).fc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ti.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!oa(r=t.sent()))throw r;return Or("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.fc=e.fc.remove(o),e.dc.delete(n.target),[2]}})})}function Ga(t,o,s){var u=t,a=ai.min(),c=fu();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Qo(o),(void 0!==(t=(i=t).dc.get(r))?ra.resolve(i.fc.get(t)):i._o.tr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u._o.rr(e,t.targetId).next(function(t){c=t})}).next(function(){return u._c.Kr(e,o,s?a:ai.min(),s?c:fu())}).next(function(t){return{documents:t,Rc:c}});var t,n,r,i})}var Ba,za,Ha,Ya=(Ac.prototype.Os=function(t,e){return ra.resolve(this.Vc.get(e))},Ac.prototype.ks=function(t,e){return this.Vc.set(e.id,{id:e.id,version:e.version,createTime:Uu(e.createTime)}),ra.resolve()},Ac.prototype.Ms=function(t,e){return ra.resolve(this.bc.get(e))},Ac.prototype.Ls=function(t,e){return this.bc.set(e.name,{name:(e=e).name,query:ya(e.bundledQuery),readTime:Uu(e.readTime)}),ra.resolve()},Ac),Qa=(Ic.prototype.et=function(){return this.vc.et()},Ic.prototype.nr=function(t,e){e=new Xa(t,e);this.vc=this.vc.add(e),this.Dc=this.Dc.add(e)},Ic.prototype.xc=function(t,e){var n=this;t.forEach(function(t){return n.nr(t,e)})},Ic.prototype.ir=function(t,e){this.Nc(new Xa(t,e))},Ic.prototype.$c=function(t,e){var n=this;t.forEach(function(t){return n.ir(t,e)})},Ic.prototype.Fc=function(t){var e=this,n=new li(new ci([])),r=new Xa(n,t),t=new Xa(n,t+1),i=[];return this.Dc.me([r,t],function(t){e.Nc(t),i.push(t.key)}),i},Ic.prototype.Oc=function(){var e=this;this.vc.forEach(function(t){return e.Nc(t)})},Ic.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},Ic.prototype.kc=function(t){var e=new li(new ci([])),n=new Xa(e,t),t=new Xa(e,t+1),r=fu();return this.Dc.me([n,t],function(t){r=r.add(t.key)}),r},Ic.prototype.Fi=function(t){var e=new Xa(t,0),e=this.vc.Re(e);return null!==e&&t.isEqual(e.key)},Ic),Xa=(Tc.Sc=function(t,e){return li.H(t.key,e.key)||xr(t.Mc,e.Mc)},Tc.Cc=function(t,e){return xr(t.Mc,e.Mc)||li.H(t.key,e.key)},Tc),Wa=(Ec.prototype.Ai=function(t){return ra.resolve(0===this.zo.length)},Ec.prototype.Ri=function(t,e,n,r){var i=this.Lc;this.Lc++,0<this.zo.length&&this.zo[this.zo.length-1];n=new ha(i,e,n,r);this.zo.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Bc=this.Bc.add(new Xa(u.key,i)),this.Ei.qs(t,u.key.path.X())}return ra.resolve(n)},Ec.prototype.Pi=function(t,e){return ra.resolve(this.qc(e))},Ec.prototype.gi=function(t,e){e+=1,e=this.Uc(e),e=e<0?0:e;return ra.resolve(this.zo.length>e?this.zo[e]:null)},Ec.prototype.Vi=function(){return ra.resolve(0===this.zo.length?-1:this.Lc-1)},Ec.prototype.pi=function(t){return ra.resolve(this.zo.slice())},Ec.prototype.bi=function(t,e){var n=this,r=new Xa(e,0),e=new Xa(e,Number.POSITIVE_INFINITY),i=[];return this.Bc.me([r,e],function(t){t=n.qc(t.Mc);i.push(t)}),ra.resolve(i)},Ec.prototype.vi=function(t,e){var n=this,r=new ru(xr);return e.forEach(function(t){var e=new Xa(t,0),t=new Xa(t,Number.POSITIVE_INFINITY);n.Bc.me([e,t],function(t){r=r.add(t.Mc)})}),ra.resolve(this.Qc(r))},Ec.prototype.Di=function(t,e){var n=e.path,r=n.length+1,e=n;li.wt(e)||(e=e.child(""));var e=new Xa(new li(e),0),i=new ru(xr);return this.Bc.Ae(function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(i=i.add(t.Mc)),!0)},e),ra.resolve(this.Qc(i))},Ec.prototype.Qc=function(t){var e=this,n=[];return t.forEach(function(t){t=e.qc(t);null!==t&&n.push(t)}),n},Ec.prototype.Ci=function(n,r){var i=this;Rr(0===this.Kc(r.batchId,"removed")),this.zo.shift();var o=this.Bc;return ra.forEach(r.mutations,function(t){var e=new Xa(t.key,r.batchId);return o=o.delete(e),i.Ti.Ni(n,t.key)}).next(function(){i.Bc=o})},Ec.prototype.xi=function(t){},Ec.prototype.Fi=function(t,e){var n=new Xa(e,0),n=this.Bc.Re(n);return ra.resolve(e.isEqual(n&&n.key))},Ec.prototype.$i=function(t){return this.zo.length,ra.resolve()},Ec.prototype.Kc=function(t,e){return this.Uc(t)},Ec.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},Ec.prototype.qc=function(t){t=this.Uc(t);return t<0||t>=this.zo.length?null:this.zo[t]},Ec),Ka=(_c.prototype.ai=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:i,readTime:n}),this.size+=i-o,this.Ei.qs(t,r.path.X())},_c.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},_c.prototype._i=function(t,e){e=this.docs.get(e);return ra.resolve(e?e.hi:null)},_c.prototype.getEntries=function(t,e){var n=this,r=ou;return e.forEach(function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)}),ra.resolve(r)},_c.prototype.Kr=function(t,e,n){for(var r=au,i=new li(e.path.child("")),o=this.docs.ee(i);o.ce();){var s=o.oe(),u=s.key,a=s.value,s=a.hi,a=a.readTime;if(!e.path.nt(u.path))break;a._(n)<=0||s instanceof Ji&&Zo(e,s)&&(r=r.zt(s.key,s))}return ra.resolve(r)},_c.prototype.jc=function(t,e){return ra.forEach(this.docs,function(t){return e(t)})},_c.prototype.Nr=function(t){return new Ja(this)},_c.prototype.Or=function(t){return ra.resolve(this.size)},_c),Ja=(n(bc,Ha=Ee),bc.prototype.wi=function(n){var r=this,i=[];return this.ri.forEach(function(t,e){e&&e.hi?i.push(r.jr.ai(n,e.hi,r.ci(t))):r.jr.li(t)}),ra.Mn(i)},bc.prototype.fi=function(t,e){return this.jr._i(t,e)},bc.prototype.di=function(t,e){return this.jr.getEntries(t,e)},bc),Za=(wc.prototype.In=function(t,n){return this.Gc.forEach(function(t,e){return n(e)}),ra.resolve()},wc.prototype.Qi=function(t){return ra.resolve(this.lastRemoteSnapshotVersion)},wc.prototype.Ki=function(t){return ra.resolve(this.zc)},wc.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),ra.resolve(this.highestTargetId)},wc.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),ra.resolve()},wc.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new Ta(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},wc.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,ra.resolve()},wc.prototype.Hi=function(t,e){return this.Gi(e),ra.resolve()},wc.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Fc(e.targetId),--this.targetCount,ra.resolve()},wc.prototype.Xi=function(n,r,i){var o=this,s=0,u=[];return this.Gc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Gc.delete(t),u.push(o.Yi(n,e.targetId)),s++)}),ra.Mn(u).next(function(){return s})},wc.prototype.Zi=function(t){return ra.resolve(this.targetCount)},wc.prototype.tr=function(t,e){e=this.Gc.get(e)||null;return ra.resolve(e)},wc.prototype.er=function(t,e,n){return this.Hc.xc(e,n),ra.resolve()},wc.prototype.sr=function(e,t,n){this.Hc.$c(t,n);var r=this.persistence.Ti,i=[];return r&&t.forEach(function(t){i.push(r.Ni(e,t))}),ra.Mn(i)},wc.prototype.Yi=function(t,e){return this.Hc.Fc(e),ra.resolve()},wc.prototype.rr=function(t,e){e=this.Hc.kc(e);return ra.resolve(e)},wc.prototype.Fi=function(t,e){return ra.resolve(this.Hc.Fi(e))},wc),$a=(mc.prototype.start=function(){return Promise.resolve()},mc.prototype.ko=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(mc.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),mc.prototype.Po=function(){},mc.prototype.yo=function(){},mc.prototype.Ko=function(){return this.Ei},mc.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new Wa(this.Ei,this.Ti),this.Yc[t.A()]=e),e},mc.prototype.Sr=function(){return this._o},mc.prototype.$r=function(){return this.fo},mc.prototype.Wo=function(){return this.wo},mc.prototype.runTransaction=function(t,e,n){var r=this;Or("MemoryPersistence","Starting transaction:",t);var i=new tc(this.so.next());return this.Ti.Zc(),n(i).next(function(t){return r.Ti.ta(i).next(function(){return t})}).On().then(function(t){return i.Vs(),t})},mc.prototype.ea=function(e,n){return ra.Ln(Object.values(this.Yc).map(function(t){return function(){return t.Fi(e,n)}}))},mc),tc=(n(gc,za=h),gc),ec=(vc.ia=function(t){return new vc(t)},Object.defineProperty(vc.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw Pr()},enumerable:!1,configurable:!0}),vc.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),ra.resolve()},vc.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),ra.resolve()},vc.prototype.Ni=function(t,e){return this.ra.add(e.toString()),ra.resolve()},vc.prototype.removeTarget=function(t,e){var n=this;this.na.Fc(e.targetId).forEach(function(t){return n.ra.add(t.toString())});var r=this.persistence.Sr();return r.rr(t,e.targetId).next(function(t){t.forEach(function(t){return n.ra.add(t.toString())})}).next(function(){return r.Ji(t,e)})},vc.prototype.Zc=function(){this.sa=new Set},vc.prototype.ta=function(n){var r=this,i=this.persistence.$r().Nr();return ra.forEach(this.ra,function(t){var e=li._t(t);return r.oa(n,e).next(function(t){t||i.li(e)})}).next(function(){return r.sa=null,i.apply(n)})},vc.prototype.Fr=function(t,e){var n=this;return this.oa(t,e).next(function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())})},vc.prototype.Xc=function(t){return 0},vc.prototype.oa=function(t,e){var n=this;return ra.Ln([function(){return ra.resolve(n.na.Fi(e))},function(){return n.persistence.Sr().Fi(t,e)},function(){return n.persistence.ea(t,e)}])},vc),nc=(yc.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},yc.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},yc.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},yc),rc=(dc.prototype.Ca=function(t){},dc.prototype.Na=function(t,e,n){},dc.prototype.Fa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},dc.prototype.Ba=function(t,e,n){this.ru[t]=e},dc.prototype.ka=function(t){this.iu.ha(t)},dc.prototype.Ma=function(t){return this.iu.activeTargetIds.has(t)},dc.prototype.La=function(t){delete this.ru[t]},dc.prototype.va=function(){return this.iu.activeTargetIds},dc.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},dc.prototype.start=function(){return this.iu=new nc,Promise.resolve()},dc.prototype.Ua=function(t,e,n){},dc.prototype.Qa=function(t){},dc.prototype.ko=function(){},dc.prototype.B=function(t){},dc.prototype.Wa=function(){},dc),ic=(pc.prototype.ou=function(t){},pc.prototype.ko=function(){},pc),oc=(lc.prototype.ou=function(t){this.lu.push(t)},lc.prototype.ko=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},lc.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},lc.prototype.au=function(){Or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},lc.prototype.hu=function(){Or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},lc.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},lc),sc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},uc=(fc.prototype.wu=function(t){this.Eu=t},fc.prototype.Tu=function(t){this.Iu=t},fc.prototype.onMessage=function(t){this.mu=t},fc.prototype.close=function(){this.du()},fc.prototype.send=function(t){this.fu(t)},fc.prototype.Au=function(){this.Eu()},fc.prototype.Ru=function(t){this.Iu(t)},fc.prototype.Pu=function(t){this.mu(t)},fc),ac=(hc.prototype.pu=function(e,t,n,r){var i=this.bu(e,t);Or("RestConnection","Sending: ",i,n);t={};return this.vu(t,r),this.Su(e,i,t,n).then(function(t){return Or("RestConnection","Received: ",t),t},function(t){throw Cr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},hc.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},hc.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.3.0",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},hc.prototype.bu=function(t,e){t=sc[t];return this.gu+"/v1/"+e+":"+t},n(cc,Ba=hc),cc.prototype.Su=function(o,e,s,u){return new Promise(function(n,r){var i=new Er;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Or("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Or("Connection",'RPC "'+o+'" timed out'),r(new Gr(qr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Or("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(qr).indexOf(e)?e:qr.UNKNOWN,r(new Gr(e,t.message))):r(new Gr(qr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Gr(qr.UNAVAILABLE,"Connection failed."));break;default:Pr()}}finally{Or("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},cc.prototype.Cu=function(t,e){var n,r=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new hr,o=yr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=l().indexOf("Electron/")||(0<=(n=l()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=l().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Or("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new uc({fu:function(t){a?Or("Connection","Not sending because WebChannel is closed:",t):(u||(Or("Connection","Opening WebChannel transport."),s.open(),u=!0),Or("Connection","WebChannel sending:",t),s.send(t))},du:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,_r.EventType.OPEN,function(){a||Or("Connection","WebChannel transport opened.")}),t(s,_r.EventType.CLOSE,function(){a||(a=!0,Or("Connection","WebChannel transport closed"),c.Ru())}),t(s,_r.EventType.ERROR,function(t){a||(a=!0,Cr("Connection","WebChannel transport errored:",t),c.Ru(new Gr(qr.UNAVAILABLE,"The operation could not be completed")))}),t(s,_r.EventType.MESSAGE,function(t){var e,n,r,i;a||(Rr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Or("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=qs[r];if(void 0!==t)return Ws(t)}(),i=n.message,void 0===t&&(t=qr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Ru(new Gr(t,i)),s.close()):(Or("Connection","WebChannel received:",e),c.Pu(e)))}),t(o,mr.STAT_EVENT,function(t){t.stat===wr?Or("Connection","Detected buffering proxy"):t.stat===br&&Or("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Au()},0),c},cc);function cc(t){var e=this;return(e=Ba.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function hc(t){this.yu=t,this.t=t.t;var e=t.ssl?"https":"http";this.gu=e+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function fc(t){this.fu=t.fu,this.du=t.du}function lc(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}function pc(){}function dc(){this.iu=new nc,this.ru={},this.fa=null,this.k=null}function yc(){this.activeTargetIds=lu}function vc(t){this.persistence=t,this.na=new Qa,this.sa=null}function gc(t){var e=this;return(e=za.call(this)||this).bs=t,e}function mc(t,e){var n=this;this.Yc={},this.so=new $r(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new Za(this),this.Ei=new va,this.fo=(t=this.Ei,new Ka(t,function(t){return n.Ti.Xc(t)})),this.Qt=new ca(e),this.wo=new Ya(this.Qt)}function wc(t){this.persistence=t,this.Gc=new Ea(oo,so),this.lastRemoteSnapshotVersion=ai.min(),this.highestTargetId=0,this.zc=0,this.Hc=new Qa,this.targetCount=0,this.Jc=Ta.Mi()}function bc(t){var e=this;return(e=Ha.call(this)||this).jr=t,e}function _c(t,e){this.Ei=t,this.Wc=e,this.docs=new Ks(li.H),this.size=0}function Ec(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.Lc=1,this.Bc=new ru(Xa.Sc)}function Tc(t,e){this.key=t,this.Mc=e}function Ic(){this.vc=new ru(Xa.Sc),this.Dc=new ru(Xa.Cc)}function Ac(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}function Nc(){return"undefined"!=typeof document?document:null}function Sc(t){return new ku(t,!0)}function Oc(t,e,n,r,i){var o=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.$h=[],this.Fh=i,this.Fh.ou(function(t){n.Ps(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Jc(this)?(Or("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Nh.add(4),[4,zc(e)];case 1:return t.sent(),e.Oh.set("Unknown"),e.Nh.delete(4),[4,Bc(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Oh=new xc(n,r)}var Dc,Cc,Lc,Pc=(Gc.prototype.reset=function(){this.Fu=0},Gc.prototype.Mu=function(){this.Fu=this.$u},Gc.prototype.Lu=function(t){var e=this;this.cancel();var n=Math.floor(this.Fu+this.Bu()),r=Math.max(0,Date.now()-this.ku),i=Math.max(0,n-r);0<i&&Or("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ou=this.Zr.Tr(this.fs,i,function(){return e.ku=Date.now(),t()}),this.Fu*=this.Nu,this.Fu<this.xu&&(this.Fu=this.xu),this.Fu>this.$u&&(this.Fu=this.$u)},Gc.prototype.qu=function(){null!==this.Ou&&(this.Ou.Rs(),this.Ou=null)},Gc.prototype.cancel=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},Gc.prototype.Bu=function(){return(Math.random()-.5)*this.Fu},Gc),Ee=(qc.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},qc.prototype.Hu=function(){return 2===this.state},qc.prototype.start=function(){3!==this.state?this.auth():this.Ju()},qc.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},qc.prototype.Yu=function(){this.state=0,this.Gu.reset()},qc.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,function(){return t.Zu()}))},qc.prototype.th=function(t){this.eh(),this.stream.send(t)},qc.prototype.Zu=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Hu()?[2,this.close(0)]:[2]})})},qc.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},qc.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==e?this.Gu.reset():n&&n.code===qr.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Mu()):n&&n.code===qr.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Tu(n)];case 1:return t.sent(),[2]}})})},qc.prototype.nh=function(){},qc.prototype.auth=function(){var n=this;this.state=1;var t=this.sh(this.Wu),e=this.Wu;this.Ku.getToken().then(function(t){n.Wu===e&&n.ih(t)},function(e){t(function(){var t=new Gr(qr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.rh(t)})})},qc.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu(function(){n(function(){return e.state=2,e.listener.wu()})}),this.stream.Tu(function(t){n(function(){return e.rh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},qc.prototype.Ju=function(){var t=this;this.state=4,this.Gu.Lu(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},qc.prototype.rh=function(t){return Or("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},qc.prototype.sh=function(e){var n=this;return function(t){n.Zr.Ps(function(){return n.Wu===e?t():(Or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},qc),Rc=(n(Fc,Lc=Ee),Fc.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},Fc.prototype.onMessage=function(t){this.Gu.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Pr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.Bt?(Rr(void 0===s||"string"==typeof s),Mr.fromBase64String(s||"")):(Rr(void 0===s||s instanceof Uint8Array),Mr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?qr.UNKNOWN:Ws(c.code),new Gr(a,c.message||"")),s=new bu(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=qu(t,n.document.name),i=Uu(n.document.updateTime);var u=new zi({mapValue:{fields:n.document.fields}}),a=(o=new Ji(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new mu(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=qu(t,n.document),i=n.readTime?Uu(n.readTime):ai.min(),u=new Zi(r,i),o=n.removedTargetIds||[],s=new mu([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=qu(t,n.document),i=n.removedTargetIds||[],s=new mu([],i,r,null);else{if(!("filter"in e))return Pr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new Fs(n),i=e.targetId,s=new wu(i,r)}return s}(this.Qt,t),t=function(t){if(!("targetChange"in t))return ai.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Uu(t.readTime):ai.min()}(t);return this.listener.ah(e,t)},Fc.prototype.uh=function(t){var e,n,r,i={};i.database=Bu(this.Qt),i.addTarget=(e=this.Qt,(r=uo(r=(n=t).target)?{documents:{documents:[Gu(e,r.path)]}}:{query:Qu(e,r)}).targetId=n.targetId,0<n.resumeToken.l()?r.resumeToken=xu(e,n.resumeToken):0<n.Ot._(ai.min())&&(r.readTime=Vu(e,n.Ot.j())),r);var o,t=(this.Qt,o=t,null==(t=function(){switch(o.Ft){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.th(i)},Fc.prototype.hh=function(t){var e={};e.database=Bu(this.Qt),e.removeTarget=t,this.th(e)},Fc),kc=(n(jc,Cc=Ee),Object.defineProperty(jc.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),jc.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,Cc.prototype.start.call(this)},jc.prototype.nh=function(){this.lh&&this.fh([])},jc.prototype.oh=function(t){return this.Qu.Cu("Write",t)},jc.prototype.onMessage=function(t){if(Rr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Rr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Uu(e.updateTime):Uu(n)).isEqual(ai.min())&&(t=Uu(n)),new Ts(t,e.transformResults||[]);var e,n})):[]),n=Uu(t.commitTime);return this.listener.dh(n,e)}var n,r;return Rr(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},jc.prototype.Eh=function(){var t={};t.database=Bu(this.Qt),this.th(t)},jc.prototype.fh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Yu(e.Qt,t)})};this.th(t)},jc),Vc=(n(Mc,Dc=function(){}),Mc.prototype.Ih=function(){if(this.Th)throw new Gr(qr.FAILED_PRECONDITION,"The client has already been terminated.")},Mc.prototype.pu=function(e,n,r){var i=this;return this.Ih(),this.credentials.getToken().then(function(t){return i.Qu.pu(e,n,r,t)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&i.credentials.p(),t})},Mc.prototype.Du=function(e,n,r){var i=this;return this.Ih(),this.credentials.getToken().then(function(t){return i.Qu.Du(e,n,r,t)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&i.credentials.p(),t})},Mc.prototype.terminate=function(){this.Th=!1},Mc),xc=(Uc.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()}))},Uc.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,1<=this.mh&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},Uc.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},Uc.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},Uc.prototype.gh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rh?(Dr(t),this.Rh=!1):Or("OnlineStateTracker",t)},Uc.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},Uc);function Uc(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}function Mc(t,e,n){var r=this;return(r=Dc.call(this)||this).credentials=t,r.Qu=e,r.Qt=n,r.Th=!1,r}function jc(t,e,n,r,i){var o=this;return(o=Cc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Qt=r,o.lh=!1,o}function Fc(t,e,n,r,i){var o=this;return(o=Lc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Qt=r,o}function qc(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new Pc(t,e)}function Gc(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.$u=i,this.Fu=0,this.Ou=null,this.ku=Date.now(),this.reset()}function Bc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Jc(r))return[3,4];e=0,n=r.$h,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function zc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.$h,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Hc(t,e){t.xh.has(e.targetId)||(t.xh.set(e.targetId,e),Kc(t)?Wc(t):oh(t).Hu()&&Qc(t,e))}function Yc(t,e){var n=t,t=oh(n);n.xh.delete(e),t.Hu()&&Xc(n,e),0===n.xh.size&&(t.Hu()?t.Xu():Jc(n)&&n.Oh.set("Unknown"))}function Qc(t,e){t.kh.on(e.targetId),oh(t).uh(e)}function Xc(t,e){t.kh.on(e),oh(t).hh(e)}function Wc(e){e.kh=new Eu({vn:function(t){return e.Dh.vn(t)},Sn:function(t){return e.xh.get(t)||null}}),oh(e).start(),e.Oh.Ph()}function Kc(t){return Jc(t)&&!oh(t).zu()&&0<t.xh.size}function Jc(t){return 0===t.Nh.size}function Zc(t){t.kh=void 0}function $c(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Oh.set("Online"),!(u instanceof bu&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.xh.has(i)?[4,o.Dh.Mh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.xh.delete(i),o.kh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Or("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,th(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof mu?s.kh.dn(u):u instanceof wu?s.kh.Pn(u):s.kh.Tn(u),a.isEqual(ai.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ua(s.bh)];case 8:return o=t.sent(),0<=a._(o)?[4,(i=a,(e=(r=s).kh.Vn(i)).$e.forEach(function(t,e){var n;0<t.resumeToken.l()&&((n=r.xh.get(e))&&r.xh.set(e,n.Mt(t.resumeToken,i)))}),e.Fe.forEach(function(t){var e=r.xh.get(t);e&&(r.xh.set(t,e.Mt(Mr.T,e.Ot)),Xc(r,t),e=new ts(e.target,t,1,e.sequenceNumber),Qc(r,e))}),r.Dh.Lh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Or("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,th(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function th(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!oa(r))throw r;return n.Nh.add(1),[4,zc(n)];case 1:return t.sent(),n.Oh.set("Offline"),i=i||function(){return Ua(n.bh)},n._s.po(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Or("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Nh.delete(1),[4,Bc(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function eh(e,n){return n().catch(function(t){return th(e,t,n)})}function nh(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=sh(i=a),s=0<i.Ch.length?i.Ch[i.Ch.length-1].batchId:-1,t.label=1;case 1:if(!(Jc(i)&&i.Ch.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.bh,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.zo.gi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Ch.length&&o.Xu(),[3,7]):(s=u.batchId,function(t,e){t.Ch.push(e);t=sh(t);t.Hu()&&t._h&&t.fh(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,th(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return rh(i)&&ih(i),[2]}var e,n,r})})}function rh(t){return Jc(t)&&!sh(t).zu()&&0<t.Ch.length}function ih(t){sh(t).start()}function oh(n){var t,e,r,i=this;return n.Uh||(n.Uh=(t=n.Sh,e=n._s,r={wu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.xh.forEach(function(t,e){Qc(n,t)}),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Zc(e),Kc(e)?(e.Oh.Vh(n),Wc(e)):e.Oh.set("Unknown"),[2]})})}.bind(null,n),ah:$c.bind(null,n)},t.Ih(),new Rc(e,t.Qu,t.credentials,t.Qt,r)),n.$h.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Uh.Yu(),Kc(n)?Wc(n):n.Oh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Uh.stop()];case 2:t.sent(),Zc(n),t.label=3;case 3:return[2]}})})})),n.Uh}function sh(n){var t,e,r,i=this;return n.Qh||(n.Qh=(t=n.Sh,e=n._s,r={wu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return sh(e).Eh(),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&sh(e)._h?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Xs(n=i.code)&&n!==qr.ABORTED?(e=r.Ch.shift(),sh(r).Yu(),[4,eh(r,function(){return r.Dh.qh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,nh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return rh(e)&&ih(e),[2]}})})}.bind(null,n),wh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=sh(o),n=0,r=o.Ch;n<r.length;n++)i=r[n],e.fh(i.mutations);return[2]})})}.bind(null,n),dh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Ch.shift(),n=fa.from(e,i,o),[4,eh(r,function(){return r.Dh.Bh(n)})];case 1:return t.sent(),[4,nh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Ih(),new kc(e,t.Qu,t.credentials,t.Qt,r)),n.$h.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Qh.Yu(),[4,nh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Qh.stop()];case 3:t.sent(),0<n.Ch.length&&(Or("RemoteStore","Stopping write stream with "+n.Ch.length+" pending writes"),n.Ch=[]),t.label=4;case 4:return[2]}})})})),n.Qh}function uh(){this.queries=new Ea(Ko,Wo),this.onlineState="Unknown",this.Wh=new Set}var ah=function(){this.Kh=void 0,this.listeners=[]};function ch(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new ah),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.jh(n)];case 2:return o.Kh=t.sent(),[3,4];case 3:return o=t.sent(),o=aa(o,"Initialization of query '"+Jo(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Gh(e.onlineState),i.Kh&&u.zh(i.Kh)&&fh(e),[2]}})})}function hh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Hh(n))]:[2]})})}function fh(t){t.Wh.forEach(function(t){t.next()})}var lh=(wh.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new yu(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},wh.prototype.onError=function(t){this.Jh.error(t)},wh.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},wh.prototype.tl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.nl&&n||t.docs.et()&&"Offline"!==e)},wh.prototype.Zh=function(t){if(0<t.docChanges.length)return!0;var e=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!e)&&!0===this.options.includeMetadataChanges},wh.prototype.el=function(t){t=yu.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},wh),ph=(mh.prototype.sl=function(){return"metadata"in this.payload},mh),dh=(gh.prototype.Pc=function(t){return qu(this.Qt,t)},gh.prototype.yc=function(t){return t.metadata.exists?(e=this.Qt,n=t.document,r=qu(e,n.name),e=Uu(n.updateTime),n=new zi({mapValue:{fields:n.fields}}),new Ji(r,e,n,{hasCommittedMutations:!1})):new Zi(this.Pc(t.metadata.name),this.gc(t.metadata.readTime));var e,n,r},gh.prototype.gc=Uu,gh),yh=(vh.prototype.rl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},vh.prototype.ol=function(t){for(var e=new Map,n=new dh(this.Qt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Pc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||fu()).add(s);e.set(c,h)}}return e},vh.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=fu(),i=ou,o=cu,e=0,s=p;e<s.length;e++)u=s[e],a=l.Pc(u.metadata.name),u.document&&(r=r.add(a)),i=i.zt(a,l.yc(u)),o=o.zt(a,l.gc(u.metadata.readTime));return c=n.Ec.Nr({Wr:!0}),[4,Fa(n,Qo(Fo(ci.ot("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return ja(e,c,i,ai.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n._o.Yi(e,h.targetId).next(function(){return n._o.er(e,r,h.targetId)}).next(function(){return n.Tc.Zo(e,t)})})})]}})})}(this.bh,new dh(this.Qt),this.documents,this.il.id)];case 1:e=t.sent(),n=this.ol(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=fu()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Fa(e,Qo(ya(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Uu(i.readTime);if(0<=n.Ot._(e))return r.wo.Ls(t,i);e=n.Mt(Mr.T,e);return r.fc=r.fc.zt(e.targetId,e),r._o.Hi(t,e).next(function(){return r._o.Yi(t,n.targetId)}).next(function(){return r._o.er(t,o,n.targetId)}).next(function(){return r.wo.Ls(t,i)})})]}})})}(this.bh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new _a(Object.assign({},this.progress),e))]}})})},vh);function vh(t,e,n){this.il=t,this.bh=e,this.Qt=n,this.queries=[],this.documents=[],this.progress=bh(t)}function gh(t){this.Qt=t}function mh(t,e){this.payload=t,this.byteLength=e}function wh(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}function bh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var _h=function(t){this.key=t},Eh=function(t){this.key=t},Th=(Object.defineProperty(Oh.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),Oh.prototype.fl=function(t,e){var s=this,u=e?e.dl:new du,a=(e||this).ll,c=(e||this).De,h=a,f=!1,l=qo(this.query)&&a.size===this.query.limit?a.last():null,p=Go(this.query)&&a.size===this.query.limit?a.first():null;if(t.Xt(function(t,e){var n=a.get(t),r=(r=e instanceof Ji?e:null)&&(Zo(s.query,r)?r:null),i=!!n&&s.De.has(n.key),o=!!r&&(r.Vt||s.De.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.wl(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.hl(r,l)||p&&s.hl(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),qo(this.query)||Go(this.query))for(;h.size>this.query.limit;){var n=qo(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{ll:h,dl:u,lc:f,De:c}},Oh.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},Oh.prototype.wi=function(t,e,n){var o=this,r=this.ll;this.ll=t.ll,this.De=t.De;var i=t.dl.ve();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.hl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.El(n);var s=e?this.Tl():[],n=0===this.ul.size&&this.Be?1:0,e=n!==this.al;return this.al=n,0!==i.length||e?{snapshot:new yu(this.query,t.ll,r,i,t.De,0==n,e,!1),Il:s}:{Il:s}},Oh.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new du,De:this.De,lc:!1},!1)):{Il:[]}},Oh.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},Oh.prototype.El=function(t){var e=this;t&&(t.qe.forEach(function(t){return e.cl=e.cl.add(t)}),t.Ue.forEach(function(t){}),t.Qe.forEach(function(t){return e.cl=e.cl.delete(t)}),this.Be=t.Be)},Oh.prototype.Tl=function(){var e=this;if(!this.Be)return[];var n=this.ul;this.ul=fu(),this.ll.forEach(function(t){e.ml(t.key)&&(e.ul=e.ul.add(t.key))});var r=[];return n.forEach(function(t){e.ul.has(t)||r.push(new Eh(t))}),this.ul.forEach(function(t){n.has(t)||r.push(new _h(t))}),r},Oh.prototype.Al=function(t){this.cl=t.Rc,this.ul=fu();t=this.fl(t.documents);return this.wi(t,!0)},Oh.prototype.Rl=function(){return yu.Ne(this.query,this.ll,this.De,0===this.al)},Oh),Ih=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ah=function(t){this.key=t,this.Pl=!1},Nh=(Object.defineProperty(Sh.prototype,"Ml",{get:function(){return!0===this.kl},enumerable:!1,configurable:!0}),Sh);function Sh(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new Ea(Ko,Wo),this.Sl=new Map,this.Dl=new Set,this.Cl=new Ks(li.H),this.xl=new Map,this.Nl=new Qa,this.$l={},this.Fl=new Map,this.Ol=Ta.Li(),this.onlineState="Unknown",this.kl=void 0}function Oh(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=fu(),this.De=fu(),this.hl=$o(t),this.ll=new pu(this.hl)}function Dh(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).yl.Dh.Lh=Lh.bind(null,e),e.yl.Dh.vn=function(t,e){var n=t,t=n.xl.get(e);if(t&&t.Pl)return fu().add(t.key);var r=fu(),e=n.Sl.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.vl.get(s);r=r.Pe(s.view._l)}return r}.bind(null,e),e.yl.Dh.Mh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Vl.Ba(s,"rejected",u),i=e.xl.get(s),(n=i&&i.key)?(r=(r=new Ks(li.H)).zt(n,new Zi(n,ai.min())),i=fu().add(n),i=new vu(ai.min(),new Map,new ru(xr),r,i),[4,Lh(e,i)]):[3,2];case 1:return t.sent(),e.Cl=e.Cl.remove(n),e.xl.delete(s),jh(e),[3,4];case 2:return[4,qa(e.bh,s,!1).then(function(){return xh(e,s,u)}).catch(ba)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.bl.ah=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].zh(s)&&(r=!0);u.Kh=s}}r&&fh(n)}.bind(null,e.gl),e.bl.Bl=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.gl),(s=(n=e).vl.get(a))?(r=s.targetId,n.Vl.Fa(r),i=s.view.Rl(),[3,4]):[3,1];case 1:return[4,Fa(n.bh,Qo(a))];case 2:return o=t.sent(),s=n.Vl.Fa(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Ll=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.fl(o)).lc?[4,Ga(r.bh,i.query,!1).then(function(t){t=t.documents;return i.view.fl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.$e.get(i.targetId),n=i.view.wi(e,r.Ml,n),[2,(Mh(r,i.targetId,n.Il),n.snapshot)]}})})}(i,t,e,n)},[4,Ga(i.bh,o,!0)];case 1:return n=t.sent(),r=new Th(o,n.Rc),e=r.fl(n.documents),n=gu.Le(s,u&&"Offline"!==i.onlineState),n=r.wi(e,i.Ml,n),Mh(i,s,n.Il),r=new Ih(o,s,r),[2,(i.vl.set(o,r),i.Sl.has(s)?i.Sl.get(s).push(o):i.Sl.set(s,[o]),n.snapshot)]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n.Ml&&Hc(n.yl,o),t.label=4;case 4:return[2,i]}var e})})}function Ch(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=l).yl.Dh.Bh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,xa(e.bh,o)];case 2:return r=t.sent(),Vh(e,n,null),kh(e,n),e.Vl.Na(n,"acknowledged"),[4,Fh(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.yl.Dh.qh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.bh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.zo.Pi(e,r).next(function(t){return Rr(null!==t),n=t.keys(),i.zo.Ci(e,t)}).next(function(){return i.zo.$i(e)}).next(function(){return i.Tc.Xo(e,n)})}))];case 2:return o=t.sent(),Vh(n,u,a),kh(n,u),n.Vl.Na(u,"rejected",a),[4,Fh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.bh,a=p,h=r,f=ui.now(),i=a.reduce(function(t,e){return t.add(e.key)},fu()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Tc.Xo(u,i).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Ji?e.field(o.field):void 0,s=os(o.transform,s||null);null!=s&&(n=(null==n?new Hi:n).set(o.field,s))}return n?n.Pt():null}(e.fieldTransforms,s));null!=s&&n.push(new Rs(o.key,s,function s(t){var u=[];return bi(t.fields||{},function(t,e){var n=new fi([t]);if(Bi(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ei(u)}(s.proto.mapValue),Is.exists(!0)))}return h.zo.Ri(u,f,n,a)})}).then(function(t){var e=t.xs(c);return{batchId:t.batchId,ri:e}}))];case 2:return s=t.sent(),u.Vl.Ca(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.$l[e.currentUser.A()])||new Ks(xr)).zt(n,o),e.$l[e.currentUser.A()]=r,[4,Fh(u,s.ri)];case 3:return t.sent(),[4,nh(u.yl)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=aa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,f,i,o})})}function Lh(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ma(n.bh,i)];case 2:return e=t.sent(),i.$e.forEach(function(t,e){e=n.xl.get(e);e&&(Rr(t.qe.size+t.Ue.size+t.Qe.size<=1),0<t.qe.size?e.Pl=!0:0<t.Ue.size?Rr(e.Pl):0<t.Qe.size&&(Rr(e.Pl),e.Pl=!1))}),[4,Fh(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,ba(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Ph(t,n,e){var r,t=t;(t.Ml&&0===e||!t.Ml&&1===e)&&(r=[],t.vl.forEach(function(t,e){e=e.view.Gh(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Gh(i)&&(o=!0)}),o&&fh(t)}(t.gl,n),r.length&&t.bl.ah(r),t.onlineState=n,t.Ml&&t.Vl.Qa(n))}function Rh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Jc((n=o).yl)||Or("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.bh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.zo.Vi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Fl.get(r)||[]).push(s),n.Fl.set(r,i),[3,4]);case 3:return i=t.sent(),i=aa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function kh(t,e){(t.Fl.get(e)||[]).forEach(function(t){t.resolve()}),t.Fl.delete(e)}function Vh(t,e,n){var r=t,i=r.$l[r.currentUser.A()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$l[r.currentUser.A()]=i)}function xh(e,t,n){void 0===n&&(n=null),e.Vl.ka(t);for(var r=0,i=e.Sl.get(t);r<i.length;r++){var o=i[r];e.vl.delete(o),n&&e.bl.Bl(o,n)}e.Sl.delete(t),e.Ml&&e.Nl.Fc(t).forEach(function(t){e.Nl.Fi(t)||Uh(e,t)})}function Uh(t,e){t.Dl.delete(e.path.rt());var n=t.Cl.get(e);null!==n&&(Yc(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),jh(t))}function Mh(t,e,n){for(var r,i,o,s=0,u=n;s<u.length;s++){var a=u[s];a instanceof _h?(t.Nl.nr(a.key,e),r=t,o=void 0,i=(o=(i=a).key).path.rt(),r.Cl.get(o)||r.Dl.has(i)||(Or("SyncEngine","New document in limbo: "+o),r.Dl.add(i),jh(r))):a instanceof Eh?(Or("SyncEngine","Document no longer in limbo: "+a.key),t.Nl.ir(a.key,e),t.Nl.Fi(a.key)||Uh(t,a.key)):Pr()}}function jh(t){for(;0<t.Dl.size&&t.Cl.size<t.pl;){var e=t.Dl.values().next().value;t.Dl.delete(e);var n=new li(ci.ot(e)),e=t.Ol.next();t.xl.set(e,new Ah(n)),t.Cl=t.Cl.zt(n,e),Hc(t.yl,new ts(Qo(Fo(n.path)),e,2,$r.q))}}function Fh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).vl.et()?[3,3]:(n.vl.forEach(function(t,e){o.push(n.Ll(e,s,u).then(function(t){t&&(n.Ml&&n.Vl.Ba(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Aa.oc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.bl.ah(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ra.forEach(c,function(e){return ra.forEach(e.ic,function(t){return r.persistence.Ti.nr(n,e.targetId,t)}).next(function(){return ra.forEach(e.rc,function(t){return r.persistence.Ti.ir(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!oa(e=t.sent()))throw e;return Or("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.fc.get(o),u=s.Ot,u=s.Lt(u),r.fc=r.fc.zt(o,u));return[2]}})})}(n.bh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function qh(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Or("SyncEngine","User change. New user:",o.A()),[4,Va(n.bh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Fl.forEach(function(t){t.forEach(function(t){t.reject(new Gr(qr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Fl.clear(),n.Vl.Ua(o,r.mc,r.Ac),[4,Fh(n,r.Ic)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Gh(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.bh,o=r,s=Uu((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.wo.Os(t,i.id)}).then(function(t){return!!t&&0<=t.createTime._(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.ql({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Ul(bh(u)),a=new yh(u,l.bh,p.Qt),[4,p.Ql()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.rl(c)]:[3,10];case 7:return(h=t.sent())&&d.Ul(h),[4,p.Ql()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Fh(l,f.Go,void 0)];case 12:return t.sent(),[4,(r=l.bh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.wo.ks(t,e)}))];case 13:return t.sent(),d.ql(f.progress),[3,15];case 14:return Cr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.Kl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.Vl.Wa()})}var Bh=(Yh.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Qt=Sc(e.yu.t),this.Vl=this.Wl(e),this.persistence=this.jl(e),[4,this.persistence.start()];case 1:return t.sent(),this.Gl=this.zl(e),this.bh=this.Hl(e),[2]}})})},Yh.prototype.zl=function(t){return null},Yh.prototype.Hl=function(t){return e=this.persistence,n=new Na,r=t.Jl,t=this.Qt,new Sa(e,n,r,t);var e,n,r},Yh.prototype.jl=function(t){return new $a(ec.ia,this.Qt)},Yh.prototype.Wl=function(t){return new rc},Yh.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.ko()];case 1:return t.sent(),[4,this.persistence.ko()];case 2:return t.sent(),[2]}})})},Yh),zh=(Hh.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.bh?[3,2]:(this.bh=n.bh,this.Vl=n.Vl,this.Sh=this.Xl(r),this.yl=this.Zl(r),this.gl=this.t_(r),this._a=this.e_(r,!n.synchronizeTabs),this.Vl.fa=function(t){return Ph(e._a,t,1)},this.yl.Dh.n_=qh.bind(null,this._a),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Nh.delete(2),[4,Bc(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Nh.add(2),[4,zc(e)]);case 3:t.sent(),e.Oh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.yl,this._a.Ml)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Hh.prototype.t_=function(t){return new uh},Hh.prototype.Xl=function(t){var e=Sc(t.yu.t),n=(n=t.yu,new ac(n));return t=t.credentials,new Vc(t,n,e)},Hh.prototype.Zl=function(t){var e=this,n=this.bh,r=this.Sh,i=t._s,o=function(t){return Ph(e._a,t,0)},t=new(oc.Kn()?oc:ic);return new Oc(n,r,i,o,t)},Hh.prototype.e_=function(t,e){return function(t,e,n,r,i,o,s){o=new Nh(t,e,n,r,i,o);return s&&(o.kl=!0),o}(this.bh,this.yl,this.gl,this.Vl,t.Jl,t.pl,e)},Hh.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Or("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,zc(e)];case 1:return t.sent(),e.Fh.ko(),e.Oh.set("Unknown"),[2]}})})}(this.yl)},Hh);function Hh(){}function Yh(){this.synchronizeTabs=!1}function Qh(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var Xh=(ef.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},ef.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},ef.prototype.i_=function(){this.muted=!0},ef.prototype.s_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ef),Wh=(tf.prototype.close=function(){return this.r_.cancel()},tf.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},tf.prototype.Ql=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.c_())]}})})},tf.prototype.c_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.a_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.o_.decode(e),n=Number(r),isNaN(n)&&this.u_("length string ("+r+") is not valid number"),[4,this.h_(n)]);case 2:return r=t.sent(),[2,new ph(JSON.parse(r),e.length+n)]}})})},tf.prototype.l_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},tf.prototype.a_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.l_()<0?[4,this.__()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.l_())<0&&this.u_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},tf.prototype.h_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.__()]:[3,3];case 1:t.sent()&&this.u_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.o_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},tf.prototype.u_=function(t){throw this.r_.cancel(),new Error("Invalid bundle format: "+t)},tf.prototype.__=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.r_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},tf),Kh=($h.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},$h),Jh=function(t){this._methodName=t},Zh=function(t){this.d_=t};function $h(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Gr(qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new fi(t)}function tf(t,e){var n=this;this.r_=t,this.Qt=e,this.metadata=new na,this.buffer=new Uint8Array,this.o_=new TextDecoder("utf-8"),this.c_().then(function(t){t&&t.sl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function ef(t){this.observer=t,this.muted=!1}function nf(t,e,n){if(!n)throw new Gr(qr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function rf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Gr(qr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function of(t,e,n,r){if(!0===e&&!0===r)throw new Gr(qr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function sf(t){if(!li.wt(t))throw new Gr(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function uf(t){if(li.wt(t))throw new Gr(qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function af(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function cf(t,e){if((t="_delegate"in t?t.d_:t)instanceof e)return t;if(e.name===t.constructor.name)throw new Gr(qr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=af(t);throw new Gr(qr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function hf(t,e){if(e<=0)throw new Gr(qr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var ff,lf=(Ef.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Ef),pf=new Map,df=(Object.defineProperty(_f.prototype,"app",{get:function(){if(!this.A_)throw new Gr(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),_f.prototype.g_=function(t){if(this.T_)throw new Gr(qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new lf(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Wr;switch(t.type){case"gapi":var e=t.client;return Rr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Zr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Gr(qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},_f.prototype.V_=function(){return this.E_},_f.prototype.p_=function(){return this.T_=!0,this.E_},_f.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},_f.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},_f.prototype.b_=function(){return(t=pf.get(this))&&(Or("ComponentProvider","Removing Datastore"),pf.delete(this),t.terminate()),Promise.resolve();var t},_f),yf=(Object.defineProperty(bf.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"parent",{get:function(){return new gf(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),bf.prototype.withConverter=function(t){return new bf(this.firestore,t,this.S_)},bf),vf=(wf.prototype.withConverter=function(t){return new wf(this.firestore,t,this.C_)},wf),gf=(n(mf,ff=vf),Object.defineProperty(mf.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(mf.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(mf.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new yf(this.firestore,null,new li(t))},enumerable:!1,configurable:!0}),mf.prototype.withConverter=function(t){return new mf(this.firestore,t,this.D_)},mf);function mf(t,e,n){var r=this;return(r=ff.call(this,t,e,Fo(n))||this).firestore=t,r.D_=n,r.type="collection",r}function wf(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function bf(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function _f(t,e){this.w_="(lite)",this.E_=new lf({}),this.T_=!1,t instanceof Ir?(this.I_=t,this.m_=new Wr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Gr(qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ir(t.options.projectId)}(t),this.m_=new Kr(e))}function Ef(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Gr(qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Gr(qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,of("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Tf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Zh&&(t=t.d_),nf("collection","path",e),t instanceof df)return uf(n=ci.ot.apply(ci,s([e],r))),new gf(t,null,n);if(!(t instanceof yf||t instanceof gf))throw new Gr(qr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return uf(n=ci.ot.apply(ci,s([t.path],r)).child(ci.ot(e))),new gf(t.firestore,null,n)}function If(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Zh&&(t=t.d_),nf("doc","path",e=1===arguments.length?kr.u():e),t instanceof df)return sf(n=ci.ot.apply(ci,s([e],r))),new yf(t,null,new li(n));if(!(t instanceof yf||t instanceof gf))throw new Gr(qr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return sf(n=t.D_.child(ci.ot.apply(ci,s([e],r)))),new yf(t.firestore,t instanceof gf?t.v_:null,new li(n))}function Af(t,e){return t instanceof Zh&&(t=t.d_),e instanceof Zh&&(e=e.d_),(t instanceof yf||t instanceof gf)&&(e instanceof yf||e instanceof gf)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Nf(t,e){return t instanceof Zh&&(t=t.d_),e instanceof Zh&&(e=e.d_),t instanceof vf&&e instanceof vf&&t.firestore===e.firestore&&Wo(t.C_,e.C_)&&t.v_===e.v_}var Sf=(Object.defineProperty(Rf.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(Rf.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),Rf.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},Rf.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},Rf.prototype.U=function(t){return xr(this.x_,t.x_)||xr(this.N_,t.N_)},Rf),Of=/^__.*__$/,Df=(Pf.prototype.F_=function(t,e){return null!==this.Gt?new Rs(t,this.data,this.Gt,e,this.fieldTransforms):new Ps(t,this.data,e,this.fieldTransforms)},Pf),Cf=(Lf.prototype.F_=function(t,e){return new Rs(t,this.data,this.Gt,e,this.fieldTransforms)},Lf);function Lf(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}function Pf(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}function Rf(t,e){if(!isFinite(t)||t<-90||90<t)throw new Gr(qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Gr(qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function kf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var Vf=(Object.defineProperty(Mf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Mf.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),Mf.prototype.M_=function(t){return new Mf(Object.assign(Object.assign({},this.settings),t),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},Mf.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.M_({path:e,B_:!1});return e.q_(t),e},Mf.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.M_({path:t,B_:!1});return t.O_(),t},Mf.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},Mf.prototype.K_=function(t){return pl(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},Mf.prototype.contains=function(e){return void 0!==this.Gt.find(function(t){return e.nt(t)})||void 0!==this.fieldTransforms.find(function(t){return e.nt(t.field)})},Mf.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},Mf.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(kf(this.k_)&&Of.test(t))throw this.K_('Document fields cannot begin and end with "__"')},Mf),xf=(Uf.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Vf({k_:t,methodName:e,j_:n,path:fi.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},Uf);function Uf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||Sc(t)}function Mf(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}function jf(t){var e=t.p_(),n=Sc(t.I_);return new xf(t.I_,!!e.ignoreUndefinedProperties,n)}function Ff(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);cl("Data must be an object, but it was:",s,r);var u,a,r=ul(r,s);if(o.merge)u=new Ei(s.Gt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=hl(e,f[h],n);if(!s.contains(l))throw new Gr(qr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");dl(c,l)||c.push(l)}u=new Ei(c),a=s.fieldTransforms.filter(function(t){return u.Tt(t.field)})}else u=null,a=s.fieldTransforms;return new Df(new zi(r),u,a)}var qf,Gf=(n(Bf,qf=Jh),Bf.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},Bf.prototype.isEqual=function(t){return t instanceof Bf},Bf);function Bf(){return null!==qf&&qf.apply(this,arguments)||this}function zf(t,e,n){return new Vf({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var Hf,Yf,Qf,Xf,Wf=(n(nl,Xf=Jh),nl.prototype.z_=function(t){return new Es(t.path,new as)},nl.prototype.isEqual=function(t){return t instanceof nl},nl),Kf=(n(el,Qf=Jh),el.prototype.z_=function(t){var e=zf(this,t,!0),n=this.H_.map(function(t){return sl(t,e)}),n=new cs(n);return new Es(t.path,n)},el.prototype.isEqual=function(t){return this===t},el),Jf=(n(tl,Yf=Jh),tl.prototype.z_=function(t){var e=zf(this,t,!0),n=this.H_.map(function(t){return sl(t,e)}),n=new ds(n);return new Es(t.path,n)},tl.prototype.isEqual=function(t){return this===t},tl),Zf=(n($f,Hf=Jh),$f.prototype.z_=function(t){var e=new ms(t.Qt,is(t.Qt,this.J_));return new Es(t.path,e)},$f.prototype.isEqual=function(t){return this===t},$f);function $f(t,e){var n=this;return(n=Hf.call(this,t)||this).J_=e,n}function tl(t,e){var n=this;return(n=Yf.call(this,t)||this).H_=e,n}function el(t,e){var n=this;return(n=Qf.call(this,t)||this).H_=e,n}function nl(){return null!==Xf&&Xf.apply(this,arguments)||this}function rl(t,r,i,e){var o=t.G_(1,r,i);cl("Data must be an object, but it was:",o,e);var s=[],u=new Hi;bi(e,function(t,e){var n=ll(r,t,i);e instanceof Zh&&(e=e.d_);t=o.U_(n);e instanceof Gf?s.push(n):null!=(t=sl(e,t))&&(s.push(n),u.set(n,t))});e=new Ei(s);return new Cf(u.Pt(),e,o.fieldTransforms)}function il(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[hl(e,r,n)],a=[i];if(o.length%2!=0)throw new Gr(qr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(hl(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Hi,y=u.length-1;0<=y;--y)dl(p,u[y])||(h=u[y],(f=a[y])instanceof Zh&&(f=f.d_),l=s.U_(h),f instanceof Gf?p.push(h):null!=(l=sl(f,l))&&(p.push(h),d.set(h,l)));i=new Ei(p);return new Cf(d.Pt(),i,s.fieldTransforms)}function ol(t,e,n,r){return void 0===r&&(r=!1),sl(n,t.G_(r?4:3,e))}function sl(s,t){if(al(s=s instanceof Zh?s.d_:s))return cl("Unsupported field value:",t,s),ul(s,t);if(s instanceof Jh)return function(t,e){if(!kf(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");t=t.z_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(void 0===s&&t.ignoreUndefinedProperties)return null;if(t.path&&t.Gt.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=sl(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===(t=t instanceof Zh?t.d_:t))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return is(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ui.fromDate(t);return{timestampValue:Vu(e.Qt,n)}}if(t instanceof ui)return n=new ui(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Vu(e.Qt,n)};if(t instanceof Sf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Br)return{bytesValue:xu(e.Qt,t.I)};if(t instanceof yf){n=e.t;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Mu(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+af(t))}(s,t)}function ul(t,n){var r={};return _i(t)?n.path&&0<n.path.length&&n.Gt.push(n.path):bi(t,function(t,e){e=sl(e,n.L_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function al(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ui||t instanceof Sf||t instanceof Br||t instanceof yf||t instanceof Jh)}function cl(t,e,n){if(!al(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=af(n);throw"an object"===n?e.K_(t+" a custom object"):e.K_(t+" "+n)}var r}function hl(t,e,n){if((e=e instanceof Zh?e.d_:e)instanceof Kh)return e.f_;if("string"==typeof e)return ll(t,e);throw pl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var fl=new RegExp("[~\\*/\\[\\]]");function ll(e,n,r){if(0<=n.search(fl))throw pl("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Kh.bind.apply(Kh,s([void 0],n.split("."))))).f_}catch(t){throw pl("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function pl(t,e,n,r,i){var o=r&&!r.et(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Gr(qr.INVALID_ARGUMENT,(e+=". ")+t+n)}function dl(t,e){return t.some(function(t){return t.isEqual(e)})}var yl=(bl.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Gr(qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Bu((n=s).Qt)+"/documents",r={documents:u.map(function(t){return Fu(n.Qt,t)})},[4,n.Du("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.Qt,"found"in(t=t)?function(t,e){Rr(!!e.found),e.found.name,e.found.updateTime;var n=qu(t,e.found.name),t=Uu(e.found.updateTime),e=new zi({mapValue:{fields:e.found.fields}});return new Ji(n,t,e,{})}(e,t):"missing"in t?function(t,e){Rr(!!e.missing),Rr(!!e.readTime);t=qu(t,e.missing),e=Uu(e.readTime);return new Zi(t,e)}(e,t):Pr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Rr(!!t),o.push(t)}),o)]}})})}(this.Sh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Zi||t instanceof Ji?n.sf(t):Pr()}),e)]}})})},bl.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},bl.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},bl.prototype.delete=function(t){this.write(new zs(t,this.jt(t))),this.tf.add(t.toString())},bl.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=li._t(e);n.mutations.push(new Hs(e,n.jt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Bu((e=i).Qt)+"/documents",r={writes:o.map(function(t){return Yu(e.Qt,t)})},[4,e.pu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Sh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},bl.prototype.sf=function(t){var e;if(t instanceof Ji)e=t.version;else{if(!(t instanceof Zi))throw Pr();e=ai.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Gr(qr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},bl.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Is.updateTime(e):Is.Kt()},bl.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Is.exists(!0);if(e.isEqual(ai.min()))throw new Gr(qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Is.updateTime(e)},bl.prototype.write=function(t){this.nf(),this.mutations.push(t)},bl.prototype.nf=function(){},bl),vl=(wl.prototype.run=function(){this.af()},wl.prototype.af=function(){var t=this;this.Gu.Lu(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new yl(this.Sh),(n=this.uf(e))&&n.then(function(t){r._s.Ps(function(){return e.commit().then(function(){r.Es.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},wl.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Ci(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},wl.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this._s.Ps(function(){return e.af(),Promise.resolve()})):this.Es.reject(t)},wl.prototype.lf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Xs(t)},wl),gl=(ml.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}})})},ml.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then(function(){return e._f(e.user)})},ml.prototype.df=function(){if(this._s.wf)throw new Gr(qr.FAILED_PRECONDITION,"The client has already been terminated.")},ml.prototype.terminate=function(){var t=this;this._s.Ef();var n=new na;return this._s.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.S(),n.resolve(),[3,6];case 5:return e=t.sent(),e=aa(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},ml);function ml(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=zr.UNAUTHENTICATED,this.clientId=kr.u(),this._f=function(){},this.C=new na,this.credentials.v(function(t){Or("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()})}function wl(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new Pc(this._s,"transaction_retry")}function bl(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function _l(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(Or("FirestoreClient","Using default OfflineComponentProvider"),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i._s.Af(),Or("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.Jl,i.ff(function(e){n.isEqual(e)||(n=e,i._s.po(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Va(o.bh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.Po(function(){return i.terminate()}),i.mf=o,[2]}})})}(e,new Bh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function El(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(Or("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r._s.Af(),[4,_l(r)];case 1:return e=t.sent(),Or("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r._s.po(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r)._s.Af(),Or("RemoteStore","RemoteStore received new credentials"),n=Jc(e),e.Nh.add(3),[4,zc(e)];case 1:return t.sent(),n&&e.Oh.set("Unknown"),[4,e.Dh.n_(i)];case 2:return t.sent(),e.Nh.delete(3),[4,Bc(e)];case 3:return t.sent(),[2]}})})}(i.yl,t)})}),r.If=i,[2]}})})}(e,new zh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function Tl(t){return _l(t).then(function(t){return t.persistence})}function Il(t){return _l(t).then(function(t){return t.bh})}function Al(t){return El(t).then(function(t){return t.yl})}function Nl(t){return El(t).then(function(t){return t._a})}function Sl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,El(r)];case 1:return e=t.sent(),[2,((n=e.gl).jh=Dh.bind(null,e._a),n.Hh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).vl.get(o),1<(r=e.Sl.get(n.targetId)).length?[2,(e.Sl.set(n.targetId,r.filter(function(t){return!Wo(t,o)})),void e.vl.delete(o))]:e.Ml?(e.Vl.ka(n.targetId),e.Vl.Da(n.targetId)?[3,2]:[4,qa(e.bh,n.targetId,!1).then(function(){e.Vl.La(n.targetId),Yc(e.yl,n.targetId),xh(e,n.targetId)}).catch(ba)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return xh(e,n.targetId),[4,qa(e.bh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e._a),n)]}})})}function Ol(n,r,i){var t=this;void 0===i&&(i={});var o=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Xh({next:function(t){r.Ps(function(){return hh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Gr(qr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Gr(qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new lh(Fo(i.path),t,{includeMetadataChanges:!0,nl:!0});return ch(n,u)},[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n._s,r,i,o])]}})})}),o.promise}function Dl(n,r,i){var t=this;void 0===i&&(i={});var o=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Xh({next:function(t){n.Ps(function(){return hh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Gr(qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new lh(t,o,{includeMetadataChanges:!0,nl:!0});return ch(e,s)},[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n._s,r,i,o])]}})})}),o.promise}var Cl=(Object.defineProperty(Ll.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),Ll.prototype.Ps=function(t){this.enqueue(t)},Ll.prototype.Tf=function(t){this.Sf(),this.Df(t)},Ll.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Nc())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},Ll.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},Ll.prototype.po=function(t){var e=this;this.Ps(function(){return e.Pf.push(t),e.Cf()})},Ll.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!oa(e=t.sent()))throw e;return Or("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.Gu.Lu(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},Ll.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",n=e.stack?e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack:n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},Ll.prototype.Tr=function(t,e,n){var r=this;this.Sf(),-1<this.bf.indexOf(t)&&(e=0);n=sa.Ts(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(n),n},Ll.prototype.Sf=function(){this.Vf&&Pr()},Ll.prototype.Af=function(){},Ll.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},Ll.prototype.$f=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},Ll.prototype.Ff=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.ds-e.ds});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Rs(),"all"!==r&&n.fs===r)break}return i.Nf()})},Ll.prototype.Of=function(t){this.bf.push(t)},Ll.prototype.xf=function(t){t=this.gf.indexOf(t);this.gf.splice(t,1)},Ll);function Ll(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new Pc(this,"async_queue_retry"),this.vf=function(){var t=Nc();t&&Or("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Gu.qu()};var t=Nc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function Pl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Rl,kl=(Ul.prototype.onProgress=function(t,e,n){this.kf={next:t,error:e,complete:n}},Ul.prototype.catch=function(t){return this.Mf.promise.catch(t)},Ul.prototype.then=function(t,e){return this.Mf.promise.then(t,e)},Ul.prototype.ql=function(t){this.Ul(t),this.kf.complete&&this.kf.complete(),this.Mf.resolve(t)},Ul.prototype.Kl=function(t){this.Lf.taskState="Error",this.kf.next&&this.kf.next(this.Lf),this.kf.error&&this.kf.error(t),this.Mf.reject(t)},Ul.prototype.Ul=function(t){this.Lf=t,this.kf.next&&this.kf.next(t)},Ul),Vl=(n(xl,Rl=df),xl.prototype.b_=function(){return this.qf||jl(this),this.qf.terminate()},xl);function xl(t,e){var n=this;return(n=Rl.call(this,t,e)||this).Bf=new Cl,n.w_="name"in t?t.name:"[DEFAULT]",n}function Ul(){this.kf={},this.Mf=new na,this.Lf={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Ml(t){return t.qf||jl(t),t.qf.df(),t.qf}function jl(t){var e,n,r=t.p_(),r=(e=t.I_,n=t.w_,new Tr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.qf=new gl(t.m_,t.Bf,r)}var Fl,h=(Hl.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),Pi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ni(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(Si(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw Pr()}},Hl.prototype.Hf=function(t,n){var r=this,i={};return bi(t.fields||{},function(t,e){i[t]=r.Uf(e,n)}),i},Hl.prototype.Gf=function(t){return new Sf(Ni(t.latitude),Ni(t.longitude))},Hl.prototype.zf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Uf(t,e)})},Hl.prototype.Kf=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return Oi(e)?t(e):e}(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(Di(t));default:return null}},Hl.prototype.Qf=function(t){t=Ai(t);return new ui(t.seconds,t.nanos)},Hl.prototype.Jf=function(t,e){var n=ci.ot(t);Rr(ea(n));t=new Ir(n.get(1),n.get(3)),n=new li(n.Y(5));return t.isEqual(e)||Dr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Hl),ql=(Object.defineProperty(zl.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"ref",{get:function(){return new yf(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),zl.prototype.exists=function(){return null!==this.Zf},zl.prototype.data=function(){if(this.Zf){if(this.v_){var t=new Gl(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},zl.prototype.get=function(t){if(this.Zf){t=this.Zf.data().field(Yl("DocumentSnapshot.get",t));if(null!==t)return this.Xf.Uf(t)}},zl),Gl=(n(Bl,Fl=ql),Bl.prototype.data=function(){return Fl.prototype.data.call(this)},Bl);function Bl(){return null!==Fl&&Fl.apply(this,arguments)||this}function zl(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}function Hl(){}function Yl(t,e){return"string"==typeof e?ll(t,e):(e instanceof Zh?e.d_:e).f_}function Ql(t){if(Go(t)&&0===t.xt.length)throw new Gr(qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}Ee=function(){};function Xl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].td(t);return t}var Wl,Kl,Jl,Zl,$l,tp=(n(cp,$l=Ee),cp.prototype.td=function(t){var e=jf(t.firestore),e=function(t,e,n,r,i,o){if(r.ut()){if("array-contains"===i||"array-contains-any"===i)throw new Gr(qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){lp(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(fp(n,t,c))}h={arrayValue:{values:s}}}else h=fp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||lp(o,i),h=ol(e,"where",o,"in"===i||"not-in"===i);var h=co.create(r,i,h);return function(t,e){if(e.Ct()){var n=zo(t);if(null!==n&&!n.isEqual(e.field))throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Bo(t);null!==n&&pp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Gr(qr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Gr(qr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.ed,this.nd,this.sd);return new vf(t.firestore,t.v_,(t=t.C_,e=t.filters.concat([e]),new jo(t.path,t.collectionGroup,t.xt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},cp),ep=(n(ap,Zl=Ee),ap.prototype.td=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new xo(e,n);return e=r,null!==Bo(n=t)||null!==(t=zo(n))&&pp(0,t,e.field),r}(t.C_,this.ed,this.rd);return new vf(t.firestore,t.v_,(t=t.C_,e=t.xt.concat([e]),new jo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},ap),np=(n(up,Jl=Ee),up.prototype.td=function(t){return new vf(t.firestore,t.v_,Xo(t.C_,this.od,this.ad))},up),rp=(n(sp,Kl=Ee),sp.prototype.td=function(t){var e=hp(t,this.type,this.ud,this.hd);return new vf(t.firestore,t.v_,(t=t.C_,e=e,new jo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},sp),ip=(n(op,Wl=Ee),op.prototype.td=function(t){var e=hp(t,this.type,this.ud,this.hd);return new vf(t.firestore,t.v_,(t=t.C_,e=e,new jo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},op);function op(t,e,n){var r=this;return(r=Wl.call(this)||this).type=t,r.ud=e,r.hd=n,r}function sp(t,e,n){var r=this;return(r=Kl.call(this)||this).type=t,r.ud=e,r.hd=n,r}function up(t,e,n){var r=this;return(r=Jl.call(this)||this).type=t,r.od=e,r.ad=n,r}function ap(t,e){var n=this;return(n=Zl.call(this)||this).ed=t,n.rd=e,n.type="orderBy",n}function cp(t,e,n){var r=this;return(r=$l.call(this)||this).ed=t,r.nd=e,r.sd=n,r.type="where",r}function hp(t,c,e,n){if(e[0]instanceof Zh&&(e[0]=e[0].d_),e[0]instanceof ql)return function(t,e,n,r){if(!n)throw new Gr(qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Yo(t);o<s.length;o++){var u=s[o];if(u.field.ut())i.push(Mi(e,n.key));else{var a=n.field(u.field);if(Oi(a))throw new Gr(qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.rt();throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Co(i,r)}(t.C_,t.firestore.I_,e[0].Zf,n);var r=jf(t.firestore);return function(t,e,n,r,i,o){var s=t.xt;if(i.length>s.length)throw new Gr(qr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ut()){if("string"!=typeof c)throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ho(t)&&-1!==c.indexOf("/"))throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ci.ot(c));if(!li.wt(h))throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new li(h);u.push(Mi(e,h))}else{c=ol(n,r,c);u.push(c)}}return new Co(u,o)}(t.C_,t.firestore.I_,r,c,e,n)}function fp(t,e,n){if("string"==typeof(n=n instanceof Zh?n.d_:n)){if(""===n)throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ho(e)&&-1!==n.indexOf("/"))throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ci.ot(n));if(!li.wt(e))throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Mi(t,new li(e))}if(n instanceof yf)return Mi(t,n.S_);throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+af(n)+".")}function lp(t,e){if(!Array.isArray(t)||0===t.length)throw new Gr(qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Gr(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function pp(t,e,n){if(!n.isEqual(e))throw new Gr(qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function dp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var yp,vp,gp,mp=(n(Sp,gp=h),Sp.prototype.Wf=function(t){return new Br(t)},Sp.prototype.jf=function(t){t=this.Jf(t,this.firestore.I_);return new yf(this.firestore,null,t)},Sp),wp=(Np.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Np),bp=(n(Ap,vp=ql),Ap.prototype.exists=function(){return vp.prototype.exists.call(this)},Ap.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new _p(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},Ap.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf){t=this.Zf.data().field(Yl("DocumentSnapshot.get",t));if(null!==t)return this.Xf.Uf(t,e.serverTimestamps)}},Ap),_p=(n(Ip,yp=bp),Ip.prototype.data=function(t){return void 0===t&&(t={}),yp.prototype.data.call(this,t)},Ip),Ep=(Object.defineProperty(Tp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Tp.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Tp.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Tp.prototype.forEach=function(e,n){var r=this;this._d.docs.forEach(function(t){e.call(n,new _p(r.Yf,r.Xf,t.key,t,new wp(r._d.De.has(t.key),r._d.fromCache),r.query.v_))})},Tp.prototype.docChanges=function(t){t=!!(t=void 0===t?{}:t).includeMetadataChanges;if(t&&this._d.xe)throw new Gr(qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===t||(this.fd=function(i,e){if(i._d.Se.et()){var n=0;return i._d.docChanges.map(function(t){var e=new _p(i.Yf,i.Xf,t.doc.key,t.doc,new wp(i._d.De.has(t.doc.key),i._d.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i._d.Se;return i._d.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new _p(i.Yf,i.Xf,t.doc.key,t.doc,new wp(i._d.De.has(t.doc.key),i._d.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.dd=t),this.fd},Tp);function Tp(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new wp(r.hasPendingWrites,r.fromCache),this.query=n}function Ip(){return null!==yp&&yp.apply(this,arguments)||this}function Ap(t,e,n,r,i,o){var s=this;return(s=vp.call(this,t,e,n,r,o)||this).Yf=t,s.ld=t,s.metadata=i,s}function Np(t,e){this.hasPendingWrites=t,this.fromCache=e}function Sp(t){var e=this;return(e=gp.call(this)||this).firestore=t,e}function Op(t,e){return t instanceof bp&&e instanceof bp?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof Ep&&e instanceof Ep&&t.Yf===e.Yf&&Nf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}var Dp,Cp=(n(Lp,Dp=h),Lp.prototype.Wf=function(t){return new Br(t)},Lp.prototype.jf=function(t){t=this.Jf(t,this.firestore.I_);return new yf(this.firestore,null,t)},Lp);function Lp(t){var e=this;return(e=Dp.call(this)||this).firestore=t,e}function Pp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=cf(t,yf);var o=cf(t.firestore,Vl),s=jf(o);return kp(o,[("string"==typeof(e=e instanceof Zh?e.d_:e)||e instanceof Kh?il(s,"updateDoc",t.S_,e,n,r):rl(s,"updateDoc",t.S_,e)).F_(t.S_,Is.exists(!0))])}function Rp(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Zh&&(e=e.d_);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Pl(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Pl(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof yf?(u=cf(e.firestore,Vl),a=Fo(e.S_.path),h={next:function(t){n[i]&&n[i](Vp(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=cf(e,vf),u=cf(s.firestore,Vl),a=s.C_,c=new Cp(u),h={next:function(t){n[i]&&n[i](new Ep(u,c,s,t))},error:n[i+1],complete:n[i+2]},Ql(e.C_)),function(n,t,e){var r=this,i=new Xh(h),o=new lh(t,i,e);return n._s.Ps(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ch,[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.i_(),n._s.Ps(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=hh,[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Ml(u),a,f)}function kp(t,e){return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Ch,[4,Nl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Ml(t),e)}function Vp(t,e,n){var r=n.docs.get(e.S_),i=new Cp(t);return new bp(t,i,e.S_,r,new wp(n.hasPendingWrites,n.fromCache),e.v_)}var xp=(Up.prototype.set=function(t,e,n){this.md();t=Mp(t,this.Yf),e=dp(t.v_,e,n),n=Ff(this.Id,"WriteBatch.set",t.S_,e,null!==t.v_,n);return this.Ed.push(n.F_(t.S_,Is.Kt())),this},Up.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.md();t=Mp(t,this.Yf),e="string"==typeof(e=e instanceof Zh?e.d_:e)||e instanceof Kh?il(this.Id,"WriteBatch.update",t.S_,e,n,r):rl(this.Id,"WriteBatch.update",t.S_,e);return this.Ed.push(e.F_(t.S_,Is.exists(!0))),this},Up.prototype.delete=function(t){this.md();t=Mp(t,this.Yf);return this.Ed=this.Ed.concat(new zs(t.S_,Is.Kt())),this},Up.prototype.commit=function(){return this.md(),this.Td=!0,0<this.Ed.length?this.wd(this.Ed):Promise.resolve()},Up.prototype.md=function(){if(this.Td)throw new Gr(qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Up);function Up(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=jf(t)}function Mp(t,e){if((t=t instanceof Zh?t.d_:t).firestore!==e)throw new Gr(qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var jp,Fp=(Gp.prototype.get=function(t){var e=this,n=Mp(t,this.Yf),r=new mp(this.Yf);return this.Ad.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Pr();t=t[0];if(t instanceof Zi)return new ql(e.Yf,r,n.S_,null,n.v_);if(t instanceof Ji)return new ql(e.Yf,r,t.key,t,n.v_);throw Pr()})},Gp.prototype.set=function(t,e,n){t=Mp(t,this.Yf),e=dp(t.v_,e,n),n=Ff(this.Id,"Transaction.set",t.S_,e,null!==t.v_,n);return this.Ad.set(t.S_,n),this},Gp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Mp(t,this.Yf),e="string"==typeof(e=e instanceof Zh?e.d_:e)||e instanceof Kh?il(this.Id,"Transaction.update",t.S_,e,n,r):rl(this.Id,"Transaction.update",t.S_,e);return this.Ad.update(t.S_,e),this},Gp.prototype.delete=function(t){t=Mp(t,this.Yf);return this.Ad.delete(t.S_),this},n(qp,jp=Gp),qp.prototype.get=function(t){var e=this,n=Mp(t,this.Yf),r=new Cp(this.Yf);return jp.prototype.get.call(this,t).then(function(t){return new bp(e.Yf,r,n.S_,t.Zf,new wp(!1,!1),n.v_)})},qp);function qp(t,e){var n=this;return(n=jp.call(this,t,e)||this).Yf=t,n}function Gp(t,e){this.Yf=t,this.Ad=e,this.Id=jf(t)}function Bp(){if("undefined"==typeof Uint8Array)throw new Gr(qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function zp(){if("undefined"==typeof atob)throw new Gr(qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Hp,Yp,Qp,Xp=(n(nd,Qp=Zh),nd.fromBase64String=function(t){return zp(),new nd(Br.fromBase64String(t))},nd.fromUint8Array=function(t){return Bp(),new nd(Br.fromUint8Array(t))},nd.prototype.toBase64=function(){return zp(),this.d_.toBase64()},nd.prototype.toUint8Array=function(){return Bp(),this.d_.toUint8Array()},nd.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},nd.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},nd),Wp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Kp=(ed.prototype.enableIndexedDbPersistence=function(t,e){throw new Gr(qr.FAILED_PRECONDITION,Wp)},ed.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Gr(qr.FAILED_PRECONDITION,Wp)},ed.prototype.clearIndexedDbPersistence=function(t){throw new Gr(qr.FAILED_PRECONDITION,Wp)},ed),Jp=(n(td,Yp=Zh),Object.defineProperty(td.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),td.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},td.prototype.useEmulator=function(t,e){var n,r;n=this.d_,r=t,t=e,"firestore.googleapis.com"!==(e=(n=cf(n,df)).V_()).host&&e.host!==r&&Cr("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},td.prototype.enableNetwork=function(){return function(i){var t=this;return i._s.enqueue(function(){return y(t,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Tl(i)];case 1:return n=t.sent(),[4,Al(i)];case 2:return r=t.sent(),[2,(n.yo(!0),(e=r).Nh.delete(0),Bc(e))]}var e})})})}(Ml(cf(this.d_,Vl)))},td.prototype.disableNetwork=function(){return function(r){var t=this;return r._s.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Tl(r)];case 1:return e=t.sent(),[4,Al(r)];case 2:return n=t.sent(),[2,(e.yo(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Nh.add(0),[4,zc(e)];case 1:return t.sent(),e.Oh.set("Offline"),[2]}})})}(n))]}})})})}(Ml(cf(this.d_,Vl)))},td.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&of("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},td.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},td.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},td.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Rh,[4,Nl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Ml(cf(this.d_,Vl)))},td.prototype.onSnapshotsInSync=function(t){return e=this.d_,t=t,function(n,t){var e=this,r=new Xh(t);return n._s.Ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Wh.add(e),e.next()},[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.i_(),n._s.Ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Wh.delete(e)},[4,Sl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Ml(cf(e,Vl)),Pl(t)?t:{next:t});var e},Object.defineProperty(td.prototype,"app",{get:function(){if(!this.Pd)throw new Gr(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),td.prototype.collection=function(t){try{return new Dd(this,Tf(this.d_,t))}catch(t){throw yd(t,"collection()","Firestore.collection()")}},td.prototype.doc=function(t){try{return new pd(this,If(this.d_,t))}catch(t){throw yd(t,"doc()","Firestore.doc()")}},td.prototype.collectionGroup=function(t){try{return new Nd(this,function(t,e){if(t=cf(t,df),nf("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Gr(qr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new vf(t,null,(e=e,new jo(ci.ct(),e)))}(this.d_,t))}catch(t){throw yd(t,"collectionGroup()","Firestore.collectionGroup()")}},td.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,El(n).then(function(t){return t.Sh})];case 1:return e=t.sent(),new vl(n._s,e,r,i).run(),[2]}})})}),i.promise}(Ml(n=this.d_),function(t){return t=new Fp(n,t),e(new sd(r,t))})},td.prototype.batch=function(){var e=this;return Ml(this.d_),new ud(new xp(this.d_,function(t){return kp(e.d_,t)}))},td.prototype.loadBundle=function(t){throw new Gr(qr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},td.prototype.namedQuery=function(t){throw new Gr(qr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},td),Zp=(n($p,Hp=h),$p.prototype.Wf=function(t){return new Xp(new Br(t))},$p.prototype.jf=function(t){t=this.Jf(t,this.firestore.I_);return pd.yd(t,this.firestore,null)},$p);function $p(t){var e=this;return(e=Hp.call(this)||this).firestore=t,e}function td(t,e,n){var r=this;return(r=Yp.call(this,e)||this).Rd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Ir||(r.Pd=t),r}function ed(){}function nd(){return null!==Qp&&Qp.apply(this,arguments)||this}var rd,id,od,sd=(n(fd,od=Zh),fd.prototype.get=function(t){var e=this,n=xd(t);return this.d_.get(n).then(function(t){return new Id(e.Yf,new bp(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))})},fd.prototype.set=function(t,e,n){t=xd(t);return n?(rf("Transaction.set",n),this.d_.set(t,e,n)):this.d_.set(t,e),this},fd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=xd(t);return 2===arguments.length?this.d_.update(o,e):(t=this.d_).update.apply(t,s([o,e,n],r)),this},fd.prototype.delete=function(t){t=xd(t);return this.d_.delete(t),this},fd),ud=(n(hd,id=Zh),hd.prototype.set=function(t,e,n){t=xd(t);return n?(rf("WriteBatch.set",n),this.d_.set(t,e,n)):this.d_.set(t,e),this},hd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=xd(t);return 2===arguments.length?this.d_.update(o,e):(t=this.d_).update.apply(t,s([o,e,n],r)),this},hd.prototype.delete=function(t){t=xd(t);return this.d_.delete(t),this},hd.prototype.commit=function(){return this.d_.commit()},hd),ad=(n(cd,rd=Zh),cd.prototype.fromFirestore=function(t,e){t=new _p(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null);return this.d_.fromFirestore(new Ad(this.Yf,t),null!=e?e:{})},cd.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},cd.gd=function(t,e){var n=cd.Vd,r=n.get(t);r||(r=new WeakMap,n.set(t,r));n=r.get(e);return n||(n=new cd(t,new Zp(t),e),r.set(e,n)),n},cd);function cd(t,e,n){var r=this;return(r=rd.call(this,n)||this).Yf=t,r.Xf=e,r}function hd(){return null!==id&&id.apply(this,arguments)||this}function fd(t,e){var n=this;return(n=od.call(this,e)||this).Yf=t,n.Xf=new Zp(t),n}ad.Vd=new WeakMap;var ld,pd=(n(dd,ld=Zh),dd.pd=function(t,e,n){if(t.length%2!=0)throw new Gr(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new dd(e,new yf(e.d_,n,new li(t)))},dd.yd=function(t,e,n){return new dd(e,new yf(e.d_,n,t))},Object.defineProperty(dd.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"parent",{get:function(){return new Dd(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),dd.prototype.collection=function(t){try{return new Dd(this.firestore,Tf(this.d_,t))}catch(t){throw yd(t,"collection()","DocumentReference.collection()")}},dd.prototype.isEqual=function(t){return(t=t instanceof Zh?t.d_:t)instanceof yf&&Af(this.d_,t)},dd.prototype.set=function(t,e){e=rf("DocumentReference.set",e);try{return function(t,e,n){t=cf(t,yf);var r=cf(t.firestore,Vl),e=dp(t.v_,e,n);return kp(r,[Ff(jf(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,Is.Kt())])}(this.d_,t,e)}catch(t){throw yd(t,"setDoc()","DocumentReference.set()")}},dd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Pp(this.d_,t):Pp.apply(void 0,s([this.d_,t,e],n))}catch(t){throw yd(t,"updateDoc()","DocumentReference.update()")}},dd.prototype.delete=function(){return kp(cf((t=this.d_).firestore,Vl),[new zs(t.S_,Is.Kt())]);var t},dd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=vd(t),i=gd(t,function(t){return new Id(e.firestore,new bp(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))});return Rp(this.d_,r,i)},dd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=cf(e,yf);var n=cf(e.firestore,Vl),t=Ml(n),r=new Cp(n);return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Tc.Ho(t,e)}))];case 1:return(i=t.sent())instanceof Ji?u.resolve(i):i instanceof Zi?u.resolve(null):u.reject(new Gr(qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=aa(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Il(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new bp(n,r,e.S_,t,new wp(t instanceof Ji&&t.Vt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=cf(e,yf);var n=cf(e.firestore,Vl);return Ol(Ml(n),e.S_,{source:"server"}).then(function(t){return Vp(n,e,t)})}:function(e){e=cf(e,yf);var n=cf(e.firestore,Vl);return Ol(Ml(n),e.S_).then(function(t){return Vp(n,e,t)})})(this.d_).then(function(t){return new Id(e.firestore,new bp(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))})},dd.prototype.withConverter=function(t){return new dd(this.firestore,t?this.d_.withConverter(ad.gd(this.firestore,t)):this.d_.withConverter(null))},dd);function dd(t,e){var n=this;return(n=ld.call(this,e)||this).firestore=t,n.Xf=new Zp(t),n}function yd(t,e,n){return t.message=t.message.replace(e,n),t}function vd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Pl(r))return r}return{}}function gd(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Pl(t[0])?t[0]:Pl(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var md,wd,bd,_d,Ed,Td,Id=(n(Vd,Td=Zh),Object.defineProperty(Vd.prototype,"ref",{get:function(){return new pd(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),Vd.prototype.data=function(t){return this.d_.data(t)},Vd.prototype.get=function(t,e){return this.d_.get(t,e)},Vd.prototype.isEqual=function(t){return Op(this.d_,t.d_)},Vd),Ad=(n(kd,Ed=Id),kd.prototype.data=function(t){return this.d_.data(t)},kd),Nd=(n(Rd,_d=Zh),Rd.prototype.where=function(t,e,n){try{return new Rd(this.firestore,Xl(this.d_,(r=n,i=e,o=Yl("where",t),new tp(o,i,r))))}catch(t){throw yd(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Rd.prototype.orderBy=function(t,e){try{return new Rd(this.firestore,Xl(this.d_,(n=void 0===e?"asc":e,r=Yl("orderBy",t),new ep(r,n))))}catch(t){throw yd(t,/(orderBy|where)\(\)/,"Query.$1()")}var n,r},Rd.prototype.limit=function(t){try{return new Rd(this.firestore,Xl(this.d_,(hf("limit",e=t),new np("limit",e,"F"))))}catch(t){throw yd(t,"limit()","Query.limit()")}var e},Rd.prototype.limitToLast=function(t){try{return new Rd(this.firestore,Xl(this.d_,(hf("limitToLast",e=t),new np("limitToLast",e,"L"))))}catch(t){throw yd(t,"limitToLast()","Query.limitToLast()")}var e},Rd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Xl(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rp("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw yd(t,"startAt()","Query.startAt()")}},Rd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Xl(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rp("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw yd(t,"startAfter()","Query.startAfter()")}},Rd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Xl(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ip("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw yd(t,"endBefore()","Query.endBefore()")}},Rd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Rd(this.firestore,Xl(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ip("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw yd(t,"endAt()","Query.endAt()")}},Rd.prototype.isEqual=function(t){return Nf(this.d_,t.d_)},Rd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=cf(e,vf);var n=cf(e.firestore,Vl),t=Ml(n),r=new Cp(n);return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ga(i,o,!0)];case 1:return r=t.sent(),e=new Th(o,r.Rc),n=e.fl(r.documents),n=e.wi(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=aa(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Il(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new Ep(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=cf(e,vf);var n=cf(e.firestore,Vl),t=Ml(n),r=new Cp(n);return Dl(t,e.C_,{source:"server"}).then(function(t){return new Ep(n,r,e,t)})}:function(e){e=cf(e,vf);var n=cf(e.firestore,Vl),t=Ml(n),r=new Cp(n);return Ql(e.C_),Dl(t,e.C_).then(function(t){return new Ep(n,r,e,t)})})(this.d_).then(function(t){return new Od(e.firestore,new Ep(e.firestore.d_,e.Xf,e.d_,t._d))})},Rd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=vd(t),i=gd(t,function(t){return new Od(e.firestore,new Ep(e.firestore.d_,e.Xf,e.d_,t._d))});return Rp(this.d_,r,i)},Rd.prototype.withConverter=function(t){return new Rd(this.firestore,t?this.d_.withConverter(ad.gd(this.firestore,t)):this.d_.withConverter(null))},Rd),Sd=(n(Pd,bd=Zh),Object.defineProperty(Pd.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"doc",{get:function(){return new Ad(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),Pd),Od=(n(Ld,wd=Zh),Object.defineProperty(Ld.prototype,"query",{get:function(){return new Nd(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"docs",{get:function(){var e=this;return this.d_.docs.map(function(t){return new Ad(e.Yf,t)})},enumerable:!1,configurable:!0}),Ld.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map(function(t){return new Sd(e.Yf,t)})},Ld.prototype.forEach=function(e,n){var r=this;this.d_.forEach(function(t){e.call(n,new Ad(r.Yf,t))})},Ld.prototype.isEqual=function(t){return Op(this.d_,t.d_)},Ld),Dd=(n(Cd,md=Nd),Object.defineProperty(Cd.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new pd(this.firestore,t):null},enumerable:!1,configurable:!0}),Cd.prototype.doc=function(t){try{return new pd(this.firestore,void 0===t?If(this.d_):If(this.d_,t))}catch(t){throw yd(t,"doc()","CollectionReference.doc()")}},Cd.prototype.add=function(t){var e,n,r,i=this;return e=this.d_,n=t,t=cf(e.firestore,Vl),r=If(e),n=dp(e.v_,n),kp(t,[Ff(jf(e.firestore),"addDoc",r.S_,n,null!==e.v_,{}).F_(r.S_,Is.exists(!1))]).then(function(){return r}).then(function(t){return new pd(i.firestore,t)})},Cd.prototype.isEqual=function(t){return Af(this.d_,t.d_)},Cd.prototype.withConverter=function(t){return new Cd(this.firestore,t?this.d_.withConverter(ad.gd(this.firestore,t)):this.d_.withConverter(null))},Cd);function Cd(t,e){var n=this;return(n=md.call(this,t,e)||this).firestore=t,n.d_=e,n}function Ld(t,e){var n=this;return(n=wd.call(this,e)||this).Yf=t,n}function Pd(t,e){var n=this;return(n=bd.call(this,e)||this).Yf=t,n}function Rd(t,e){var n=this;return(n=_d.call(this,e)||this).firestore=t,n.Xf=new Zp(t),n}function kd(){return null!==Ed&&Ed.apply(this,arguments)||this}function Vd(t,e){var n=this;return(n=Td.call(this,e)||this).Yf=t,n}function xd(t){return cf(t=t instanceof Zh?t.d_:t,yf)}var Ud,Md,Ee=(n(Fd,Md=Zh),Fd.documentId=function(){return new Fd(fi.ht().rt())},Fd.prototype.isEqual=function(t){return(t=t instanceof Zh?t.d_:t)instanceof Kh&&this.d_.f_.isEqual(t.f_)},Fd),h=(n(jd,Ud=Zh),jd.serverTimestamp=function(){var t=new Wf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new jd(t)},jd.delete=function(){var t=new Gf("deleteField");return t._methodName="FieldValue.delete",new jd(t)},jd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Kf("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new jd(n)},jd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jf("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new jd(n)},jd.increment=function(t){t=new Zf("increment",t);return t._methodName="FieldValue.increment",new jd(t)},jd.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},jd);function jd(){return null!==Ud&&Ud.apply(this,arguments)||this}function Fd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Md.call(this,new(Kh.bind.apply(Kh,s([void 0],t))))||this}function qd(t){return e=this.d_,s=t,n=Ml(e=cf(e,Vl)),t=new kl,function(n,t,r){var e,i=this,o=(e=s,t=Sc(t),e=function(t){if(t instanceof Uint8Array)return Qh(t,void 0);if(t instanceof ArrayBuffer)return Qh(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new Wh(e,t));n._s.Ps(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Gh,[4,Nl(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(n,e.I_,t),t;var e,s,n}function Gd(t){var e=this,n=this.d_,t=t;return function(n,r){var t=this;return n._s.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.wo.Ms(t,e)})},[4,Il(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(Ml(n=cf(n,Vl)),t).then(function(t){return t?new vf(n,null,t.query):null}).then(function(t){return t?new Nd(e,t):null})}var Bd=(zd.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},zd.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},zd.prototype.setServiceProps=function(t){return this.serviceProps=t,this},zd);function zd(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Hd,Yd,Qd={Firestore:Jp,GeoPoint:Sf,Timestamp:ui,Blob:Xp,Transaction:sd,WriteBatch:ud,DocumentReference:pd,DocumentSnapshot:Id,Query:Nd,QueryDocumentSnapshot:Ad,QuerySnapshot:Od,CollectionReference:Dd,FieldPath:Ee,FieldValue:h,setLogLevel:function(t){Ar.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Hd=e.default).INTERNAL.registerComponent(new Bd("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Jp(e,new Vl(e,t),new Kp)},"PUBLIC").setServiceProps(Object.assign({},Qd))),Hd.registerVersion("@firebase/firestore","2.2.0"),(Yd=Jp).prototype.loadBundle=qd,Yd.prototype.namedQuery=Gd}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
